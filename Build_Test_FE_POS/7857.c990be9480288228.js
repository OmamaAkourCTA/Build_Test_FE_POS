"use strict";(self.webpackChunkmarkaizaAdmin=self.webpackChunkmarkaizaAdmin||[]).push([[7857],{77857:(y,_,l)=>{l.r(_),l.d(_,{MarkaziaVouchersModule:()=>pe});var o=l(36895),v=l(39485),m=l(70262),g=l(39646),d=l(4128),f=l(78372),c=l(71884),e=l(94650),s=l(24006),h=l(86260),b=l(87192),x=l(81181),T=l(42953),I=l(64249),Z=l(68423),V=l(72402),M=l(94349),D=l(49973),A=l(85746),S=l(55134),U=l(82757);function N(a,i){1&a&&(e.TgZ(0,"span",27),e._uU(1,"Input is required"),e.qZA())}function J(a,i){if(1&a&&(e.ynx(0),e.YNc(1,N,2,0,"span",26),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",null==t.f||null==(n=t.f.get("brandId"))?null:n.errors.required)}}function q(a,i){if(1&a&&(e.ynx(0),e.YNc(1,J,2,1,"ng-container",8),e.BQk()),2&a){const t=e.oxw();let n;e.xp6(1),e.Q6J("ngIf",(null==t.f||null==(n=t.f.get("brandId"))?null:n.invalid)&&(null==t.f||null==(n=t.f.get("brandId"))?null:n.touched)||(null==t.f||null==(n=t.f.get("brandId"))?null:n.dirty))}}function F(a,i){1&a&&(e.TgZ(0,"span",27),e._uU(1,"Input is required"),e.qZA())}function L(a,i){if(1&a&&(e.ynx(0),e.YNc(1,F,2,0,"span",26),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",null==t.f||null==(n=t.f.get("campaign"))?null:n.errors.required)}}function G(a,i){if(1&a&&(e.ynx(0),e.YNc(1,L,2,1,"ng-container",8),e.BQk()),2&a){const t=e.oxw();let n;e.xp6(1),e.Q6J("ngIf",(null==t.f||null==(n=t.f.get("campaign"))?null:n.invalid)&&(null==t.f||null==(n=t.f.get("campaign"))?null:n.touched)||(null==t.f||null==(n=t.f.get("campaign"))?null:n.dirty))}}function w(a,i){1&a&&(e.TgZ(0,"span",27),e._uU(1,"Input is required"),e.qZA())}function Q(a,i){if(1&a&&(e.ynx(0),e.YNc(1,w,2,0,"span",26),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",null==t.f||null==(n=t.f.get("costCenterId"))?null:n.errors.required)}}function B(a,i){if(1&a&&(e.ynx(0),e.YNc(1,Q,2,1,"ng-container",8),e.BQk()),2&a){const t=e.oxw();let n;e.xp6(1),e.Q6J("ngIf",(null==t.f||null==(n=t.f.get("costCenterId"))?null:n.invalid)&&(null==t.f||null==(n=t.f.get("costCenterId"))?null:n.touched)||(null==t.f||null==(n=t.f.get("costCenterId"))?null:n.dirty))}}function E(a,i){1&a&&(e.TgZ(0,"span",27),e._uU(1,"Input is required"),e.qZA())}function Y(a,i){1&a&&(e.TgZ(0,"span",27),e._uU(1,"Value must be greater than zero"),e.qZA())}function O(a,i){if(1&a&&(e.ynx(0),e.YNc(1,E,2,0,"span",26),e.YNc(2,Y,2,0,"span",26),e.BQk()),2&a){const t=e.oxw(2);let n,r;e.xp6(1),e.Q6J("ngIf",null==t.f||null==(n=t.f.get("numberofVouchers"))?null:n.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.f||null==(r=t.f.get("numberofVouchers"))?null:r.errors.min)}}function P(a,i){if(1&a&&(e.ynx(0),e.YNc(1,O,3,2,"ng-container",8),e.BQk()),2&a){const t=e.oxw();let n;e.xp6(1),e.Q6J("ngIf",(null==t.f||null==(n=t.f.get("numberofVouchers"))?null:n.invalid)&&(null==t.f||null==(n=t.f.get("numberofVouchers"))?null:n.touched)||(null==t.f||null==(n=t.f.get("numberofVouchers"))?null:n.dirty))}}function K(a,i){1&a&&(e.TgZ(0,"span",27),e._uU(1,"Input is required"),e.qZA())}function H(a,i){1&a&&(e.TgZ(0,"span",27),e._uU(1,"Value must be greater than zero"),e.qZA())}function R(a,i){if(1&a&&(e.ynx(0),e.YNc(1,K,2,0,"span",26),e.YNc(2,H,2,0,"span",26),e.BQk()),2&a){const t=e.oxw(2);let n,r;e.xp6(1),e.Q6J("ngIf",null==t.f||null==(n=t.f.get("amountperVoucher"))?null:n.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.f||null==(r=t.f.get("amountperVoucher"))?null:r.errors.min)}}function $(a,i){if(1&a&&(e.ynx(0),e.YNc(1,R,3,2,"ng-container",8),e.BQk()),2&a){const t=e.oxw();let n;e.xp6(1),e.Q6J("ngIf",(null==t.f||null==(n=t.f.get("amountperVoucher"))?null:n.invalid)&&(null==t.f||null==(n=t.f.get("amountperVoucher"))?null:n.touched)||(null==t.f||null==(n=t.f.get("amountperVoucher"))?null:n.dirty))}}function j(a,i){1&a&&(e.TgZ(0,"span",27),e._uU(1,"Input is required"),e.qZA())}function W(a,i){if(1&a&&(e.ynx(0),e.YNc(1,j,2,0,"span",26),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",null==t.f||null==(n=t.f.get("date"))?null:n.errors.required)}}function X(a,i){if(1&a&&(e.ynx(0),e.YNc(1,W,2,1,"ng-container",8),e.BQk()),2&a){const t=e.oxw();let n;e.xp6(1),e.Q6J("ngIf",(null==t.f||null==(n=t.f.get("date"))?null:n.invalid)&&(null==t.f||null==(n=t.f.get("date"))?null:n.touched)||(null==t.f||null==(n=t.f.get("date"))?null:n.dirty))}}function ee(a,i){if(1&a&&(e.TgZ(0,"div",35)(1,"span"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&a){const t=i.row;e.xp6(2),e.Oqu(e.xi3(3,2,null==t?null:t.markaziaVValidityFrom,"mediumDate")),e.xp6(3),e.Oqu(e.xi3(6,5,null==t?null:t.markaziaVValidityTo,"mediumDate"))}}function te(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",28)(1,"div",29)(2,"h6",30),e._uU(3,"Generated Vouchers"),e.qZA(),e.TgZ(4,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.exportToExcel())}),e._UZ(5,"i",32),e._uU(6," Export To Excel "),e.qZA()(),e.TgZ(7,"table-advanced",33),e.NdJ("sortUpdated",function(r){e.CHM(t);const u=e.oxw();return e.KtG(u.onSortChange(r))})("pageUpdated",function(r){e.CHM(t);const u=e.oxw();return e.KtG(u.onPageChange(r))}),e.YNc(8,ee,7,8,"ng-template",34),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(7),e.Q6J("config",t.tableConfig)("columns",t.tableColumns)("data",t.vouchersList)("page",t.pageNo)("total",t.total)("limit",t.limit)}}const ne=function(){return{containerClass:"theme-red",isAnimated:!0}};let ae=(()=>{class a{constructor(t,n,r,u,p,C,k){this._vocuherService=t,this.fb=n,this._modalService=r,this._datePipe=u,this._activeModal=p,this._excelService=C,this._spinner=k,this.brandsList=[],this.costCenterList=[],this.eventData=new e.vpe,this.pageNo=1,this.total=0,this.limit=6,this.tableConfig={paging:!1,filter:{Sort:1,PageSize:this.limit}},this.tableColumns=[],this.vouchersList=[]}ngOnInit(){this.initForm(),this.getLookups(),this.initTableColumns()}getLookups(){const t=this._vocuherService.getBrands("").pipe((0,m.K)(r=>(0,g.of)(r))),n=this._vocuherService.getCostCenter("?StatusId=2001&CostCenterType=38001&PageSize=1000").pipe((0,m.K)(r=>(0,g.of)(r)));(0,d.D)([t,n]).subscribe(r=>{this.brandsList=r[0],this.costCenterList=r[1].data})}initForm(){this.voucherForm=this.fb.group({brandId:[null,[s.kI.required]],campaign:["",[s.kI.required]],costCenterId:[null,[s.kI.required]],numberofVouchers:["",[s.kI.required,s.kI.min(1)]],amountperVoucher:["",[s.kI.required,s.kI.min(1)]],validityFrom:[""],validityTo:[""],date:["",[s.kI.required]]})}confirmModal(){const t=this._modalService.open(b.z,{centered:!0});t.componentInstance.data={body:"Are you sure you want to generate vouchers?"},t.componentInstance.eventData.subscribe(n=>{n&&this.generateVoucher()})}generateVoucher(){if(this.f.invalid)return void this.f.markAllAsTouched();this.vouchersList=[],this._spinner.show();let t=new FormData,n={...this.f.value};t.append("BrandId",n?.brandId),t.append("Campaign",n?.campaign),t.append("CostCenterId",n?.costCenterId),t.append("NumberofVouchers",n?.numberofVouchers),t.append("AmountperVoucher",n?.amountperVoucher),t.append("ValidityFrom",this._datePipe.transform(n.date[0],"yyyy-MM-dd")),t.append("ValidityTo",this._datePipe.transform(n.date[1],"yyyy-MM-dd")),this._vocuherService.generateVoucher(t).subscribe({next:r=>{r.isSuccess&&(this.responseModal("success","The voucher has been generated successfully"),this.eventData.emit(!0),this.f.reset(),this.vouchersList=r.data,this.total=this.vouchersList.length)},error:r=>{this.responseModal("error",r?.error?.errors)}}).add(()=>this._spinner.hide())}exportToExcel(){let n=this.vouchersList.map(r=>({markaziaVoucherID:r?.markaziaVoucherID,markaziaVSequence:r?.markaziaVSequence,markaziaVAmount:r?.markaziaVAmount,brand:r?.brand?.brand,markaziaVCampaign:r?.markaziaVCampaign,createdAt:this._datePipe.transform(r?.createdAt,"mediumDate"),from:this._datePipe.transform(r?.markaziaVValidityFrom,"mediumDate"),to:this._datePipe.transform(r?.markaziaVValidityTo,"mediumDate")}));this._excelService.exportToExcel(n,[["Vocuher ID","Voucher Sequence Number","Amount JOD","Brand","Campaign","Issuance Date","Validity From","Validity To"]],"GeneratedVouchers")}onSortChange(t){t?.direction&&t?.column||(this.tableConfig.filter.Sort=1)}onPageChange(t){this.pageNo=t}initTableColumns(){this.tableColumns=[{key:"markaziaVoucherID",label:"Vocuher ID"},{key:"markaziaVSequence",label:"Voucher Sequence Number"},{key:"markaziaVAmount",label:"Amount JOD",currency:{decimalFormat:"2.3-3",appendText:" JOD"}},{key:"brand.brand",label:"Brand",placeholder:"---"},{key:"markaziaVCampaign",label:"Campaign"},{key:"createdAt",label:"Issuance Date",dateFormat:"mediumDate"},{key:"validity",label:"Validity From-To"}]}responseModal(t,n){const r=this._modalService.open(h.i);r.componentInstance.type=t,r.componentInstance.dismissOnlyActive=!0,"success"==t?r.componentInstance.message=n:r.componentInstance.messageError=n}get f(){return this.voucherForm}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(x.n),e.Y36(s.qu),e.Y36(T.FF),e.Y36(o.uU),e.Y36(T.Kz),e.Y36(I.x),e.Y36(Z.t2))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-generate-voucher"]],decls:50,vars:13,consts:[[1,"modal-header","align-items-center","justify-content-between"],["ngbAutoFocus","",1,"modal-title","font-20","fw-700"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-1"],[1,"input-label"],["placeholder","Brand","bindLabel","brand","bindValue","brandID","formControlName","brandId",3,"items"],[4,"ngIf"],[1,"col-2"],["type","text","formControlName","campaign",1,"form-control","height-47"],["placeholder","Cost Center","bindLabel","costCenterName","bindValue","costCenterId","formControlName","costCenterId",3,"items"],["type","text","numbersOnly","","formControlName","numberofVouchers",1,"form-control","height-47"],[1,"input-group"],["type","text","appDecimalNumber","","formControlName","amountperVoucher",1,"form-control","height-47"],[1,"input-group-text"],[1,"col-3"],["type","text","placeholder","Date","formControlName","date","bsDaterangepicker","",1,"form-control","height-47",3,"bsConfig"],["drp","bsDaterangepicker"],[1,"input-group-text",3,"click"],[1,"fa-regular","fa-calendar-days","font-24","primary-clr"],[1,"mt-3","col-12","d-flex","justify-content-end"],["type","button",1,"redBtn","height-47",3,"disabled","click"],["class","mt-4",4,"ngIf"],[1,"modal-footer","mt-3"],["type","button",1,"redBtn",3,"click"],["class","validation-error",4,"ngIf"],[1,"validation-error"],[1,"mt-4"],[1,"d-flex","justify-content-between","mb-4","align-items-center"],[1,"font-20","fw-600","mb-0"],["type","button",1,"green","redBtn","d-flex","align-items-center","height-47",3,"click"],[1,"fa-solid","fa-file-excel","m-2","fa-2x"],[3,"config","columns","data","page","total","limit","sortUpdated","pageUpdated"],["libTableAdvancedColumn","validity"],[1,"d-flex","flex-column"]],template:function(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"div",0)(1,"h4",1),e._uU(2,"Generate Vouchers"),e.qZA()(),e.TgZ(3,"div",2)(4,"form",3)(5,"div",4)(6,"div",5)(7,"label",6),e._uU(8,"Brand"),e.qZA(),e._UZ(9,"ng-select",7),e.YNc(10,q,2,1,"ng-container",8),e.qZA(),e.TgZ(11,"div",9)(12,"label",6),e._uU(13,"Campaign"),e.qZA(),e._UZ(14,"input",10),e.YNc(15,G,2,1,"ng-container",8),e.qZA(),e.TgZ(16,"div",9)(17,"label",6),e._uU(18,"Cost Center"),e.qZA(),e._UZ(19,"ng-select",11),e.YNc(20,B,2,1,"ng-container",8),e.qZA(),e.TgZ(21,"div",9)(22,"label",6),e._uU(23,"No of Vouchers"),e.qZA(),e._UZ(24,"input",12),e.YNc(25,P,2,1,"ng-container",8),e.qZA(),e.TgZ(26,"div",9)(27,"label",6),e._uU(28,"Amount per Voucher"),e.qZA(),e.TgZ(29,"div",13),e._UZ(30,"input",14),e.TgZ(31,"span",15),e._uU(32,"JOD"),e.qZA()(),e.YNc(33,$,2,1,"ng-container",8),e.qZA(),e.TgZ(34,"div",16)(35,"label",6),e._uU(36,"Voucher Validity"),e.qZA(),e.TgZ(37,"div",13),e._UZ(38,"input",17,18),e.TgZ(40,"span",19),e.NdJ("click",function(){e.CHM(r);const p=e.MAs(39);return e.KtG(p.toggle())}),e._UZ(41,"i",20),e.qZA()(),e.YNc(42,X,2,1,"ng-container",8),e.qZA(),e.TgZ(43,"div",21)(44,"button",22),e.NdJ("click",function(){return n.confirmModal()}),e._uU(45,"Generate"),e.qZA()()()(),e.YNc(46,te,9,6,"div",23),e.qZA(),e.TgZ(47,"div",24)(48,"button",25),e.NdJ("click",function(){return n._activeModal.close()}),e._uU(49,"Close"),e.qZA()()}if(2&t){let r,u,p,C,k,z;e.xp6(4),e.Q6J("formGroup",n.f),e.xp6(5),e.Q6J("items",n.brandsList),e.xp6(1),e.Q6J("ngIf",null==n.f||null==(r=n.f.get("brandId"))?null:r.errors),e.xp6(5),e.Q6J("ngIf",null==n.f||null==(u=n.f.get("campaign"))?null:u.errors),e.xp6(4),e.Q6J("items",n.costCenterList),e.xp6(1),e.Q6J("ngIf",null==n.f||null==(p=n.f.get("costCenterId"))?null:p.errors),e.xp6(5),e.Q6J("ngIf",null==n.f||null==(C=n.f.get("numberofVouchers"))?null:C.errors),e.xp6(8),e.Q6J("ngIf",null==n.f||null==(k=n.f.get("amountperVoucher"))?null:k.errors),e.xp6(5),e.Q6J("bsConfig",e.DdM(12,ne)),e.xp6(4),e.Q6J("ngIf",null==n.f||null==(z=n.f.get("date"))?null:z.errors),e.xp6(2),e.Q6J("disabled",n.f.invalid),e.xp6(2),e.Q6J("ngIf",null==n.vouchersList?null:n.vouchersList.length)}},dependencies:[o.O5,V.FR,V.TB,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,M.w9,D.V,A.y,S.Q,U.N,o.uU],styles:[".ng-dropdown-panel{z-index:9999999!important}"]}),a})();function re(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"i",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.filterForm.get("date").setValue(""))}),e.qZA()}}function oe(a,i){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&a){const t=i.row;e.xp6(2),e.Oqu(e.xi3(3,2,null==t?null:t.markaziaVValidityFrom,"mediumDate")),e.xp6(3),e.Oqu(e.xi3(6,5,null==t?null:t.markaziaVValidityTo,"mediumDate"))}}function ie(a,i){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",29),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().row,u=e.oxw();return e.KtG(u.confirmDeleteVoucher(null==r?null:r.markaziaVoucherID))}),e._uU(2,"Delete"),e.qZA(),e.BQk()}}function le(a,i){1&a&&(e.ynx(0),e._uU(1,"---"),e.BQk())}function se(a,i){1&a&&(e.TgZ(0,"ng-conainter",26),e.YNc(1,ie,3,0,"ng-container",27),e.YNc(2,le,2,0,"ng-container",28),e.qZA()),2&a&&(e.Q6J("ngSwitch",i.row.markaziaVStatus),e.xp6(1),e.Q6J("ngSwitchCase",39001))}const ce=function(){return{containerClass:"theme-red",isAnimated:!0}},ue=[{path:"",component:(()=>{class a{constructor(t,n,r,u,p,C){this._vocuherService=t,this.fb=n,this._modalService=r,this._datePipe=u,this._spinner=p,this._excelService=C,this.brandsList=[],this.vouchersList=[],this.statusList=[],this.pageNo=1,this.total=0,this.limit=6,this.loading=!1,this.tableConfig={paging:!0,filter:{Sort:1,PageSize:this.limit}},this.tableColumns=[]}ngOnInit(){this.initTableColumns(),this.initFilterParams(),this.getLookups(),this.filterForm.get("date").setValue([this.getMonthStartDate(),this.getMonthEndDate()])}getLookups(){const t=this._vocuherService.getBrands("").pipe((0,m.K)(r=>(0,g.of)(r))),n=this._vocuherService.getLookup("?lookupTypeId=39").pipe((0,m.K)(r=>(0,g.of)(r)));(0,d.D)([t,n]).subscribe(r=>{this.brandsList=r[0],this.statusList=r[1].data.map(u=>({...u,text:u?.name[0]?.lookupName}))})}initFilterParams(){this.filterForm=this.fb.group({id:[""],sequence:[""],brandId:[null],campaign:[""],date:[""],status:[null]}),this.filterForm.valueChanges.pipe((0,f.b)(500),(0,c.x)()).subscribe(t=>{this.pageNo=1;let r,n={fromDate:"",toDate:""};t.date&&(n.fromDate=this._datePipe.transform(t.date[0],"yyyy-MM-dd"),n.toDate=this._datePipe.transform(t.date[1],"yyyy-MM-dd")),r={...t,...n},delete r.date,null==r.brandId&&(r={...r,brandId:""}),null==r.status&&(r={...r,status:""}),this.filterParams="?"+new URLSearchParams(r).toString(),this.getMarkaziaVouchers()})}generateVoucher(){this._modalService.open(ae,{modalDialogClass:"generate-vouchers-size"}).componentInstance.eventData.subscribe(n=>{n&&this.getMarkaziaVouchers()})}confirmDeleteVoucher(t){const n=this._modalService.open(b.z,{size:"md"});n.componentInstance.data={body:"Are you sure want to delete this voucher?"},n.componentInstance.eventData.subscribe(r=>{r&&this.deleteVoucher(t)})}deleteVoucher(t){this._spinner.show();let n=new FormData;n.append("VoucherId",t),this._vocuherService.deleteMarkaziaVouchers(n).subscribe(r=>{r.isSuccess&&(this.responseModal("success","Voucher deleted successfully!"),this.getMarkaziaVouchers())}).add(()=>this._spinner.hide())}responseModal(t,n){const r=this._modalService.open(h.i);r.componentInstance.type=t,r.componentInstance.dismissOnlyActive=!0,"success"==t?r.componentInstance.message=n:r.componentInstance.messageError=n}getMarkaziaVouchers(){this.vouchersList=[],this.tableConfig={...this.tableConfig,isLoading:!0};let n,t=`pageSize=${this.tableConfig.filter.PageSize}&pageNo=${this.pageNo-1}&sort=${this.tableConfig.filter.Sort}`;n=this.filterParams?`${this.filterParams}&${t}`:`?${t}`,this._vocuherService.getMarkaziaVoucherList(n).subscribe(r=>{this.vouchersList=r.data,this.total=r.totalRecordCount,this.vouchersInfo=r.info}).add(()=>this.tableConfig={...this.tableConfig,isLoading:!1})}exportToExcel(){this._spinner.show();let t,n="pageSize=1000&pageNo=0";t=this.filterParams?`${this.filterParams}&${n}`:`?${n}`,this._vocuherService.getMarkaziaVoucherList(t).subscribe(r=>{this.generateExcel(r.data)}).add(()=>this._spinner.hide())}generateExcel(t){let r=t.map(u=>({a:u?.markaziaVoucherID,b:u?.markaziaVSequence,bb:u?.markaziaVAmount,c:u?.brand.brand,d:u?.markaziaVCampaign,e:this._datePipe.transform(u?.createdAt,"mediumDate"),f:this._datePipe.transform(u?.markaziaVValidityFrom,"mediumDate"),ff:this._datePipe.transform(u?.markaziaVValidityTo,"mediumDate"),g:u?.statusObj[0].lookupName}));this._excelService.exportToExcel(r,[["Voucher ID","Voucher Sequence Number","Amount JOD","Brand","Campaign","Issuance Date","Validity From","Validity From","Status"]],"Vouchers")}onSortChange(t){if(t?.direction&&t?.column)switch(t.column){case"markaziaVoucherID":this.tableConfig.filter.Sort="desc"===t.direction?3:2;break;case"markaziaVSequence":this.tableConfig.filter.Sort="desc"===t.direction?5:4;break;case"markaziaVAmount":this.tableConfig.filter.Sort="desc"===t.direction?7:6;break;case"brand.brand":this.tableConfig.filter.Sort="desc"===t.direction?9:8;break;case"markaziaVCampaign":this.tableConfig.filter.Sort="desc"===t.direction?11:10;break;case"createdAt":this.tableConfig.filter.Sort="desc"===t.direction?13:12;break;case"statusObj[0].lookupName":this.tableConfig.filter.Sort="desc"===t.direction?15:14}else this.tableConfig.filter.Sort=1;this.getMarkaziaVouchers()}onPageChange(t){this.pageNo=t,this.getMarkaziaVouchers()}initTableColumns(){this.tableColumns=[{key:"markaziaVoucherID",label:"Vocuher ID",canSort:!0},{key:"markaziaVSequence",label:"Voucher Sequence Number",canSort:!0},{key:"markaziaVAmount",label:"Amount JOD",canSort:!0,currency:{decimalFormat:"2.3-3",appendText:" JOD"}},{key:"brand.brand",label:"Brand",canSort:!0,placeholder:"---"},{key:"markaziaVCampaign",label:"Campaign",canSort:!0},{key:"createdAt",label:"Issuance Date",canSort:!0,dateFormat:"mediumDate"},{key:"validity",label:"Validity From-To"},{key:"statusObj[0].lookupName",label:"Status",canSort:!0},{key:"action",label:"Action"}]}getMonthEndDate(){var t=new Date;return new Date(t.getFullYear(),t.getMonth()+1,0)}getMonthStartDate(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),1)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(x.n),e.Y36(s.qu),e.Y36(T.FF),e.Y36(o.uU),e.Y36(Z.t2),e.Y36(I.x))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-markazia-vouchers"]],decls:43,vars:16,consts:[[3,"formGroup"],[1,"row","mb-3"],[1,"col-2"],["type","text","formControlName","id","placeholder","Seach by ID / Sequence",1,"form-control","height-47"],["placeholder","Brand","bindLabel","brand","bindValue","brandID","formControlName","brandId",3,"items"],["type","text","formControlName","campaign","placeholder","Campaign",1,"form-control","height-47"],["placeholder","Status","bindLabel","text","bindValue","id","formControlName","status",3,"items"],[1,"col-3"],[1,"input-group","position-relative"],["type","text","placeholder","Issuance Date","formControlName","date","bsDaterangepicker","",1,"form-control","height-47",3,"bsConfig"],["drp","bsDaterangepicker"],["class","fas fa-circle-xmark clearIcon",3,"click",4,"ngIf"],[1,"input-group-text",3,"click"],[1,"fa-regular","fa-calendar-days","font-24","primary-clr"],[1,"row"],[1,"d-flex","voucher","align-items-center","gap-3","p-2"],["height","40","src","/assets/images/voucher.svg","alt","voucher"],[1,"m-0","fw-600"],["type","button",1,"redBtn","height-47","w-100",3,"click"],["type","button",1,"green","redBtn","d-flex","align-items-center","height-47",3,"click"],[1,"fa-solid","fa-file-excel","m-2","fa-2x"],[3,"config","columns","data","loading","page","total","limit","sortUpdated","pageUpdated"],["libTableAdvancedColumn","validity"],["libTableAdvancedColumn","action"],[1,"fas","fa-circle-xmark","clearIcon",3,"click"],[1,"d-flex","flex-column"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","button",1,"redBtn",3,"click"]],template:function(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"form",0)(1,"div",1)(2,"div",2),e._UZ(3,"input",3),e.qZA(),e.TgZ(4,"div",2),e._UZ(5,"ng-select",4),e.qZA(),e.TgZ(6,"div",2),e._UZ(7,"input",5),e.qZA(),e.TgZ(8,"div",2),e._UZ(9,"ng-select",6),e.qZA(),e.TgZ(10,"div",7)(11,"div",8),e._UZ(12,"input",9,10),e.YNc(14,re,1,0,"i",11),e.TgZ(15,"span",12),e.NdJ("click",function(){e.CHM(r);const p=e.MAs(13);return e.KtG(p.toggle())}),e._UZ(16,"i",13),e.qZA()()()()(),e.TgZ(17,"div",14)(18,"div",2)(19,"div",15),e._UZ(20,"img",16),e.TgZ(21,"p",17),e._uU(22),e.qZA()()(),e.TgZ(23,"div",2)(24,"div",15),e._UZ(25,"img",16),e.TgZ(26,"p",17),e._uU(27),e.qZA()()(),e.TgZ(28,"div",2)(29,"div",15),e._UZ(30,"img",16),e.TgZ(31,"p",17),e._uU(32),e.qZA()()(),e.TgZ(33,"div",2)(34,"button",18),e.NdJ("click",function(){return n.generateVoucher()}),e._uU(35,"Generate New"),e.qZA()(),e.TgZ(36,"div",2)(37,"button",19),e.NdJ("click",function(){return n.exportToExcel()}),e._UZ(38,"i",20),e._uU(39," Export To Excel "),e.qZA()()(),e.TgZ(40,"table-advanced",21),e.NdJ("sortUpdated",function(p){return n.onSortChange(p)})("pageUpdated",function(p){return n.onPageChange(p)}),e.YNc(41,oe,7,8,"ng-template",22),e.YNc(42,se,3,2,"ng-template",23),e.qZA()}2&t&&(e.Q6J("formGroup",n.filterForm),e.xp6(5),e.Q6J("items",n.brandsList),e.xp6(4),e.Q6J("items",n.statusList),e.xp6(3),e.Q6J("bsConfig",e.DdM(15,ce)),e.xp6(2),e.Q6J("ngIf",n.filterForm.get("date").value),e.xp6(8),e.hij("Valid Vouchers ",(null==n.vouchersInfo?null:n.vouchersInfo.valid)||0,""),e.xp6(5),e.hij("Used Vouchers ",(null==n.vouchersInfo?null:n.vouchersInfo.used)||0,""),e.xp6(5),e.hij("Expired Vouchers ",(null==n.vouchersInfo?null:n.vouchersInfo.expired)||0,""),e.xp6(8),e.Q6J("config",n.tableConfig)("columns",n.tableColumns)("data",n.vouchersList)("loading",n.loading)("page",n.pageNo)("total",n.total)("limit",n.limit))},dependencies:[o.O5,o.RF,o.n9,o.ED,V.FR,V.TB,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,M.w9,D.V,A.y,o.uU],styles:[".voucher[_ngcontent-%COMP%]{height:47px;border:1px solid var(--primary);border-radius:7px}"]}),a})()}];let de=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[v.Bz.forChild(ue),v.Bz]}),a})();var me=l(21515);let pe=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[o.ez,de,me.m]}),a})()},81181:(y,_,l)=>{l.d(_,{n:()=>g});var o=l(94650),v=l(80529),m=l(69082);let g=(()=>{class d{constructor(c,e){this.http=c,this.sharedService=e,this.apiUrl=this.sharedService.getUrl,this.apiUrl2=this.sharedService.getUrl2}getBrands(c){return this.http.get(`${this.apiUrl2}Customer/GetBrands${c}`,this.sharedService.getHeaders())}getLookup(c){return this.http.get(`${this.apiUrl}Lookups/GetLookups${c}`,this.sharedService.getHeaders())}getCostCenter(c){return this.http.get(`${this.apiUrl}PettyCash/GetCostCenters${c}`,this.sharedService.getHeaders())}getMarkaziaVoucherList(c){return this.http.get(`${this.apiUrl}MarkaziaVouchers/GetMarkaziaVouchers${c}`,this.sharedService.getHeaders())}deleteMarkaziaVouchers(c){return this.http.post(`${this.apiUrl}MarkaziaVouchers/DeleteMarkaziaVouchers`,c,this.sharedService.getHeaders())}generateVoucher(c){return this.http.post(`${this.apiUrl}MarkaziaVouchers/GenerateMarkaziaVouchers`,c,this.sharedService.getHeaders())}}return d.\u0275fac=function(c){return new(c||d)(o.LFG(v.eN),o.LFG(m.F))},d.\u0275prov=o.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},87192:(y,_,l)=>{l.d(_,{z:()=>f});var o=l(94650),v=l(42953),m=l(36895);function g(c,e){1&c&&(o.ynx(0),o.TgZ(1,"h6",11),o._uU(2,"Are you sure?"),o.qZA(),o.BQk())}function d(c,e){if(1&c&&o._UZ(0,"p",12),2&c){const s=o.oxw();o.Q6J("innerHTML",null==s.data?null:s.data.body,o.oJD)}}let f=(()=>{class c{constructor(s){this._activeModel=s,this.eventData=new o.vpe}confirm(s){this.eventData.emit(s),this._activeModel.dismiss()}}return c.\u0275fac=function(s){return new(s||c)(o.Y36(v.Kz))},c.\u0275cmp=o.Xpm({type:c,selectors:[["app-confirm-modal"]],inputs:{data:"data"},outputs:{eventData:"eventData"},decls:15,vars:5,consts:[[1,"row"],[1,"col-12"],[1,"modal-header","border-0"],["ngbAutoFocus","",1,"font-20","fw-600","mb-0"],[1,"modal-body"],[4,"ngIf","ngIfElse"],["elseBlock",""],[1,"modal-footer","border-0"],[1,"btns-group","gap-2","mx-0"],["type","button",1,"btn","btn-save",3,"click"],["type","button",1,"btn","btn-cancel",3,"click"],[1,"mb-0","fw-500"],[1,"mb-0","fs-16","fw-500",3,"innerHTML"]],template:function(s,h){if(1&s&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),o._uU(4),o.qZA()(),o.TgZ(5,"div",4),o.YNc(6,g,3,0,"ng-container",5),o.YNc(7,d,1,1,"ng-template",null,6,o.W1O),o.qZA(),o.TgZ(9,"div",7)(10,"div",8)(11,"button",9),o.NdJ("click",function(){return h.confirm(!0)}),o._uU(12),o.qZA(),o.TgZ(13,"button",10),o.NdJ("click",function(){return h.confirm(!1)}),o._uU(14),o.qZA()()()()()),2&s){const b=o.MAs(8);o.xp6(4),o.Oqu((null==h.data?null:h.data.headingText)||"Confirm"),o.xp6(2),o.Q6J("ngIf",!(null!=h.data&&h.data.body))("ngIfElse",b),o.xp6(6),o.Oqu((null==h.data?null:h.data.confirmText)||"Yes"),o.xp6(2),o.Oqu((null==h.data?null:h.data.cancelText)||"No")}},dependencies:[m.O5]}),c})()},55134:(y,_,l)=>{l.d(_,{Q:()=>v});var o=l(94650);let v=(()=>{class m{constructor(d){this.el=d,this.regex=new RegExp(/^\d*\.?\d{0,50}$/g),this.specialKeys=["Backspace","Tab","End","Home","ArrowLeft","ArrowRight","Del","Delete"]}onKeyDown(d){if(-1!==this.specialKeys.indexOf(d.key))return;const c=this.el.nativeElement.value.concat(d.key);c&&!String(c).match(this.regex)&&d.preventDefault()}setInputFocusOut(){let d=+this.el.nativeElement.value;d>0&&(this.el.nativeElement.value=d.toFixed(3))}}return m.\u0275fac=function(d){return new(d||m)(o.Y36(o.SBq))},m.\u0275dir=o.lG2({type:m,selectors:[["","appDecimalNumber",""]],hostBindings:function(d,f){1&d&&o.NdJ("keydown",function(e){return f.onKeyDown(e)})("blur",function(){return f.setInputFocusOut()})}}),m})()}}]);