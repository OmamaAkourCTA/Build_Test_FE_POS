"use strict";(self.webpackChunkmarkaizaAdmin=self.webpackChunkmarkaizaAdmin||[]).push([[1630],{9452:(x,g,a)=>{a.r(g),a.d(g,{provideExpensesModule:()=>I});var l=a(36895),u=a(39485),c=a(2755),f=a(99132),m=a(78372),h=a(71884),C=a(86260),e=a(94650),b=a(42953),d=a(24006),P=a(75304),y=a(72054),T=a(72657),v=a(72402),D=a(49973),M=a(85746),A=a(82757);function E(i,p){if(1&i){const t=e.EpF();e.TgZ(0,"span",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.f.get("replenishmentRequest").setValue(""))}),e._UZ(1,"i",20),e.qZA()}}function Z(i,p){if(1&i){const t=e.EpF();e.TgZ(0,"span",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.f.get("receipt").setValue(""))}),e._UZ(1,"i",20),e.qZA()}}function S(i,p){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",24)(2,"button",25),e._uU(3,"View Receipt"),e.qZA()(),e.TgZ(4,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().row,r=e.oxw();return e.KtG(r.viewDetails(o))}),e._uU(5,"View Details"),e.qZA(),e.TgZ(6,"input",27,28),e.NdJ("change",function(o){e.CHM(t);const r=e.oxw().row,s=e.oxw();return e.KtG(s.onFileChange(o,r))}),e.qZA(),e.TgZ(8,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(7);return e.KtG(o.click())}),e._uU(9,"Upload Signed Receipt"),e.qZA(),e.BQk()}if(2&i){const t=e.oxw().row;e.xp6(1),e.s9C("href",null==t?null:t.voucher,e.LSH)}}function k(i,p){if(1&i){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().row,r=e.oxw();return e.KtG(r.openModalTrigger(o))}),e._uU(1,"Provide"),e.qZA()}}function F(i,p){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,S,10,1,"ng-container",22),e.YNc(2,k,2,0,"button",23),e.qZA()),2&i){const t=p.row;e.xp6(1),e.Q6J("ngIf",null==t?null:t.provided),e.xp6(1),e.Q6J("ngIf",!(null!=t&&t.provided))}}const _=function(){return{containerClass:"theme-red",adaptivePosition:!0}},N=[{path:"",component:(()=>{class i{constructor(t,n,o,r,s){this.modalService=t,this.fb=n,this._commonService=o,this._provideExpensesService=r,this._pettyCashService=s,this.provideExpensesList=[],this.pageNo=1,this.total=0,this.limit=6,this.tableConfig={paging:!0,filter:{Sort:1,PageSize:this.limit}},this.tableColumns=[],this.filterParams=""}ngOnInit(){this.initTableColumns(),this.initFilterForm(),this.getList()}get f(){return this.filterForm}initFilterForm(){this.filterForm=this.fb.group({replenishmentRequest:[""],receipt:[""],appDate:[""],requestApprovalDateFrom:[""],requestApprovalDateTo:[""],proDate:[""],providingDateFrom:[""],providingDateTo:[""]}),this.filterForm.valueChanges.pipe((0,m.b)(500),(0,h.x)()).subscribe(t=>{this.pageNo=1;let n=this._commonService.trim(t);n?.appDate&&(n={...n,requestApprovalDateFrom:this._commonService.transformDate(n?.appDate[0]),requestApprovalDateTo:this._commonService.transformDate(n?.appDate[1])}),n?.proDate&&(n={...n,providingDateFrom:this._commonService.transformDate(n?.proDate[0]),providingDateTo:this._commonService.transformDate(n?.proDate[1])}),delete n.appDate,delete n.proDate,this.filterParams=new URLSearchParams(n).toString(),this.getList(this.filterParams)})}onFileChange(t,n){let o=[...t.target.files];o.length>0&&(this._commonService.checkInvalidImageFormat(o)||o.forEach(s=>{this._commonService.fileToBase64(s).then(w=>{this.uploadedFile=w,this.uploadConfirmReceivePettyCashAmount(n)})}))}uploadConfirmReceivePettyCashAmount(t){if(!this.uploadedFile?.file)return;let n=new FormData;n.append("PettyCashRequestId",t?.pettyCashRequestId),n.append("ConfirnReceivingVoucher",this.uploadedFile.file),this._pettyCashService.uploadConfirmReceivePettyCashAmount(n).subscribe(o=>{console.log(o),o.data&&this.responseModal("success","The receipt has been uploaded successfully")},o=>{this.responseModal("error",o?.error?.errors)})}responseModal(t,n){const o=this.modalService.open(C.i);o.componentInstance.type=t,o.componentInstance.dismissOnlyActive=!0,"success"==t?o.componentInstance.message=n:o.componentInstance.messageError=n}getList(t){let n="",o=`pageSize=${this.tableConfig.filter.PageSize}&pageNo=${this.pageNo-1}&sort=${this.tableConfig.filter.Sort}`;n=t?`?${t}&${o}`:`?${o}`,this._provideExpensesService.getProvideExpenses(n).subscribe(r=>{r.data.length&&(this.provideExpensesList=r?.data,this.total=r?.totalRecordCount)})}onSortChange(t){if(t?.direction&&t?.column)switch(t.column){case"register.branch.branchName":this.tableConfig.filter.Sort="desc"===t.direction?3:2;break;case"register.registerId":this.tableConfig.filter.Sort="desc"===t.direction?5:4;break;case"modifiedAt":this.tableConfig.filter.Sort="desc"===t.direction?7:6;break;case"createdBy.fullName":this.tableConfig.filter.Sort="desc"===t.direction?9:8;break;case"approvedAmount":this.tableConfig.filter.Sort="desc"===t.direction?11:10}else this.tableConfig.filter.Sort=1;this.getList()}onPageChange(t){this.pageNo=t,this.getList()}initTableColumns(){this.tableColumns=[{key:"pettyCashRequestId",label:"Request No."},{key:"register.branch.branchName",label:"Branch",canSort:!0},{key:"register.registerId",label:"Register No",canSort:!0},{key:"modifiedAt",label:"Request Approval Date",canSort:!0,dateFormat:"mediumDate",placeholder:"---"},{key:"providedAt",label:"Providing Date",dateFormat:"mediumDate",placeholder:"---"},{key:"createdBy.fullName",label:"Cashier",canSort:!0},{key:"approvedAmount",label:"Amount",canSort:!0,currency:{decimalFormat:"2.3-3",appendText:" JOD"}},{key:"action",label:"Action"}]}viewDetails(t){this.modalService.open(f.f,{backdrop:"static",keyboard:!1,size:"xl"}).componentInstance.data={...t,from:"providePettyCash"}}openModalTrigger(t){const n=this.modalService.open(c.U,{backdrop:"static",keyboard:!1,size:"xl"});n.componentInstance.registerDetails=t,n.componentInstance.sendtoLoadData.subscribe(o=>{console.log("resendtoLoadDatasult",o),this.modalService.dismissAll(),this.getList()})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(b.FF),e.Y36(d.qu),e.Y36(P.v),e.Y36(y.r),e.Y36(T.$))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-provide-expenses"]],decls:31,vars:13,consts:[[1,"card-page","mt-3"],[3,"formGroup"],[1,"row","mb-3"],[1,"col-md-3"],[1,"input-group"],[1,"input-group-text"],[1,"light-gray","fa-solid","fa-search"],["type","text","formControlName","replenishmentRequest","placeholder","Request No.","numbersOnly","",1,"form-control"],["class","input-group-text cursor-pointer ",3,"click",4,"ngIf"],["type","text","formControlName","receipt","placeholder","Receipt",1,"form-control"],["type","text","formControlName","appDate","placeholder","Request Approval Date","bsDaterangepicker","","placement","bottom",1,"form-control",3,"bsConfig"],["adrp","bsDaterangepicker"],[1,"input-group-text","cursor-pointer",3,"click"],[1,"light-gray","fas","fa-calendar"],["type","text","formControlName","proDate","placeholder","Providing Date","bsDaterangepicker","","placement","bottom",1,"form-control",3,"bsConfig"],["pdrp","bsDaterangepicker"],[1,"row"],[1,"col-12"],[3,"config","columns","data","page","total","limit","pageUpdated","sortUpdated"],["libTableAdvancedColumn","action"],[1,"light-gray","fa-solid","fa-xmark"],[1,"d-flex","gap-2"],[4,"ngIf"],["class","redBtn",3,"click",4,"ngIf"],["target","_blank",3,"href"],["type","button",1,"redBtn"],["type","button",1,"redBtn",3,"click"],["type","file","hidden","","accept",".jpeg,.jpg,.png,.pdf",3,"change"],["fileRef",""],[1,"redBtn",3,"click"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),e._UZ(6,"i",6),e.qZA(),e._UZ(7,"input",7),e.YNc(8,E,2,0,"span",8),e.qZA()(),e.TgZ(9,"div",3)(10,"div",4)(11,"span",5),e._UZ(12,"i",6),e.qZA(),e._UZ(13,"input",9),e.YNc(14,Z,2,0,"span",8),e.qZA()(),e.TgZ(15,"div",3)(16,"div",4),e._UZ(17,"input",10,11),e.TgZ(19,"span",12),e.NdJ("click",function(){e.CHM(o);const s=e.MAs(18);return e.KtG(s.toggle())}),e._UZ(20,"i",13),e.qZA()()(),e.TgZ(21,"div",3)(22,"div",4),e._UZ(23,"input",14,15),e.TgZ(25,"span",12),e.NdJ("click",function(){e.CHM(o);const s=e.MAs(24);return e.KtG(s.toggle())}),e._UZ(26,"i",13),e.qZA()()()()(),e.TgZ(27,"div",16)(28,"div",17)(29,"table-advanced",18),e.NdJ("pageUpdated",function(s){return n.onPageChange(s)})("sortUpdated",function(s){return n.onSortChange(s)}),e.YNc(30,F,3,2,"ng-template",19),e.qZA()()()()}2&t&&(e.xp6(1),e.Q6J("formGroup",n.filterForm),e.xp6(7),e.Q6J("ngIf",n.f.get("replenishmentRequest").value),e.xp6(6),e.Q6J("ngIf",n.f.get("receipt").value),e.xp6(3),e.Q6J("bsConfig",e.DdM(11,_)),e.xp6(6),e.Q6J("bsConfig",e.DdM(12,_)),e.xp6(6),e.Q6J("config",n.tableConfig)("columns",n.tableColumns)("data",n.provideExpensesList)("page",n.pageNo)("total",n.total)("limit",n.limit))},dependencies:[l.O5,v.FR,v.TB,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,D.V,M.y,A.N],styles:[".applyMargin[_ngcontent-%COMP%]{margin-top:2.5rem}.total[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:15px 0 0;padding:10px 0}.total[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;font-size:16px;line-height:19px;color:#929eae;margin:0;padding:10px 0}.card-table[_ngcontent-%COMP%]{border:.5px solid #f4f4f4;box-shadow:3px 7px 12px #0000002e;-webkit-box-shadow:3px 7px 12px 0px rgba(0,0,0,.18);-moz-box-shadow:3px 7px 12px 0px rgba(0,0,0,.18)}.btn-provide[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;outline:none;border:none;padding:8px 14px;border-radius:4px;font-size:12px;width:80px}.btn-disabled[_ngcontent-%COMP%]{background-color:#c5c6c7;color:#fff;outline:none;border:none;padding:8px 14px;border-radius:4px;font-size:12px;width:80px}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:end;align-items:center;gap:8px}.play-left[_ngcontent-%COMP%]{color:#eceaea;transform:rotate(180deg);margin-right:5px}.play-right[_ngcontent-%COMP%]{color:#eceaea}"]}),i})()}];let R=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[u.Bz.forChild(N),u.Bz]}),i})();var U=a(21515);let I=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[l.ez,R,U.m]}),i})()},28424:(x,g,a)=>{a.d(g,{N:()=>u});var l=a(94650);let u=(()=>{class c{}return c.\u0275fac=function(m){return new(m||c)},c.\u0275cmp=l.Xpm({type:c,selectors:[["app-loading"]],decls:2,vars:0,consts:[[1,"loading"],[1,"fa-solid","fa-circle-notch","fa-spin"]],template:function(m,h){1&m&&(l.TgZ(0,"div",0),l._UZ(1,"i",1),l.qZA())},styles:[".loading[_ngcontent-%COMP%]{text-align:center;padding:30px}.loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:46px;color:#dc3545}.loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:250px}"]}),c})()}}]);