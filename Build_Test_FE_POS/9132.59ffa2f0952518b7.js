"use strict";(self.webpackChunkmarkaizaAdmin=self.webpackChunkmarkaizaAdmin||[]).push([[9132],{99132:(U,c,o)=>{o.d(c,{f:()=>E});var e=o(94650),p=o(72657),u=o(69082),_=o(42953),g=o(64249),m=o(75304),d=o(36895),h=o(49973),v=o(85746),x=o(67761);function C(i,a){if(1&i&&(e.TgZ(0,"p")(1,"b"),e._uU(2," Date"),e.qZA(),e._uU(3),e.ALo(4,"date"),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" ",e.xi3(4,1,t.details.createdAt,"mediumDate"),"")}}function f(i,a){if(1&i&&(e.ynx(0),e.TgZ(1,"div",25)(2,"div",9)(3,"h4"),e._uU(4," Branch Name "),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()()(),e.TgZ(7,"div",26)(8,"div",9)(9,"h4"),e._uU(10," Register No. "),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.qZA()()(),e.TgZ(13,"div",25)(14,"div",9)(15,"h4"),e._uU(16," Register Name"),e.qZA(),e.TgZ(17,"p"),e._uU(18),e.qZA()()(),e.TgZ(19,"div",26)(20,"div",9)(21,"h4"),e._uU(22," Requested Amount "),e.qZA(),e.TgZ(23,"p"),e._uU(24),e.ALo(25,"number"),e.qZA()()(),e.TgZ(26,"div",26)(27,"div",9)(28,"h4",27),e._uU(29," Status "),e.qZA(),e.TgZ(30,"span",28),e._uU(31),e.qZA()()(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(6),e.hij(" ",null==t.details||null==t.details.register?null:t.details.register.branch.branchName," "),e.xp6(6),e.hij(" ",null==t.details||null==t.details.register?null:t.details.register.registerId," "),e.xp6(6),e.hij(" ",null==t.details||null==t.details.register?null:t.details.register.registersName," "),e.xp6(6),e.hij(" ",e.xi3(25,9,null==t.details?null:t.details.requestedAmount,"2.3-3")," JOD"),e.xp6(6),e.Udp("background-color",t.details.statusObj.lookupBGColor)("color",t.details.statusObj.lookupTextColor),e.xp6(1),e.hij(" ",t.details.statusObj.description," ")}}function A(i,a){if(1&i&&(e.TgZ(0,"div",29)(1,"div",5)(2,"div",30)(3,"div",9)(4,"h4"),e._uU(5," Branch Name "),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.qZA()()(),e.TgZ(8,"div",30)(9,"div",9)(10,"h4"),e._uU(11," Register No. "),e.qZA(),e.TgZ(12,"p"),e._uU(13),e.qZA()()(),e.TgZ(14,"div",30)(15,"div",9)(16,"h4"),e._uU(17," Register Name"),e.qZA(),e.TgZ(18,"p"),e._uU(19),e.qZA()()()()(),e.TgZ(20,"div",31)(21,"div",5)(22,"div",25)(23,"div",9)(24,"h4"),e._uU(25," Request No."),e.qZA(),e.TgZ(26,"p"),e._uU(27),e.qZA()()(),e.TgZ(28,"div",25)(29,"div",9)(30,"h4"),e._uU(31," Requested Amount "),e.qZA(),e.TgZ(32,"p"),e._uU(33),e.ALo(34,"number"),e.qZA()()(),e.TgZ(35,"div",25)(36,"div",9)(37,"h4"),e._uU(38," Provided Amount"),e.qZA(),e.TgZ(39,"p"),e._uU(40),e.ALo(41,"number"),e.qZA()()(),e.TgZ(42,"div",25)(43,"div",9)(44,"h4",27),e._uU(45," Status "),e.qZA(),e.TgZ(46,"span",28),e._uU(47),e.qZA()()()()()),2&i){const t=e.oxw(2);e.xp6(7),e.hij(" ",null==t.details||null==t.details.register?null:t.details.register.branch.branchName," "),e.xp6(6),e.hij(" ",null==t.details||null==t.details.register?null:t.details.register.registerId," "),e.xp6(6),e.hij(" ",null==t.details||null==t.details.register?null:t.details.register.registersName," "),e.xp6(8),e.hij(" ",null==t.details?null:t.details.pettyCashRequestId," "),e.xp6(6),e.hij(" ",e.xi3(34,11,null==t.details?null:t.details.requestedAmount,"2.3-3")," JOD"),e.xp6(7),e.hij(" ",e.xi3(41,14,null==t.details?null:t.details.approvedAmount,"2.3-3")," JOD "),e.xp6(6),e.Udp("background-color",t.details.statusObj.lookupBGColor)("color",t.details.statusObj.lookupTextColor),e.xp6(1),e.hij(" ",t.details.statusObj.description," ")}}function q(i,a){if(1&i&&(e.TgZ(0,"div",32)(1,"div",9)(2,"h4"),e._uU(3," Rejected Reason "),e.qZA(),e.TgZ(4,"div",33)(5,"p"),e._uU(6),e.qZA()()()()),2&i){const t=e.oxw(2);e.xp6(6),e.hij(" ",t.details.rejectionReason," ")}}function R(i,a){if(1&i&&(e.TgZ(0,"div",34)(1,"h6",35),e._uU(2,"Receiving Confirmation Attachment"),e.qZA(),e._UZ(3,"view-file",36),e.qZA()),2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("file",t.confirmReceivingVoucherAttachment)}}function b(i,a){if(1&i&&(e._uU(0),e.ALo(1,"number")),2&i){const t=a.row;e.hij(" ",e.xi3(1,1,null==t?null:t.expenseTotalAmount,"2.3-3")," JOD ")}}function Z(i,a){if(1&i&&(e._uU(0),e.ALo(1,"date")),2&i){const t=a.row;e.hij(" ",e.xi3(1,1,null==t?null:t.invoiceDate,"mediumDate")," ")}}function T(i,a){if(1&i&&(e._uU(0),e.ALo(1,"date")),2&i){const t=a.row;e.hij(" ",e.xi3(1,1,null==t?null:t.createdAt,"mediumDate")," ")}}function D(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",5),e.YNc(1,f,32,12,"ng-container",6),e.YNc(2,A,48,17,"ng-template",null,7,e.W1O),e.TgZ(4,"div",8)(5,"div",9)(6,"h4"),e._uU(7," Note "),e.qZA(),e.TgZ(8,"div",10)(9,"p"),e._uU(10),e.qZA()()()(),e.YNc(11,q,7,1,"div",11),e.YNc(12,R,4,1,"div",12),e.TgZ(13,"div",13)(14,"div",14)(15,"h6",15),e._uU(16," Approved Expenses During Provided Replenishment"),e.qZA(),e.TgZ(17,"button",16),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.exportApprovedPettyCashRequestExpensesList())}),e._UZ(18,"i",17),e._uU(19,"Export Expenses List "),e.qZA()(),e.TgZ(20,"table-advanced",18),e.NdJ("scrollUpdate",function(s){e.CHM(t);const l=e.oxw();return e.KtG(l.onsScrollUpdate(s))})("pageUpdated",function(s){e.CHM(t);const l=e.oxw();return e.KtG(l.onPageChange(s))}),e.YNc(21,b,2,4,"ng-template",19),e.YNc(22,Z,2,4,"ng-template",20),e.YNc(23,T,2,4,"ng-template",21),e.qZA()(),e.TgZ(24,"div",22)(25,"div",23)(26,"button",24),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.activeModal.close("Close click"))}),e._uU(27,"Close"),e.qZA()()()()}if(2&i){const t=e.MAs(3),n=e.oxw();e.xp6(1),e.Q6J("ngIf","providePettyCash"!==(null==n.data?null:n.data.from))("ngIfElse",t),e.xp6(9),e.hij(" ",n.details.requestNote," "),e.xp6(1),e.Q6J("ngIf","Rejected"==n.details.statusObj.description),e.xp6(1),e.Q6J("ngIf",n.confirmReceivingVoucherAttachment),e.xp6(8),e.Q6J("config",n.tableConfig)("columns",n.tableColumns)("data",n.approvedRequestList)("loading",n.loading)("page",n.pageNo)("total",n.total)("limit",n.limit)}}let E=(()=>{class i{constructor(t,n,s,l,r){this.pettyCashService=t,this.sharedService=n,this.activeModal=s,this._excelService=l,this._commonService=r,this.approvedRequestList=[],this.tableColumns=[],this.loading=!1,this.pageNo=1,this.total=0,this.limit=4,this.tableConfig={filter:{Sort:1,PageSize:this.limit},hideTotalRecord:!0,infiniteScroll:{isScroll:!0},style:{otherStyle:{height:"170px",overflow:"auto"}}}}ngOnInit(){this.initTableColumns(),this.getPettyCashRequestExpensesList(),this.getRegisterPettycashrequestDetails()}exportToExcel(t){let n=[this.details?.register?.branch?.branchName,this.details?.register?.registerId,this.details?.register?.registersName,this.details?.pettyCashRequestId,this._commonService.transformDecimal(this.details?.requestedAmount),this._commonService.transformDecimal(this.details?.approvedAmount),this.details?.requestNote],s=t.map((r,P)=>[P+1,r?.invoiceNo,this._commonService.transformDate(r?.invoiceDate),r?.category[0]?.lookupName,r?.costCenter?.costCenterName,r?.costCenter?.approverUser?.fullName,r?.managerApproval?.approvername,this._commonService.transformDecimal(r?.expenseTotalAmount),this._commonService.transformDate(this.data?.providedAt)]);this._excelService.exportToExcelJs({sections:[{headers:["Branch Name","Register No.","Regsiter Name","Request No.","Requested Amount","Provided Amount","Notes"],data:n,heading:["Request Details"],showAsKeyValue:!0},{headers:["Seq","Invoice No.","Invoice Date","Category","Cost Center Name","Cost Center Approver","Approved By","Amount","Providing Date"],data:s,heading:["Expense Details"]}],fileName:"Petty_Cash_Replenishment_Report",mainHeading:"Petty Cash Replenishment Report"})}exportApprovedPettyCashRequestExpensesList(){this.pettyCashService.getPettyCashRequestExpensesList(`?RegisterId=${this.data.registerId}&ReplenishmentRequestID=${this.data.pettyCashRequestId}&pageNo=0&pageSize=10000`).subscribe({next:n=>{let s=n?.data?.data.filter(l=>2004==l.status);this.exportToExcel(s)}})}getRegisterPettycashrequestDetails(){this.pettyCashService.GetRegisterPettycashrequestDetails(this.data.pettyCashRequestId).subscribe(t=>{this.details=t.data})}onsScrollUpdate(t){t?.scrolled&&(this.pageNo+=1,this.getPettyCashRequestExpensesList())}getPettyCashRequestExpensesList(){this.pettyCashService.getPettyCashRequestExpensesList(`?RegisterId=${this.data.registerId}&ReplenishmentRequestID=${this.data.pettyCashRequestId}&pageNo=${this.pageNo-1}&pageSize=${this.tableConfig.filter.PageSize}`).subscribe(n=>{if(n?.isSuccess){let s=n.data.data;if(!s?.length)return;let l=s.filter(r=>2004==r.status);this.approvedRequestList=[...this.approvedRequestList,...l],this.total=n.data?.totalRecordCount,this.confirmReceivingVoucherAttachment=n?.data?.info?.confirnReceivingVoucher}})}onPageChange(t){this.pageNo=t,this.getPettyCashRequestExpensesList()}initTableColumns(){this.tableColumns=[{key:"invoiceNo",label:"Invoice No"},{key:"invoiceDate",label:"Invoice Date"},{key:"category[0].lookupName",label:"Category"},{key:"costCenter.costCenterName",label:"Cost Center Name"},{key:"costCenter.approverUser.fullName",label:"Cost Center Approver"},{key:"managerApproval.approvername",label:"Approved By",placeholder:"---"},{key:"expenseTotalAmount",label:"Amount"},{key:"createdAt",label:"Date"}]}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.$),e.Y36(u.F),e.Y36(_.Kz),e.Y36(g.x),e.Y36(m.v))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-expense-request-details"]],inputs:{data:"data"},decls:7,vars:2,consts:[[1,"modal-body"],[1,"modal-head","d-flex","justify-content-between"],[4,"ngIf"],[1,"aboutreq"],["class","row",4,"ngIf"],[1,"row"],[4,"ngIf","ngIfElse"],["fromProvidedPettyCash",""],[1,"col-sm-12"],[1,"card-sm"],[1,"note",2,"height","60px"],["class","col-sm-6",4,"ngIf"],["class","col-md-4 mt-3",4,"ngIf"],[1,"col-12","mt-3"],[1,"d-flex","align-items-center","justify-content-between"],[1,"fw-500","mb-0"],["type","button",1,"btnSm","green","redBtn","d-flex","align-items-center","p-2","gap-2",3,"click"],[1,"fa-solid","fa-file-excel","fa-2x"],[3,"config","columns","data","loading","page","total","limit","scrollUpdate","pageUpdated"],["libTableAdvancedColumn","expenseTotalAmount"],["libTableAdvancedColumn","invoiceDate"],["libTableAdvancedColumn","createdAt"],[1,"col-md-12"],[1,"btns-group","my-2","mx-0"],["type","button",1,"btn","btn-save",3,"click"],[1,"col-sm-3"],[1,"col-sm-2"],[1,"mb-3"],[1,"pending"],[1,"col-5"],[1,"col-sm-4"],[1,"col-7"],[1,"col-sm-6"],[1,"note"],[1,"col-md-4","mt-3"],[1,"fw-500","mb-2"],[3,"file"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4"),e._uU(3,"Request Details "),e.qZA(),e.YNc(4,C,5,4,"p",2),e.qZA(),e.TgZ(5,"div",3),e.YNc(6,D,28,12,"div",4),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngIf",n.details),e.xp6(2),e.Q6J("ngIf",n.details))},dependencies:[d.O5,h.V,v.y,x.g,d.JJ,d.uU],styles:[".modal-head[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;margin-bottom:10px}.modal-head[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:700;font-size:20px;line-height:25px;text-transform:capitalize;color:#1b212d}.modal-head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;font-size:14px;color:#929eae}.modal-head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:#1b212d}.modal-body[_ngcontent-%COMP%]{padding:30px}.aboutreq[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:600;font-size:20px;line-height:25px;color:#54595e;padding:5px 0;margin:0}.card-sm[_ngcontent-%COMP%]{margin:0}.card-sm[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1b212d;margin-bottom:5px}.card-sm[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#929eae}.note[_ngcontent-%COMP%]{background-color:#f0f0f0;height:120px;border-radius:6px;margin:5px 0;overflow:hidden}.note[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#333;padding:10px}"]}),i})()}}]);