"use strict";(self.webpackChunkmarkaizaAdmin=self.webpackChunkmarkaizaAdmin||[]).push([[6057],{32298:(O,y,u)=>{u.d(y,{g:()=>x});var s=u(94650),g=u(42953),h=u(11481),e=u(36895);function l(_,T){if(1&_&&(s.ynx(0),s._UZ(1,"img",6),s.BQk()),2&_){const m=s.oxw(2);s.xp6(1),s.Q6J("src",null==m.imageUploadedView?null:m.imageUploadedView.base64,s.LSH)}}function f(_,T){if(1&_&&(s.TgZ(0,"div",7),s._UZ(1,"img",8)(2,"br"),s.TgZ(3,"a",9),s._uU(4,"click to open pdf "),s.qZA()()),2&_){const m=s.oxw(2);s.xp6(3),s.Q6J("href",m.viewPdf(null==m.imageUploadedView?null:m.imageUploadedView.file),s.LSH)}}function p(_,T){if(1&_){const m=s.EpF();s.ynx(0),s.TgZ(1,"div",2),s.YNc(2,l,2,1,"ng-container",0),s.YNc(3,f,5,1,"ng-template",null,3,s.W1O),s.qZA(),s.TgZ(5,"div",4)(6,"button",5),s.NdJ("click",function(){s.CHM(m);const Z=s.oxw();return s.KtG(Z.activeModal.close("Close click"))}),s._uU(7," Close "),s.qZA()(),s.BQk()}if(2&_){const m=s.MAs(4),b=s.oxw();s.xp6(2),s.Q6J("ngIf","image/png"==(null==b.imageUploadedView?null:b.imageUploadedView.fileType)||"image/jpeg"==(null==b.imageUploadedView?null:b.imageUploadedView.fileType)||"image/jpg"==(null==b.imageUploadedView?null:b.imageUploadedView.fileType))("ngIfElse",m)}}function c(_,T){if(1&_&&(s.ynx(0),s._UZ(1,"img",11),s.BQk()),2&_){const m=s.oxw(2);s.xp6(1),s.Q6J("src",m.fileURL,s.LSH)}}function v(_,T){if(1&_&&(s.ynx(0),s.TgZ(1,"div",7),s._UZ(2,"img",8)(3,"br"),s.TgZ(4,"a",9),s._uU(5,"click to open PDF "),s.qZA()(),s.BQk()),2&_){const m=s.oxw(3);s.xp6(4),s.s9C("href",m.fileURL,s.LSH)}}function k(_,T){if(1&_&&(s.ynx(0,12),s.YNc(1,v,6,1,"ng-container",13),s.BQk()),2&_){const m=s.oxw(2);s.Q6J("ngSwitch",m.fileType),s.xp6(1),s.Q6J("ngSwitchCase","pdf")}}function C(_,T){if(1&_){const m=s.EpF();s.TgZ(0,"div",2),s.YNc(1,c,2,1,"ng-container",0),s.YNc(2,k,2,2,"ng-template",null,10,s.W1O),s.qZA(),s.TgZ(4,"div",4)(5,"button",5),s.NdJ("click",function(){s.CHM(m);const Z=s.oxw();return s.KtG(Z.activeModal.close("Close click"))}),s._uU(6," Close "),s.qZA()()}if(2&_){const m=s.MAs(3),b=s.oxw();s.xp6(1),s.Q6J("ngIf","png"==b.fileType||"jpeg"==b.fileType||"jpg"==b.fileType||"svg"==b.fileType)("ngIfElse",m)}}let x=(()=>{class _{constructor(m,b){this.activeModal=m,this.sanitizer=b,this.viewOnly=!1,this.fileType="",this.fileURL=""}ngOnInit(){console.log(this.imageUploadedView),this.viewOnly=this.imageUploadedView?.viewOnly,this.viewOnly&&(this.fileType=this.getFileType(this.imageUploadedView.url),this.fileURL=this.imageUploadedView.url)}viewPdf(m){let b=URL.createObjectURL(m);return this.sanitizer.bypassSecurityTrustResourceUrl(b)}getFileType(m){return m?.split(".").pop().trim().toLowerCase()}}return _.\u0275fac=function(m){return new(m||_)(s.Y36(g.Kz),s.Y36(h.H7))},_.\u0275cmp=s.Xpm({type:_,selectors:[["app-view-file"]],inputs:{imageUploadedView:"imageUploadedView"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["viewOnlyURL",""],[1,"modal-body","p-2"],["pdf",""],[1,"btns-group","my-2","mx-0"],["type","button",1,"btn","btn-cancel",3,"click"],[1,"w-100",3,"src"],[1,"d-flex","justify-content-center","flex-column","align-items-center"],["height","80","width","80","src","assets/images/pdf.png","alt",""],["target","_blank",1,"text-decoration-none","text-capitalize",3,"href"],["elseExtViewBlock",""],[1,"w-100","mb-2",3,"src"],[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(m,b){if(1&m&&(s.YNc(0,p,8,2,"ng-container",0),s.YNc(1,C,7,2,"ng-template",null,1,s.W1O)),2&m){const Z=s.MAs(2);s.Q6J("ngIf",!b.viewOnly)("ngIfElse",Z)}},dependencies:[e.O5,e.RF,e.n9],styles:[".imagepath[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.imagepath-no[_ngcontent-%COMP%]{text-align:center;padding:50px}.btns-group[_ngcontent-%COMP%]{display:flex;justify-content:center}.btns-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background:#f8f8f8;color:#dc3545;border-radius:10px;padding:12px 35px;font-weight:600}.card-pdf[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:150px}.card-pdf[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;font-size:18px;font-weight:600;display:block;padding:15px}"]}),_})()},26057:(O,y,u)=>{u.r(y),u.d(y,{ReturnTreasuryFundModule:()=>ot});var s=u(36895),g=u(39485),h=u(59241),e=u(94650),l=u(69082),f=u(75706),p=u(38936),c=u(24006),v=u(41746),k=u(32298),C=u(42953),x=u(43346),_=u(75304),T=u(94349),m=u(82757),b=u(80145);const Z=["fileInput"];function F(a,o){1&a&&(e.TgZ(0,"span",37),e._uU(1,"Input is required"),e.qZA())}function w(a,o){if(1&a&&(e.ynx(0),e.YNc(1,F,2,0,"span",36),e.BQk()),2&a){const t=e.oxw(3);let n;e.xp6(1),e.Q6J("ngIf",null==t.chequeForm||null==(n=t.chequeForm.get("chequeDate"))?null:n.errors.required)}}function P(a,o){if(1&a&&(e.ynx(0),e.YNc(1,w,2,1,"ng-container",30),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",(null==t.chequeForm||null==(n=t.chequeForm.get("chequeDate"))?null:n.invalid)&&(null==t.chequeForm||null==(n=t.chequeForm.get("chequeDate"))?null:n.touched)||(null==t.chequeForm||null==(n=t.chequeForm.get("chequeDate"))?null:n.dirty))}}function U(a,o){1&a&&(e.TgZ(0,"span",37),e._uU(1,"Input is required"),e.qZA())}function D(a,o){if(1&a&&(e.ynx(0),e.YNc(1,U,2,0,"span",36),e.BQk()),2&a){const t=e.oxw(3);let n;e.xp6(1),e.Q6J("ngIf",null==t.chequeForm||null==(n=t.chequeForm.get("chequeNo"))?null:n.errors.required)}}function M(a,o){if(1&a&&(e.ynx(0),e.YNc(1,D,2,1,"ng-container",30),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",(null==t.chequeForm||null==(n=t.chequeForm.get("chequeNo"))?null:n.invalid)&&(null==t.chequeForm||null==(n=t.chequeForm.get("chequeNo"))?null:n.touched)||(null==t.chequeForm||null==(n=t.chequeForm.get("chequeNo"))?null:n.dirty))}}function J(a,o){1&a&&(e.TgZ(0,"span",37),e._uU(1,"Input is required"),e.qZA())}function B(a,o){if(1&a&&(e.ynx(0),e.YNc(1,J,2,0,"span",36),e.BQk()),2&a){const t=e.oxw(3);let n;e.xp6(1),e.Q6J("ngIf",null==t.chequeForm||null==(n=t.chequeForm.get("bankId"))?null:n.errors.required)}}function Q(a,o){if(1&a&&(e.ynx(0),e.YNc(1,B,2,1,"ng-container",30),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",(null==t.chequeForm||null==(n=t.chequeForm.get("bankId"))?null:n.invalid)&&(null==t.chequeForm||null==(n=t.chequeForm.get("bankId"))?null:n.touched)||(null==t.chequeForm||null==(n=t.chequeForm.get("bankId"))?null:n.dirty))}}function L(a,o){1&a&&(e.TgZ(0,"span",37),e._uU(1,"Input is required"),e.qZA())}function j(a,o){if(1&a&&(e.ynx(0),e.YNc(1,L,2,0,"span",36),e.BQk()),2&a){const t=e.oxw(3);let n;e.xp6(1),e.Q6J("ngIf",null==t.chequeForm||null==(n=t.chequeForm.get("chequeDrawerName"))?null:n.errors.required)}}function Y(a,o){if(1&a&&(e.ynx(0),e.YNc(1,j,2,1,"ng-container",30),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",(null==t.chequeForm||null==(n=t.chequeForm.get("chequeDrawerName"))?null:n.invalid)&&(null==t.chequeForm||null==(n=t.chequeForm.get("chequeDrawerName"))?null:n.touched)||(null==t.chequeForm||null==(n=t.chequeForm.get("chequeDrawerName"))?null:n.dirty))}}function E(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"form",23)(1,"div",24)(2,"table",25)(3,"thead")(4,"tr")(5,"th"),e._uU(6,"Cheque Amount"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Due Date"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Cheque No"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Cheque Bank"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Drawer Name"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Action"),e.qZA()()(),e.TgZ(17,"tbody")(18,"tr")(19,"td")(20,"div",26)(21,"div",27)(22,"p",28),e._uU(23),e.ALo(24,"number"),e.qZA()()()(),e.TgZ(25,"td")(26,"div",26),e._UZ(27,"input",29),e.YNc(28,P,2,1,"ng-container",30),e.qZA()(),e.TgZ(29,"td")(30,"div",26),e._UZ(31,"input",31),e.YNc(32,M,2,1,"ng-container",30),e.qZA()(),e.TgZ(33,"td")(34,"div",26),e._UZ(35,"ng-select",32),e.YNc(36,Q,2,1,"ng-container",30),e.qZA()(),e.TgZ(37,"td")(38,"div",26),e._UZ(39,"input",33),e.YNc(40,Y,2,1,"ng-container",30),e.qZA()(),e.TgZ(41,"td")(42,"button",34),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.resetForm("cheque"))}),e._UZ(43,"img",35),e.qZA()()()()()()()}if(2&a){const t=e.oxw();let n,r,i,d;e.Q6J("formGroup",t.chequeForm),e.xp6(23),e.hij("",e.xi3(24,7,null==t.data||null==t.data.details?null:t.data.details.grandAmount,"2.3-3")," JOD"),e.xp6(5),e.Q6J("ngIf",null==t.chequeForm||null==(n=t.chequeForm.get("chequeDate"))?null:n.errors),e.xp6(4),e.Q6J("ngIf",null==t.chequeForm||null==(r=t.chequeForm.get("chequeNo"))?null:r.errors),e.xp6(3),e.Q6J("items",t.banks),e.xp6(1),e.Q6J("ngIf",null==t.chequeForm||null==(i=t.chequeForm.get("bankId"))?null:i.errors),e.xp6(4),e.Q6J("ngIf",null==t.chequeForm||null==(d=t.chequeForm.get("chequeDrawerName"))?null:d.errors)}}function V(a,o){1&a&&(e.TgZ(0,"span",37),e._uU(1,"Input is required"),e.qZA())}function z(a,o){if(1&a&&(e.ynx(0),e.YNc(1,V,2,0,"span",36),e.BQk()),2&a){const t=e.oxw(3);let n;e.xp6(1),e.Q6J("ngIf",null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereDate"))?null:n.errors.required)}}function K(a,o){if(1&a&&(e.ynx(0),e.YNc(1,z,2,1,"ng-container",30),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereDate"))?null:n.invalid)&&(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereDate"))?null:n.touched)||(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereDate"))?null:n.dirty))}}function H(a,o){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=o.item;e.xp6(1),e.Oqu((null==t?null:t.name)+" - "+(null==t?null:t.accountNumber))}}function G(a,o){1&a&&(e.TgZ(0,"span",37),e._uU(1,"Input is required"),e.qZA())}function $(a,o){if(1&a&&(e.ynx(0),e.YNc(1,G,2,0,"span",36),e.BQk()),2&a){const t=e.oxw(3);let n;e.xp6(1),e.Q6J("ngIf",null==t.bankTransferForm||null==(n=t.bankTransferForm.get("markaziaBankAccountId"))?null:n.errors.required)}}function W(a,o){if(1&a&&(e.ynx(0),e.YNc(1,$,2,1,"ng-container",30),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("markaziaBankAccountId"))?null:n.invalid)&&(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("markaziaBankAccountId"))?null:n.touched)||(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("markaziaBankAccountId"))?null:n.dirty))}}function X(a,o){1&a&&(e.TgZ(0,"span",37),e._uU(1,"Input is required"),e.qZA())}function ee(a,o){if(1&a&&(e.ynx(0),e.YNc(1,X,2,0,"span",36),e.BQk()),2&a){const t=e.oxw(3);let n;e.xp6(1),e.Q6J("ngIf",null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereReference"))?null:n.errors.required)}}function te(a,o){if(1&a&&(e.ynx(0),e.YNc(1,ee,2,1,"ng-container",30),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereReference"))?null:n.invalid)&&(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereReference"))?null:n.touched)||(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereReference"))?null:n.dirty))}}function ne(a,o){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"img",47),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.fileAction("view"))}),e.qZA(),e.TgZ(2,"img",48),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.fileAction("delete"))}),e.qZA(),e.BQk()}}function re(a,o){1&a&&(e.TgZ(0,"span",37),e._uU(1,"Input is required"),e.qZA())}function ae(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"div",26),e.YNc(2,re,2,0,"span",36),e.qZA(),e.BQk()),2&a){const t=e.oxw(3);let n;e.xp6(2),e.Q6J("ngIf",null==t.bankTransferForm||null==(n=t.bankTransferForm.get("attachment"))?null:n.errors.required)}}function ie(a,o){if(1&a&&(e.ynx(0),e.YNc(1,ae,3,1,"ng-container",30),e.BQk()),2&a){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("ngIf",(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("attachment"))?null:n.invalid)&&(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("attachment"))?null:n.touched)||(null==t.bankTransferForm||null==(n=t.bankTransferForm.get("attachment"))?null:n.dirty))}}function se(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"form",23)(1,"div",24)(2,"table",25)(3,"thead")(4,"tr")(5,"th"),e._uU(6,"Paid Amount*"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Transfer Date*"),e.qZA(),e.TgZ(9,"th",38),e._uU(10,"Markazia Bank"),e._UZ(11,"br"),e._uU(12," Account No*"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Transfer Refernece*"),e.qZA(),e.TgZ(15,"th",38),e._uU(16,"Transfer Attachment*"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Action"),e.qZA()()(),e.TgZ(19,"tbody")(20,"tr")(21,"td")(22,"div",26)(23,"div",27)(24,"p",28),e._uU(25),e.ALo(26,"number"),e.qZA()()()(),e.TgZ(27,"td")(28,"div",26),e._UZ(29,"input",39),e.YNc(30,K,2,1,"ng-container",30),e.qZA()(),e.TgZ(31,"td")(32,"div",26)(33,"ng-select",40),e.YNc(34,H,2,1,"ng-template",41),e.qZA(),e.YNc(35,W,2,1,"ng-container",30),e.qZA()(),e.TgZ(36,"td")(37,"div",26),e._UZ(38,"input",42),e.YNc(39,te,2,1,"ng-container",30),e.qZA()(),e.TgZ(40,"td")(41,"div",43)(42,"input",44,45),e.NdJ("change",function(r){e.CHM(t);const i=e.oxw();return e.KtG(i.onFileChange(r))}),e.qZA(),e.TgZ(44,"label",46),e._uU(45),e.qZA(),e.YNc(46,ne,3,0,"ng-container",30),e.qZA(),e.YNc(47,ie,2,1,"ng-container",30),e.qZA(),e.TgZ(48,"td")(49,"button",34),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.resetForm())}),e._UZ(50,"img",35),e.qZA()()()()()()()}if(2&a){const t=e.oxw();let n,r,i,d;e.Q6J("formGroup",t.bankTransferForm),e.xp6(25),e.hij("",e.xi3(26,11,null==t.data||null==t.data.details?null:t.data.details.grandAmount,"2.3-3")," JOD"),e.xp6(5),e.Q6J("ngIf",null==t.bankTransferForm||null==(n=t.bankTransferForm.get("transfereDate"))?null:n.errors),e.xp6(3),e.Q6J("items",t.accounts),e.xp6(2),e.Q6J("ngIf",null==t.bankTransferForm||null==(r=t.bankTransferForm.get("markaziaBankAccountId"))?null:r.errors),e.xp6(4),e.Q6J("ngIf",null==t.bankTransferForm||null==(i=t.bankTransferForm.get("transfereReference"))?null:i.errors),e.xp6(5),e.ekj("text-success",null==t.bankTransferForm?null:t.bankTransferForm.get("attachment").value),e.xp6(1),e.hij(" ",(null==t.bankTransferForm?null:t.bankTransferForm.get("attachment").value)&&(null==t.bankTransferForm?null:t.bankTransferForm.get("attachment").value)||"Upload file"," "),e.xp6(1),e.Q6J("ngIf",null==t.bankTransferForm?null:t.bankTransferForm.get("attachment").value),e.xp6(1),e.Q6J("ngIf",null==t.bankTransferForm||null==(d=t.bankTransferForm.get("attachment"))?null:d.errors)}}function oe(a,o){if(1&a&&(e.TgZ(0,"p",49),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function le(a,o){1&a&&(e.TgZ(0,"p",49),e._uU(1,"You can use only one payment method. If you want to choose other please reset the form via action."),e.qZA())}let A=(()=>{class a{constructor(t,n,r,i,d){this._activeModal=t,this._modalService=n,this._collectService=r,this._commonService=i,this.fb=d,this.banks=[],this.accounts=[],this.message="",this.refundType="cheque",this.eventData=new e.vpe,this.isFormChanged=!1,this.isPaymentMethodChanged=!1}ngOnInit(){this.initForm(),this.getBanks(),this.getBankAccounts(),this.chequeForm.statusChanges.subscribe(t=>{this.isFormChanged=!0}),this.bankTransferForm.statusChanges.subscribe(t=>{this.isFormChanged=!0})}initForm(){this.chequeForm=this.fb.group({chequeAmount:[this.data?.details?.grandAmount],chequeNo:["",[c.kI.required]],chequeDate:["",[c.kI.required]],bankId:[null,[c.kI.required]],chequeDrawerName:[{value:"Almarkazia Co",disabled:!0},[c.kI.required]]}),this.bankTransferForm=this.fb.group({paidAmountJod:[this.data?.details?.grandAmount],transfereDate:[(new Date).toISOString().substring(0,10),[c.kI.required]],markaziaBankAccountId:[null,[c.kI.required]],transfereReference:["",[c.kI.required]],attachment:["",[c.kI.required]]})}handleAmountFocus(){this.chequeForm.markAllAsTouched()}onSelect(t){this.isFormChanged?this.isPaymentMethodChanged=!0:this.refundType=t}handleConfirm(){"cheque"==this.refundType?this.treasuryFullRefundSparePartsOrderByCheque():this.treasuryFullRefundSparePartsOrderByBankTransfer()}treasuryFullRefundSparePartsOrderByCheque(){if(this.chequeForm.invalid)return void this.chequeForm.markAllAsTouched();let t;const n=this.chequeForm.getRawValue(),r=new FormData;r.append("RefundAmount",n.chequeAmount),r.append("ChequeAmount",n.chequeAmount),r.append("ChequeDueDate",n.chequeDate),r.append("ChequeBankId",n.bankId),r.append("ChequeNumber",n.chequeNo),r.append("DrawerName",n.chequeDrawerName),7001==this.data?.orderType?(r.append("OrderId",this.data?.details?.servicesSalesOrderNo),t=this._collectService.treasuryRefundServiceOrderByCheque(r)):7002==this.data?.orderType?(r.append("OrderId",this.data?.details?.directPaymentSalesOrderOpportunityNo),t=this._collectService.dpTreasuryFullRefundByCheque(r)):(r.append("OrderId",this.data?.details?.sparePartsSalesOrderOpportunityNo),t=this._collectService.treasuryFullRefundSparePartsOrderByCheque(r)),t.subscribe(i=>{if(console.log(i),i.isSuccess){this.eventData.emit({isSuccess:i.isSuccess});let d={message:"Your refund successfully completed!",invoices:i?.data,buttonName:""};7002==this.data?.orderType&&(d={...d,buttonName:"View Receipt"}),this._modalService.open(v.v).componentInstance.data=d}},i=>{console.log(i?.error?.errors[0]?.ErrorMessageEn),this.message=i?.error?.errors[0]?.ErrorMessageEn,setTimeout(()=>this.message="",5e3)})}treasuryFullRefundSparePartsOrderByBankTransfer(){if(this.bankTransferForm.invalid)return void this.bankTransferForm.markAllAsTouched();let t;const n=this.bankTransferForm.value,r=new FormData;r.append("RefundAmount",n.paidAmountJod),r.append("PaidAmount",n.paidAmountJod),r.append("TrasferDate",n.transfereDate),r.append("MarkaziaBankAccountId",n.markaziaBankAccountId),r.append("TransferReference",n.transfereReference),r.append("TransferAttachment",this.uploadedFile?.file),7001==this.data?.orderType?(r.append("OrderId",this.data?.details?.servicesSalesOrderNo),t=this._collectService.treasuryServiceLayerOrderByBankTransfer(r)):7002==this.data?.orderType?(r.append("OrderId",this.data?.details?.directPaymentSalesOrderOpportunityNo),t=this._collectService.dpTreasuryFullRefundByBankTransfer(r)):(r.append("OrderId",this.data?.details?.sparePartsSalesOrderOpportunityNo),t=this._collectService.treasuryFullRefundSparePartsOrderByBankTransfer(r)),t.subscribe(i=>{if(console.log(i),i.isSuccess){this.eventData.emit({isSuccess:i.isSuccess});let d={message:"Your refund successfully completed!",invoices:i?.data,buttonName:""};7002==this.data?.orderType&&(d={...d,buttonName:"View Receipt"}),this._modalService.open(v.v).componentInstance.data=d}},i=>{console.log(i?.error?.errors[0]?.ErrorMessageEn),this.message=i?.error?.errors[0]?.ErrorMessageEn,setTimeout(()=>this.message="",5e3)})}resetForm(t){"cheque"==t?(this.chequeForm.reset(),this.chequeForm.get("chequeAmount").setValue(this.data?.details?.grandAmount),this.chequeForm.get("chequeDrawerName").setValue("Almarkazya Co")):(this.bankTransferForm.reset(),this.bankTransferForm.get("paidAmountJod").setValue(this.data?.details?.grandAmount),this.inputRef.nativeElement.value=null,this.uploadedFile={}),this.isFormChanged=!1,this.isPaymentMethodChanged=!1}fileAction(t){"view"==t?this._modalService.open(k.g,{size:"md"}).componentInstance.imageUploadedView=this.uploadedFile:(this.inputRef.nativeElement.value=null,this.bankTransferForm.get("transfereAttachment")?.setValue(""),this.bankTransferForm.get("attachment")?.setValue(""),this.uploadedFile={})}onFileChange(t){let n=[...t.target.files];n.length>0&&(this._commonService.checkInvalidImageFormat(n)||n.forEach(i=>{this._commonService.fileToBase64(i).then(d=>{this.uploadedFile=d,this.bankTransferForm.get("attachment")?.setValue(d.fileName)})}))}getBanks(){this._collectService.getBanks().subscribe(t=>{this.banks=t.data.map(n=>({id:n.bankId,name:n.bankNameEnglish}))})}getBankAccounts(){this._collectService.getBankAccounts("?AccountType=15001&currencyId=9001&Status=2001&PageNo=0&PageSize=1000").subscribe(n=>{n.isSuccess&&(this.accounts=n.data.map(r=>({id:r.accountId,name:r.bankNameEnglish,accountNumber:r.accountNumber})))})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(C.Kz),e.Y36(C.FF),e.Y36(x.k),e.Y36(_.v),e.Y36(c.qu))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-refunding"]],viewQuery:function(t,n){if(1&t&&e.Gf(Z,5),2&t){let r;e.iGM(r=e.CRH())&&(n.inputRef=r.first)}},inputs:{data:"data"},outputs:{eventData:"eventData"},decls:43,vars:13,consts:[[1,"fc-modal","p-4","custom-form-input"],[1,"modal-header","p-0","flex-column","align-items-start"],["ngbAutofocus","",1,"modal-title","fw-bolder","pb-1"],[1,"modal-body","p-0"],[1,"row","mt-3"],[1,"col-sm-4"],[1,"fw-500"],[1,"disabled-box"],[1,"fw-500","light-gray"],[1,"col-12"],[1,"fw-500","mb-3"],[1,"d-flex","gap-4","align-items-center"],[1,"payItem",3,"click"],[1,"image-box"],["src","/assets/images/cheque.png"],[1,"fw-500","font-14","m-0"],["src","/assets/images/bank-transfer.png"],[3,"formGroup",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"modal-footer","p-4","border-0"],[1,"btns-group"],["type","button",1,"btn","btn-cancel",3,"click"],["type","button",1,"btn","btn-save",3,"click"],[3,"formGroup"],[1,"card-table"],[1,"table"],[1,"form-group"],[1,"disabled-box","m-0","justify-content-center"],[1,"green-clr","fw-600"],["type","date","placeholder","chequeDate","formControlName","chequeDate",1,"form-control"],[4,"ngIf"],["type","number","placeholder","Cheque No","formControlName","chequeNo","min","1","name","chequeNo","numbersOnly","",1,"form-control"],["placeholder"," Select Bank ","bindLabel","name","bindValue","id","formControlName","bankId",3,"items"],["type","text","placeholder","","formControlName","chequeDrawerName","OnlyCharacter","",1,"form-control"],["title","Reset form",1,"btn",3,"click"],["src","assets/images/reload.png",2,"width","25px"],["class","error",4,"ngIf"],[1,"error"],["width","15%"],["type","date","formControlName","transfereDate",1,"form-control"],["id","accountNo","placeholder"," Select Bank Account ","bindLabel","name","bindValue","id","formControlName","markaziaBankAccountId",3,"items"],["ng-option-tmp",""],["type","number","min","1","placeholder","Transfere Reference","formControlName","transfereReference","numbersOnly","",1,"form-control"],[1,"custom-file","align-items-center"],["type","file","id","file-input",1,"file-input__input",3,"change"],["fileInput",""],["for","file-input",1,"file-input__label"],["height","20","src","assets/images/eye.png",1,"cursor-pointer",3,"click"],["height","20","src","assets/images/trash.png",1,"cursor-pointer",3,"click"],[1,"alert","alert-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4",2),e._uU(3,"Refund"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"label",6),e._uU(8,"Customer Name"),e.qZA(),e.TgZ(9,"div",7)(10,"p",8),e._uU(11),e.qZA()()(),e.TgZ(12,"div",5)(13,"label",6),e._uU(14,"Refund Grand Amount"),e.qZA(),e.TgZ(15,"div",7)(16,"p",8),e._uU(17),e.ALo(18,"number"),e.qZA()()(),e.TgZ(19,"div",9)(20,"label",10),e._uU(21,"Refund Types"),e.qZA(),e.TgZ(22,"div",11)(23,"div",12),e.NdJ("click",function(){return n.onSelect("cheque")}),e.TgZ(24,"div",13),e._UZ(25,"img",14),e.qZA(),e.TgZ(26,"p",15),e._uU(27,"Cheque"),e.qZA()(),e.TgZ(28,"div",12),e.NdJ("click",function(){return n.onSelect("bankTransfer")}),e.TgZ(29,"div",13),e._UZ(30,"img",16),e.qZA(),e.TgZ(31,"p",15),e._uU(32,"Bank Transfer"),e.qZA()()(),e.YNc(33,E,44,10,"form",17),e.YNc(34,se,51,14,"form",17),e.YNc(35,oe,2,1,"p",18),e.YNc(36,le,2,0,"p",18),e.qZA()()()(),e.TgZ(37,"div",19)(38,"div",20)(39,"button",21),e.NdJ("click",function(){return n._activeModal.close("Save click")}),e._uU(40,"Close"),e.qZA(),e.TgZ(41,"button",22),e.NdJ("click",function(){return n.handleConfirm()}),e._uU(42,"Confirm"),e.qZA()()()),2&t&&(e.xp6(11),e.Oqu(null==n.data||null==n.data.details||null==n.data.details.customer?null:n.data.details.customer.customerName),e.xp6(6),e.hij("",e.xi3(18,10,null==n.data||null==n.data.details?null:n.data.details.grandAmount,"2.3-3")," JOD"),e.xp6(6),e.ekj("rt-acitve","cheque"==n.refundType),e.xp6(5),e.ekj("rt-acitve","bankTransfer"==n.refundType),e.xp6(5),e.Q6J("ngIf","cheque"==n.refundType),e.xp6(1),e.Q6J("ngIf","bankTransfer"==n.refundType),e.xp6(1),e.Q6J("ngIf",n.message),e.xp6(1),e.Q6J("ngIf",n.isFormChanged&&n.isPaymentMethodChanged))},dependencies:[s.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.qQ,c.sg,c.u,T.w9,T.ir,m.N,b.Q,s.JJ],styles:[".payItem[_ngcontent-%COMP%]{margin-bottom:0;padding:5px;width:200px;height:125px;box-shadow:0 10px 20px #0000001a;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;cursor:pointer}.payItem[_ngcontent-%COMP%]   .image-box[_ngcontent-%COMP%]{height:45px}.payItem[_ngcontent-%COMP%]   .image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background:#fff}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:7px}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{height:46px}.form-group[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;font-weight:500;font-size:14px}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:disabled{background-color:#f9f9f9}  .ng-dropdown-panel{z-index:9999999!important}.card-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 0 10px 15px!important;font-weight:500}.card-table[_ngcontent-%COMP%]{overflow:visible}.rt-acitve[_ngcontent-%COMP%]{color:#1b212d;border:1px solid var(--primary)}[_nghost-%COMP%]     .nav-pills{gap:10px}[_nghost-%COMP%]     .nav-pills .nav-link{font-size:16px;font-weight:700;color:#1b212d;padding:0;border-radius:12px}[_nghost-%COMP%]     .nav-pills .nav-link.active{background:none;color:#1b212d;border:1px solid var(--primary)}.custom-file[_ngcontent-%COMP%]{border:1px solid #dadada;display:flex;height:46px;border-radius:.375rem;justify-content:center;gap:5px;background:#fff}.file-input__input[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}.file-input__label[_ngcontent-%COMP%]{cursor:pointer;display:inline-flex;align-items:center;border-radius:4px;font-weight:600;color:var(--gray-500);font-size:14px}"]}),a})();var ue=u(71891),ce=u(86260),de=u(67761);function pe(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"thead")(2,"tr")(3,"th"),e._uU(4,"Cheque Amount"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Due Date"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Cheque Bank"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Cheque No."),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Drawer Name"),e.qZA()()(),e.TgZ(13,"tbody")(14,"tr")(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.ALo(19,"date"),e.qZA(),e.TgZ(20,"td"),e._uU(21),e.qZA(),e.TgZ(22,"td"),e._uU(23),e.qZA(),e.TgZ(24,"td"),e._uU(25),e.qZA()()(),e.BQk()),2&a){const t=e.oxw();e.xp6(16),e.Oqu(null==t.details||null==t.details.refund||null==t.details.refund.cheque?null:t.details.refund.cheque.chequeAmount),e.xp6(2),e.Oqu(e.xi3(19,5,null==t.details||null==t.details.refund||null==t.details.refund.cheque?null:t.details.refund.cheque.chequeDueDate,"mediumDate")),e.xp6(3),e.Oqu(null==t.details||null==t.details.refund||null==t.details.refund.cheque||null==t.details.refund.cheque.chequeBank?null:t.details.refund.cheque.chequeBank.bankNameEnglish),e.xp6(2),e.Oqu(null==t.details||null==t.details.refund||null==t.details.refund.cheque?null:t.details.refund.cheque.chequeNumber),e.xp6(2),e.Oqu(null==t.details||null==t.details.refund||null==t.details.refund.cheque?null:t.details.refund.cheque.drawerName)}}function me(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"div",26)(1,"label",27),e._uU(2),e.qZA(),e.TgZ(3,"div",28)(4,"img",29),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.viewFile(null==r.details||null==r.details.refund||null==r.details.refund.transfer?null:r.details.refund.transfer.transferAttachment))}),e.qZA(),e.TgZ(5,"a",30),e._UZ(6,"img",31),e.qZA()()()}if(2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(t.getFileName(null==t.details||null==t.details.refund||null==t.details.refund.transfer?null:t.details.refund.transfer.transferAttachment)),e.xp6(3),e.s9C("href",null==t.details||null==t.details.refund||null==t.details.refund.transfer?null:t.details.refund.transfer.transferAttachment,e.LSH)}}function _e(a,o){if(1&a&&(e.TgZ(0,"thead")(1,"tr")(2,"th"),e._uU(3,"Paid Amount"),e.qZA(),e.TgZ(4,"th"),e._uU(5,"Transfer Date"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Markazia Bank Account No."),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Transfer Reference"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Transfer Attachment"),e.qZA()()(),e.TgZ(12,"tbody")(13,"tr")(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"date"),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.TgZ(23,"td"),e.YNc(24,me,7,2,"div",25),e.qZA()()()),2&a){const t=e.oxw();e.xp6(15),e.Oqu(null==t.details||null==t.details.refund||null==t.details.refund.transfer?null:t.details.refund.transfer.refundAmount),e.xp6(2),e.Oqu(e.xi3(18,5,null==t.details||null==t.details.refund||null==t.details.refund.transfer?null:t.details.refund.transfer.trasferDate,"mediumDate")),e.xp6(3),e.Oqu(null==t.details||null==t.details.refund||null==t.details.refund.transfer||null==t.details.refund.transfer.chequeBank?null:t.details.refund.transfer.chequeBank.bankNameEnglish),e.xp6(2),e.Oqu(null==t.details||null==t.details.refund||null==t.details.refund.transfer?null:t.details.refund.transfer.transferReference),e.xp6(2),e.Q6J("ngIf",null==t.details||null==t.details.refund||null==t.details.refund.transfer?null:t.details.refund.transfer.transferAttachment)}}function ge(a,o){if(1&a&&(e.ynx(0),e.TgZ(1,"div",15)(2,"h6",32),e._uU(3,"Signed Attachment"),e.qZA()(),e.TgZ(4,"div",33),e._UZ(5,"view-file",34),e.qZA(),e.BQk()),2&a){const t=e.oxw();e.xp6(5),e.Q6J("file",null==t.details?null:t.details.signAttachment)}}let q=(()=>{class a{constructor(t,n,r,i){this._activeModal=t,this._collectService=n,this._commonService=r,this._modalService=i}ngOnInit(){this.getReturnOrderRefundDetails()}getReturnOrderRefundDetails(){let t;t=7001==this.data?.orderType?this._collectService.getServiceReturnOrderRefundDetails(this.data?.details?.servicesSalesOrderNo):7002==this.data?.orderType?this._collectService.getReturnDpOrderRefundDetails(this.data?.details?.directPaymentSalesOrderOpportunityNo):this._collectService.getReturnOrderRefundDetails(this.data?.details?.sparePartsSalesOrderOpportunityNo),t.subscribe(n=>{this.details=n.data})}getFileName(t){return t.split("/").pop()}viewFile(t){this._modalService.open(ue.W,{size:"md"}).componentInstance.file=t}downloadInvoice(){7001==this.data?.orderType||7003==this.data?.orderType?this.getInvoice():this._commonService.downloadInvoices({invoices:this.details?.refund?.invoices?.clientCopy})}getInvoice(){let t,n="";const r=new FormData;7001==this.data.orderType?(t=this._collectService.viewServiceLayerReturnOrderOrigionalInvoice(r),n=this.data?.details?.servicesSalesOrderNo||this.data?.details?.returnOrderId,r.append("returnOrderNo",n)):7003==this.data.orderType&&(t=this._collectService.viewReturnOrderOrigionalInvoice(r),n=this.data?.details?.sparePartsSalesOrderOpportunityNo||this.data?.details?.returnOrderId,r.append("returnOrderNo",n)),t.subscribe({next:i=>{i.isSuccess&&this._commonService.downloadURI(i.data)},error:i=>{this.responseModal("error",i?.error.errors||i?.error.Errors)}})}responseModal(t,n){const r=this._modalService.open(ce.i);"success"==t&&(r.componentInstance.message=n),r.componentInstance.messageError=n,r.componentInstance.type=t}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(C.Kz),e.Y36(x.k),e.Y36(_.v),e.Y36(C.FF))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-treasury-refund-details"]],inputs:{data:"data"},decls:61,vars:17,consts:[[1,"fc-modal","p-4"],[1,"modal-header","p-0","pb-3","align-items-center"],["ngbAutofocus","",1,"modal-title","fw-bolder"],[1,"m-0","primary-clr","fw-500"],[1,"modal-body","p-0"],[1,"d-flex","mt-4","flex-wrap","gap-5"],[1,"d-flex","flex-column"],[1,"dark-gray","fw-500"],[1,"light-gray"],[1,"card-table"],[1,"table-responsive"],[1,"table"],[4,"ngIf","ngIfElse"],["elseTransfer",""],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-end"],["type","button",1,"redBtn",3,"click"],[4,"ngIf"],[1,"card-collect"],[1,"top-details"],[1,"d-flex","mt-3","flex-wrap","gap-5"],[1,"modal-footer","p-0"],[1,"btns-group"],["type","button",1,"btn","btn-cancel",3,"click"],["class","file-item d-flex justify-content-between align-items-center py-2 px-3",4,"ngIf"],[1,"file-item","d-flex","justify-content-between","align-items-center","py-2","px-3"],[1,"fw-600","green-clr"],[1,"d-flex","gap-2","align-items-center"],["height","20","src","assets/images/eye.png",1,"cursor-pointer",3,"click"],["target","_blank","download","",3,"href"],["height","20","src","assets/images/Download.png",1,"cursor-pointer"],[1,"dark-gray","fw-bolder","mb-3"],[1,"col-5"],[3,"file"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),e._uU(3,"Refund Details"),e.qZA(),e.TgZ(4,"p",3),e._uU(5),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"h6",7),e._uU(10,"Customer Name"),e.qZA(),e.TgZ(11,"p",8),e._uU(12),e.qZA()(),e.TgZ(13,"div",6)(14,"h6",7),e._uU(15,"Refund Grand Amount"),e.qZA(),e.TgZ(16,"p",8),e._uU(17),e.qZA()(),e.TgZ(18,"div",6)(19,"h6",7),e._uU(20,"Refund Type"),e.qZA(),e.TgZ(21,"p",8),e._uU(22),e.qZA()()(),e.TgZ(23,"div",9)(24,"div",10)(25,"table",11),e.YNc(26,pe,26,8,"ng-container",12),e.YNc(27,_e,25,8,"ng-template",null,13,e.W1O),e.qZA()()(),e.TgZ(29,"div",14)(30,"div",15)(31,"div",16)(32,"button",17),e.NdJ("click",function(){return n.downloadInvoice()}),e._uU(33),e.qZA()()(),e.YNc(34,ge,6,1,"ng-container",18),e.qZA(),e.TgZ(35,"div",19)(36,"div",20)(37,"h3"),e._uU(38,"Refund Details"),e.qZA()(),e.TgZ(39,"div",21)(40,"div",6)(41,"h6",7),e._uU(42,"Employee"),e.qZA(),e.TgZ(43,"p",8),e._uU(44),e.qZA()(),e.TgZ(45,"div",6)(46,"h6",7),e._uU(47,"Date"),e.qZA(),e.TgZ(48,"p",8),e._uU(49),e.ALo(50,"date"),e.qZA()(),e.TgZ(51,"div",6)(52,"h6",7),e._uU(53,"Time"),e.qZA(),e.TgZ(54,"p",8),e._uU(55),e.ALo(56,"date"),e.qZA()()()()(),e.TgZ(57,"div",22)(58,"div",23)(59,"button",24),e.NdJ("click",function(){return n._activeModal.close("Save click")}),e._uU(60,"Close"),e.qZA()()()()),2&t){const r=e.MAs(28);e.xp6(5),e.hij("Refund No: ",null==n.details||null==n.details.refund?null:n.details.refund.refundRecordid," "),e.xp6(7),e.Oqu(null==n.details||null==n.details.customer?null:n.details.customer.customerName),e.xp6(5),e.Oqu(null==n.details?null:n.details.grandAmount),e.xp6(5),e.Oqu(null==n.details||null==n.details.refund?null:n.details.refund.refundedByFlag),e.xp6(4),e.Q6J("ngIf",null==n.details||null==n.details.refund?null:n.details.refund.cheque)("ngIfElse",r),e.xp6(7),e.Oqu(7002==(null==n.data?null:n.data.orderType)?"View Receipt":"View Invoice"),e.xp6(1),e.Q6J("ngIf",null==n.details?null:n.details.signAttachment),e.xp6(10),e.Oqu(null==n.details||null==n.details.refund||null==n.details.refund.refundedBy?null:n.details.refund.refundedBy.fullName),e.xp6(5),e.Oqu(e.xi3(50,11,null==n.details||null==n.details.refund?null:n.details.refund.refundAt,"mediumDate")),e.xp6(6),e.Oqu(e.xi3(56,14,null==n.details||null==n.details.refund?null:n.details.refund.refundAt,"h:mm a"))}},dependencies:[s.O5,de.g,s.uU],styles:[".flex-basis[_ngcontent-%COMP%]{flex:0 1 25%}.file-item[_ngcontent-%COMP%]{border:1px solid #2eb93e;border-radius:5px}[_nghost-%COMP%]   .card-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 5px 10px 15px!important}"]}),a})();var S=u(72402),I=u(28424),R=u(59442);function he(a,o){1&a&&e._uU(0),2&a&&e.hij(" ","Own Branch - "+o.item.branchName," ")}function fe(a,o){1&a&&(e.ynx(0),e.YNc(1,he,1,1,"ng-template",18),e.BQk())}function be(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByOrderNo())}),e._UZ(1,"i",20),e.qZA()}}function Te(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByName())}),e._UZ(1,"i",20),e.qZA()}}function ye(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"i",21),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByDate())}),e.qZA()}}const ve=function(a,o){return{"background-color":a,color:o}};function Ce(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"tr",32),e.NdJ("click",function(r){const d=e.CHM(t).$implicit,N=e.oxw(2);return e.KtG(N.viewDetails(r,null==d?null:d.sparePartsSalesOrderOpportunityNo))}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"td")(14,"div",33),e._uU(15),e.qZA()(),e.TgZ(16,"td")(17,"a",34)(18,"button",35),e._uU(19,"View Return Approval"),e.qZA()()(),e.TgZ(20,"td")(21,"button",36),e.NdJ("click",function(){const i=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.returnAction(i))}),e._uU(22),e.qZA()()()}if(2&a){const t=o.$implicit,n=e.oxw(2);e.xp6(2),e.Oqu(null==t?null:t.sparePartsSalesOrderOpportunityNo),e.xp6(2),e.Oqu(null==t||null==t.customer?null:t.customer.customerName),e.xp6(2),e.Oqu(null==t?null:t.returnedBy.fullName),e.xp6(2),e.Oqu(e.xi3(9,10,null==t?null:t.returnAt,"mediumDate")),e.xp6(3),e.hij("",e.xi3(12,13,null==t?null:t.grandAmount,"2.3-3")," JOD"),e.xp6(3),e.Q6J("ngStyle",e.WLB(16,ve,null==t||null==t.statusObj?null:t.statusObj.lookupBGColor,null==t||null==t.statusObj?null:t.statusObj.lookupTextColor)),e.xp6(1),e.hij(" ",null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName," "),e.xp6(2),e.s9C("href",null==t?null:t.approvalAttachment,e.LSH),e.xp6(4),e.Q6J("disabled",!(null!=n.data&&n.data.canManageAndView)),e.xp6(1),e.hij(" ",null==t||null==t.actionObj[0]?null:t.actionObj[0].lookupName," ")}}function xe(a,o){1&a&&(e.TgZ(0,"div",37),e._UZ(1,"app-not-found"),e.qZA())}function Ze(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"div",16)(1,"div",22)(2,"div",23)(3,"table",24)(4,"thead")(5,"tr")(6,"th",25)(7,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByOrderNo())}),e._uU(8," Order No. "),e._UZ(9,"i",27)(10,"i",28),e.qZA()(),e.TgZ(11,"th",25)(12,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByCustomerDetails())}),e._uU(13," Customer Details "),e._UZ(14,"i",27)(15,"i",28),e.qZA()(),e.TgZ(16,"th",25)(17,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByReturn())}),e._uU(18," Return By "),e._UZ(19,"i",27)(20,"i",28),e.qZA()(),e.TgZ(21,"th",25)(22,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByReturnDate())}),e._uU(23," Return Date "),e._UZ(24,"i",27)(25,"i",28),e.qZA()(),e.TgZ(26,"th",25)(27,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByRefund())}),e._uU(28," Refund/Amount "),e._UZ(29,"i",27)(30,"i",28),e.qZA()(),e.TgZ(31,"th",25)(32,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByStatus())}),e._uU(33," Status "),e._UZ(34,"i",27)(35,"i",28),e.qZA()(),e.TgZ(36,"th",25)(37,"button",29),e._uU(38,"Approval"),e.qZA()(),e.TgZ(39,"th",25)(40,"button",29),e._uU(41," Action "),e.qZA()()()(),e.TgZ(42,"tbody"),e.YNc(43,Ce,23,19,"tr",30),e.qZA()()(),e.YNc(44,xe,2,0,"div",31),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(7),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",2==t.sort),e.xp6(1),e.ekj("active",3==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",4==t.sort),e.xp6(1),e.ekj("active",5==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",6==t.sort),e.xp6(1),e.ekj("active",7==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",8==t.sort),e.xp6(1),e.ekj("active",9==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",10==t.sort),e.xp6(1),e.ekj("active",11==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",12==t.sort),e.xp6(1),e.ekj("active",13==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(3),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(3),e.Q6J("ngForOf",t.returnOrdersList),e.xp6(1),e.Q6J("ngIf",0==(null==t.returnOrdersList?null:t.returnOrdersList.length))}}function Oe(a,o){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",38)(2,"h6",39),e._uU(3," Showing "),e.TgZ(4,"span"),e._uU(5),e.qZA(),e._uU(6," from "),e.TgZ(7,"span"),e._uU(8),e.qZA(),e._uU(9," data "),e.qZA()(),e.TgZ(10,"div",38)(11,"ngb-pagination",40),e.NdJ("pageChange",function(r){e.CHM(t);const i=e.oxw();return e.KtG(i.pageNo=r)})("pageChange",function(r){e.CHM(t);const i=e.oxw();return e.KtG(i.pageChange(r))}),e.qZA()(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(5),e.AsE("",6*t.pageNo-5," - ",6==(null==t.returnOrdersList?null:t.returnOrdersList.length)?6*t.pageNo:t.totalRecords,""),e.xp6(3),e.hij(" ",t.totalRecords," "),e.xp6(3),e.Q6J("collectionSize",t.totalRecords)("page",t.pageNo)("maxSize",3)("pageSize",6)("rotate",!0)("ellipses",!1)}}function Se(a,o){1&a&&(e.TgZ(0,"div"),e._UZ(1,"app-loading"),e.qZA())}const Ne=function(){return{containerClass:"theme-red",isAnimated:!0,showClearButton:!0}};let ke=(()=>{class a{constructor(t,n,r,i,d){this._collectService=t,this._commonService=n,this._datePipe=r,this._sharedService=i,this._modalService=d,this.returnStatus=f.Rr,this.searchOrderNo="",this.searchCustomerName="",this.returnType="",this.dateObj={fromDate:"",toDate:""},this.dateFilter=null,this.returnOrdersList=[],this.branches=[],this.users=[],this.branchId=null,this.userId=null,this.sort=1,this.pageNo=1,this.totalRecords=0}ngOnInit(){this.getSparePartsReturnOrders(),this.getUsers(),this.getRegisterDetails()}getRegisterDetails(){this._collectService.GetRegisterDetails(this._sharedService.getRegister.registerObj?.id).subscribe(t=>{this.registerDetails=t.data,this.getBranches(3003)})}getBranches(t){this.branches=this.registerDetails.registerBranches.map(r=>({...r,branchType:r?.branchTypes[0]?.branchTypeId})).filter(r=>r.branchType==t),this.isRegisterBranch=this.registerDetails.branchId,this.branchId=this.registerDetails?.collectForOwnBranch?this.branches.findIndex(i=>i.branchId==this.isRegisterBranch)>=0?this.isRegisterBranch:null:this.branches[0].branchId;let n=JSON.parse(localStorage.getItem("returnParams"));n?.branchId&&(this.branchId=n.branchId,this.searchCustomerName=n.searchCustomerName,this.searchOrderNo=n.searchOrderNo,this.userId=n.userId,n?.dateFilter&&(this.dateFilter=[new Date(n?.dateFilter[0]),new Date(n?.dateFilter[1])])),null!==this.branchId&&this.getSparePartsReturnOrders()}viewDetails(t,n){"button"!=t.target.tagName.toLowerCase()&&(localStorage.setItem("returnParams",JSON.stringify({branchId:this.branchId,searchCustomerName:this.searchCustomerName,searchOrderNo:this.searchOrderNo,userId:this.userId,dateFilter:this.dateFilter,...JSON.parse(localStorage.getItem("returnParams"))})),this._commonService.NavigateToRouteWithQueryString("/return/details",{queryParams:{id:n}}))}returnAction(t){let n=t?.actionObj[0]?.lookupName.toLowerCase();if(this.returnType=t?.returnOrderType.toLowerCase(),"view"===n&&"full refund"==this.returnType)this._modalService.open(q,{size:"xl"}).componentInstance.data={details:t};else if("sign"===n){const r=this._modalService.open(p.X,{size:"lg"});r.componentInstance.data={details:t},r.componentInstance.eventData.subscribe(i=>{i.isSuccess&&(r.dismiss(),this.getSparePartsReturnOrders())})}else if("refund"===n){const r=this._modalService.open(A,{size:"xl"});r.componentInstance.data={details:t},r.componentInstance.eventData.subscribe(i=>{i.isSuccess&&(r.dismiss(),this.getSparePartsReturnOrders())})}}getSparePartsReturnOrders(){let t=`ReturnDateFrom=${this.dateObj?.fromDate}&ReturnDateTo=${this.dateObj?.toDate}&sentTo=treasury&sort=${this.sort}&orderNo=${this.searchOrderNo}&customer=${this.searchCustomerName}&pageNo=${this.pageNo-1}&sort=${this.sort}&pageSize=6`;this.userId&&(t+=`&created=${this.userId}`),this.branchId&&(t+=`&branchId=${this.branchId}`),this._collectService.getSparePartsReturnOrders(t).subscribe(n=>{this.returnOrdersList=n?.data,this.totalRecords=n?.totalRecordCount})}handleBranchChange(t){t?.branchId&&(this.branchId=t?.branchId,this.pageNo=1,this.getSparePartsReturnOrders())}clearBranch(t){this.pageNo=1,this.branchId=t?.branchId,this.getSparePartsReturnOrders()}filterByUserId(t){this.pageNo=1,this.userId=t?.userId,this.getSparePartsReturnOrders()}clearUser(){this.pageNo=1,this.getSparePartsReturnOrders()}handleSearchByOrderNo(t){this.pageNo=1,this.searchOrderNo=t?.target.value,this.getSparePartsReturnOrders()}clearSearchByOrderNo(){this.pageNo=1,this.searchOrderNo="",this.getSparePartsReturnOrders()}handleSearchByName(t){this.pageNo=1,this.searchCustomerName=t?.target.value,this.getSparePartsReturnOrders()}clearSearchByName(){this.pageNo=1,this.searchCustomerName="",this.getSparePartsReturnOrders()}handleSearchByDate(t){t&&(this.dateObj.fromDate=this._datePipe.transform(t[0],"yyyy-MM-dd"),this.dateObj.toDate=this._datePipe.transform(t[1],"yyyy-MM-dd")),this.pageNo=1,this.getSparePartsReturnOrders()}clearSearchByDate(){this.pageNo=1,this.dateObj={fromDate:"",toDate:""},this.dateFilter=null,this.getSparePartsReturnOrders()}pageChange(t){this.pageNo=t,this.getSparePartsReturnOrders()}getUsers(){return this._collectService.getUsers(33).subscribe(n=>{n&&(this.users=n.data)})}sortByOrderNo(){this.sort=3==this.sort?1:2==this.sort?3:2,this.getSparePartsReturnOrders()}sortByCustomerDetails(){this.sort=5==this.sort?1:4==this.sort?5:4,this.getSparePartsReturnOrders()}sortByReturn(){this.sort=7==this.sort?1:6==this.sort?7:6,this.getSparePartsReturnOrders()}sortByReturnDate(){this.sort=9==this.sort?1:8==this.sort?9:8,this.getSparePartsReturnOrders()}sortByRefund(){this.sort=11==this.sort?1:10==this.sort?11:10,this.getSparePartsReturnOrders()}sortByStatus(){this.sort=13==this.sort?1:12==this.sort?13:12,this.getSparePartsReturnOrders()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(x.k),e.Y36(_.v),e.Y36(s.uU),e.Y36(l.F),e.Y36(C.FF))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-spare-parts-treasury"]],inputs:{data:"data"},decls:27,vars:16,consts:[[1,"row"],[1,"col-sm-3"],["placeholder","Search by branch","bindLabel","branchName","bindValue","branchId",3,"items","ngModel","ngModelChange","change","clear"],[4,"ngIf"],[1,"input-group","mb-3","search-box"],["type","button",1,"btn"],[1,"fa-solid","fa-search"],["type","text","placeholder","Order no...",1,"form-control",3,"ngModel","ngModelChange","input"],["class","btn","type","button","id","button-addon4",3,"click",4,"ngIf"],["type","text","placeholder","Customer name...",1,"form-control",3,"ngModel","ngModelChange","input"],["placeholder","Returned by...","bindLabel","fullName","bindValue","userId",3,"items","ngModel","ngModelChange","change","clear"],[1,"col-sm-3","position-relative"],["class","fa-solid fa-times","style","position:absolute;top:15px;right:30px;cursor:pointer",3,"click",4,"ngIf"],["type","text","placeholder","Select Date","bsDaterangepicker","","placement","right",1,"form-control",2,"height","46px",3,"ngModel","bsConfig","ngModelChange","bsValueChange"],[1,"row","mt-3"],["class","col-md-12",4,"ngIf","ngIfElse"],[1,"col-md-12"],["loading",""],["ng-label-tmp",""],["type","button","id","button-addon4",1,"btn",3,"click"],[1,"fa-solid","fa-xmark"],[1,"fa-solid","fa-times",2,"position","absolute","top","15px","right","30px","cursor","pointer",3,"click"],[1,"card-table","mt-2","register-sessions-table"],[1,"table-responsive"],[1,"table"],["scope","col"],[1,"btn",3,"disabled","click"],[1,"fa-solid","fa-arrow-up-long"],[1,"fa-solid","fa-arrow-down-long"],[1,"btn",3,"disabled"],["class","cursor-pointer",3,"click",4,"ngFor","ngForOf"],["class","not-found",4,"ngIf"],[1,"cursor-pointer",3,"click"],[1,"status-tag",3,"ngStyle"],["target","_blank",3,"href"],["type","button",1,"redBtn"],["type","button",1,"redBtn",3,"disabled","click"],[1,"not-found"],[1,"col-md-6"],[1,"showing"],[3,"collectionSize","page","maxSize","pageSize","rotate","ellipses","pageChange"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ng-select",2),e.NdJ("ngModelChange",function(i){return n.branchId=i})("change",function(i){return n.handleBranchChange(i)})("clear",function(i){return n.clearBranch(i)}),e.YNc(3,fe,2,0,"ng-container",3),e.qZA()(),e.TgZ(4,"div",1)(5,"div",4)(6,"button",5),e._UZ(7,"i",6),e.qZA(),e.TgZ(8,"input",7),e.NdJ("ngModelChange",function(i){return n.searchOrderNo=i})("input",function(i){return n.handleSearchByOrderNo(i)}),e.qZA(),e.YNc(9,be,2,0,"button",8),e.qZA()(),e.TgZ(10,"div",1)(11,"div",4)(12,"button",5),e._UZ(13,"i",6),e.qZA(),e.TgZ(14,"input",9),e.NdJ("ngModelChange",function(i){return n.searchCustomerName=i})("input",function(i){return n.handleSearchByName(i)}),e.qZA(),e.YNc(15,Te,2,0,"button",8),e.qZA()(),e.TgZ(16,"div",1)(17,"ng-select",10),e.NdJ("ngModelChange",function(i){return n.userId=i})("change",function(i){return n.filterByUserId(i)})("clear",function(){return n.clearUser()}),e.qZA()(),e.TgZ(18,"div",11),e.YNc(19,ye,1,0,"i",12),e.TgZ(20,"input",13),e.NdJ("ngModelChange",function(i){return n.dateFilter=i})("bsValueChange",function(i){return n.handleSearchByDate(i)}),e.qZA()()(),e.TgZ(21,"div",14),e.YNc(22,Ze,45,34,"div",15),e.YNc(23,Oe,12,9,"ng-container",3),e.TgZ(24,"div",16),e.YNc(25,Se,2,0,"ng-template",null,17,e.W1O),e.qZA()()),2&t){const r=e.MAs(26);e.xp6(2),e.Q6J("items",n.branches)("ngModel",n.branchId),e.xp6(1),e.Q6J("ngIf",(null==n.registerDetails?null:n.registerDetails.branchId)==n.branchId),e.xp6(5),e.Q6J("ngModel",n.searchOrderNo),e.xp6(1),e.Q6J("ngIf",n.searchOrderNo),e.xp6(5),e.Q6J("ngModel",n.searchCustomerName),e.xp6(1),e.Q6J("ngIf",n.searchCustomerName),e.xp6(2),e.Q6J("items",n.users)("ngModel",n.userId),e.xp6(2),e.Q6J("ngIf",n.dateFilter),e.xp6(1),e.Q6J("ngModel",n.dateFilter)("bsConfig",e.DdM(15,Ne)),e.xp6(2),e.Q6J("ngIf",n.returnOrdersList)("ngIfElse",r),e.xp6(1),e.Q6J("ngIf",n.totalRecords>6)}},dependencies:[s.sg,s.O5,s.PC,S.FR,S.TB,c.Fj,c.JJ,c.On,T.w9,T.mR,C.N9,I.N,R.w,s.JJ,s.uU],styles:[".redBtn[_ngcontent-%COMP%]{min-width:100px}"]}),a})();function Ae(a,o){1&a&&e._uU(0),2&a&&e.hij(" ","Own Branch - "+o.item.branchName," ")}function qe(a,o){1&a&&(e.ynx(0),e.YNc(1,Ae,1,1,"ng-template",18),e.BQk())}function Ie(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByOrderNo())}),e._UZ(1,"i",20),e.qZA()}}function Re(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByName())}),e._UZ(1,"i",20),e.qZA()}}function Fe(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"i",21),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByDate())}),e.qZA()}}const we=function(a,o){return{"background-color":a,color:o}};function Pe(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"tr",32),e.NdJ("click",function(r){const d=e.CHM(t).$implicit,N=e.oxw(2);return e.KtG(N.viewDetails(r,null==d?null:d.servicesSalesOrderNo))}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"td")(14,"div",33),e._uU(15),e.qZA()(),e.TgZ(16,"td")(17,"button",34),e.NdJ("click",function(){const i=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.returnAction(i))}),e._uU(18),e.qZA()()()}if(2&a){const t=o.$implicit,n=e.oxw(2);e.xp6(2),e.Oqu(null==t?null:t.servicesSalesOrderNo),e.xp6(2),e.Oqu(null==t||null==t.customer?null:t.customer.customerName),e.xp6(2),e.Oqu(null==t?null:t.returnedBy.fullName),e.xp6(2),e.Oqu(e.xi3(9,9,null==t?null:t.returnAt,"mediumDate")),e.xp6(3),e.hij("",e.xi3(12,12,null==t?null:t.grandAmount,"2.3-3")," JOD"),e.xp6(3),e.Q6J("ngStyle",e.WLB(15,we,null==t||null==t.statusObj?null:t.statusObj.lookupBGColor,null==t||null==t.statusObj?null:t.statusObj.lookupTextColor)),e.xp6(1),e.hij(" ",null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName," "),e.xp6(2),e.Q6J("disabled",!(null!=n.data&&n.data.canManageAndView)),e.xp6(1),e.hij(" ",null==t||null==t.actionObj[0]?null:t.actionObj[0].lookupName," ")}}function Ue(a,o){1&a&&(e.TgZ(0,"div",35),e._UZ(1,"app-not-found"),e.qZA())}function De(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"div",16)(1,"div",22)(2,"div",23)(3,"table",24)(4,"thead")(5,"tr")(6,"th",25)(7,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByOrderNo())}),e._uU(8," Order No. "),e._UZ(9,"i",27)(10,"i",28),e.qZA()(),e.TgZ(11,"th",25)(12,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByCustomerDetails())}),e._uU(13," Customer Details "),e._UZ(14,"i",27)(15,"i",28),e.qZA()(),e.TgZ(16,"th",25)(17,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByReturn())}),e._uU(18," Return By "),e._UZ(19,"i",27)(20,"i",28),e.qZA()(),e.TgZ(21,"th",25)(22,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByReturnDate())}),e._uU(23," Return Date "),e._UZ(24,"i",27)(25,"i",28),e.qZA()(),e.TgZ(26,"th",25)(27,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByRefund())}),e._uU(28," Refund/Amount "),e._UZ(29,"i",27)(30,"i",28),e.qZA()(),e.TgZ(31,"th",25)(32,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByStatus())}),e._uU(33," Status "),e._UZ(34,"i",27)(35,"i",28),e.qZA()(),e.TgZ(36,"th",25)(37,"button",29),e._uU(38," Action "),e.qZA()()()(),e.TgZ(39,"tbody"),e.YNc(40,Pe,19,18,"tr",30),e.qZA()()(),e.YNc(41,Ue,2,0,"div",31),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(7),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",2==t.sort),e.xp6(1),e.ekj("active",3==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",4==t.sort),e.xp6(1),e.ekj("active",5==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",6==t.sort),e.xp6(1),e.ekj("active",7==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",8==t.sort),e.xp6(1),e.ekj("active",9==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",10==t.sort),e.xp6(1),e.ekj("active",11==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",12==t.sort),e.xp6(1),e.ekj("active",13==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(3),e.Q6J("ngForOf",t.returnOrdersList),e.xp6(1),e.Q6J("ngIf",0==(null==t.returnOrdersList?null:t.returnOrdersList.length))}}function Me(a,o){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",36)(2,"h6",37),e._uU(3," Showing "),e.TgZ(4,"span"),e._uU(5),e.qZA(),e._uU(6," from "),e.TgZ(7,"span"),e._uU(8),e.qZA(),e._uU(9," data "),e.qZA()(),e.TgZ(10,"div",36)(11,"ngb-pagination",38),e.NdJ("pageChange",function(r){e.CHM(t);const i=e.oxw();return e.KtG(i.pageNo=r)})("pageChange",function(r){e.CHM(t);const i=e.oxw();return e.KtG(i.pageChange(r))}),e.qZA()(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(5),e.AsE("",6*t.pageNo-5," - ",6==(null==t.returnOrdersList?null:t.returnOrdersList.length)?6*t.pageNo:t.totalRecords,""),e.xp6(3),e.hij(" ",t.totalRecords," "),e.xp6(3),e.Q6J("collectionSize",t.totalRecords)("page",t.pageNo)("maxSize",3)("pageSize",6)("rotate",!0)("ellipses",!1)}}function Je(a,o){1&a&&(e.TgZ(0,"div"),e._UZ(1,"app-loading"),e.qZA())}const Be=function(){return{containerClass:"theme-red",isAnimated:!0,showClearButton:!0}};let Qe=(()=>{class a{constructor(t,n,r,i,d){this._collectService=t,this._commonService=n,this._sharedService=r,this._datePipe=i,this._modalService=d,this.returnStatus=f.Rr,this.searchOrderNo="",this.searchCustomerName="",this.returnType="",this.dateObj={fromDate:"",toDate:""},this.dateFilter=null,this.returnOrdersList=[],this.branches=[],this.users=[],this.branchId=null,this.userId=null,this.sort=1,this.pageNo=1,this.totalRecords=0}ngOnInit(){this.getServicessReturnOrders(),this.getUsers(),this.getRegisterDetails()}getRegisterDetails(){this._collectService.GetRegisterDetails(this._sharedService.getRegister.registerObj?.id).subscribe(t=>{this.registerDetails=t.data,this.getBranches(3002)})}getBranches(t){this.branches=this.registerDetails.registerBranches.map(r=>({...r,branchType:r?.branchTypes[0]?.branchTypeId})).filter(r=>r?.branchType==t),this.isRegisterBranch=this.registerDetails.branchId,this.branchId=this.registerDetails?.collectForOwnBranch?this.branches.findIndex(i=>i.branchId==this.isRegisterBranch)>=0?this.isRegisterBranch:null:this.branches[0].branchId;let n=JSON.parse(localStorage.getItem("returnParams"));n?.branchId&&(this.branchId=n.branchId,this.searchCustomerName=n.searchCustomerName,this.searchOrderNo=n.searchOrderNo,this.userId=n.userId,this.serachCashCard=n.serachCashCard,localStorage.removeItem("returnParams")),null!==this.branchId&&this.getServicessReturnOrders()}viewDetails(t,n){if("button"!=t.target.tagName.toLowerCase()){let i={branchId:this.branchId,searchCustomerName:this.searchCustomerName,searchOrderNo:this.searchOrderNo,serachCashCard:this.serachCashCard,userId:this.userId,dateFilter:this.dateFilter};localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),...i})),this._commonService.NavigateToRoute(`/return/services-details/${n}`)}}returnAction(t){let n=t?.actionObj[0]?.lookupName.toLowerCase();if(this.returnType=t?.returnOrderType.toLowerCase(),"view"===n&&"full refund"==this.returnType)this._modalService.open(q,{size:"xl"}).componentInstance.data={details:t,orderType:7001};else if("sign"===n){const r=this._modalService.open(p.X,{size:"lg"});r.componentInstance.data={details:t,orderType:7001},r.componentInstance.eventData.subscribe(i=>{i.isSuccess&&(r.dismiss(),this.getServicessReturnOrders())})}else if("refund"===n){const r=this._modalService.open(A,{size:"xl"});r.componentInstance.data={details:t,orderType:7001},r.componentInstance.eventData.subscribe(i=>{i.isSuccess&&(r.dismiss(),this.getServicessReturnOrders())})}}getServicessReturnOrders(){let t=JSON.parse(localStorage.getItem("returnParams"));t?.branchId&&(this.branchId=t.branchId,this.searchCustomerName=t.searchCustomerName,this.searchOrderNo=t.searchOrderNo,this.userId=t.userId,t?.dateFilter&&(this.dateFilter=[new Date(t?.dateFilter[0]),new Date(t?.dateFilter[1])]),localStorage.removeItem("returnParams"));let n=`ReturnDateFrom=${this.dateObj?.fromDate}&ReturnDateTo=${this.dateObj?.toDate}&sentTo=treasury&orderNo=${this.searchOrderNo}\n    &customer=${this.searchCustomerName}&pageNo=${this.pageNo-1}&sort=${this.sort}&pageSize=6`;this.userId&&(n+=`&created=${this.userId}`),this.branchId&&(n+=`&branchId=${this.branchId}`),this._collectService.getServicesReturnOrders(n).subscribe(r=>{this.returnOrdersList=r?.data,this.totalRecords=r?.totalRecordCount})}handleBranchChange(t){t?.branchId&&(this.branchId=t?.branchId,this.pageNo=1,this.getServicessReturnOrders())}clearBranch(t){this.pageNo=1,this.branchId=t?.branchId,this.getServicessReturnOrders()}filterByUserId(t){this.pageNo=1,this.userId=t?.userId,this.getServicessReturnOrders()}clearUser(){this.pageNo=1,this.getServicessReturnOrders()}handleSearchByOrderNo(t){this.pageNo=1,this.searchOrderNo=t?.target.value,this.getServicessReturnOrders()}clearSearchByOrderNo(){this.pageNo=1,this.searchOrderNo="",this.getServicessReturnOrders()}handleSearchByName(t){this.pageNo=1,this.searchCustomerName=t?.target.value,this.getServicessReturnOrders()}clearSearchByName(){this.pageNo=1,this.searchCustomerName="",this.getServicessReturnOrders()}handleSearchByDate(t){t&&(this.dateObj.fromDate=this._datePipe.transform(t[0],"yyyy-MM-dd"),this.dateObj.toDate=this._datePipe.transform(t[1],"yyyy-MM-dd")),this.pageNo=1,this.getServicessReturnOrders()}clearSearchByDate(){this.pageNo=1,this.dateObj={fromDate:"",toDate:""},this.dateFilter=null,this.getServicessReturnOrders()}pageChange(t){this.pageNo=t,this.getServicessReturnOrders()}getUsers(){return this._collectService.getUsers(33).subscribe(n=>{n&&(this.users=n.data)})}sortByOrderNo(){this.sort=3==this.sort?1:2==this.sort?3:2,this.getServicessReturnOrders()}sortByCustomerDetails(){this.sort=5==this.sort?1:4==this.sort?5:4,this.getServicessReturnOrders()}sortByReturn(){this.sort=7==this.sort?1:6==this.sort?7:6,this.getServicessReturnOrders()}sortByReturnDate(){this.sort=9==this.sort?1:8==this.sort?9:8,this.getServicessReturnOrders()}sortByRefund(){this.sort=11==this.sort?1:10==this.sort?11:10,this.getServicessReturnOrders()}sortByStatus(){this.sort=13==this.sort?1:12==this.sort?13:12,this.getServicessReturnOrders()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(x.k),e.Y36(_.v),e.Y36(l.F),e.Y36(s.uU),e.Y36(C.FF))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-services-treasury"]],inputs:{data:"data"},decls:27,vars:16,consts:[[1,"row"],[1,"col-sm-3"],["placeholder","Search by branch","bindLabel","branchName","bindValue","branchId",3,"items","ngModel","ngModelChange","change","clear"],[4,"ngIf"],[1,"input-group","mb-3","search-box"],["type","button",1,"btn"],[1,"fa-solid","fa-search"],["type","text","placeholder","Order no...",1,"form-control",3,"ngModel","ngModelChange","input"],["class","btn","type","button","id","button-addon4",3,"click",4,"ngIf"],["type","text","placeholder","Customer name...",1,"form-control",3,"ngModel","ngModelChange","input"],["placeholder","Returned by...","bindLabel","fullName","bindValue","userId",3,"items","ngModel","ngModelChange","change","clear"],[1,"col-sm-3","position-relative"],["class","fa-solid fa-times","style","position:absolute;top:15px;right:30px;cursor:pointer",3,"click",4,"ngIf"],["type","text","placeholder","Select Date","bsDaterangepicker","","placement","right",1,"form-control",2,"height","46px",3,"ngModel","bsConfig","ngModelChange","bsValueChange"],[1,"row","mt-3"],["class","col-md-12",4,"ngIf","ngIfElse"],[1,"col-md-12"],["loading",""],["ng-label-tmp",""],["type","button","id","button-addon4",1,"btn",3,"click"],[1,"fa-solid","fa-xmark"],[1,"fa-solid","fa-times",2,"position","absolute","top","15px","right","30px","cursor","pointer",3,"click"],[1,"card-table","mt-2","register-sessions-table"],[1,"table-responsive"],[1,"table"],["scope","col"],[1,"btn",3,"disabled","click"],[1,"fa-solid","fa-arrow-up-long"],[1,"fa-solid","fa-arrow-down-long"],[1,"btn",3,"disabled"],["class","cursor-pointer",3,"click",4,"ngFor","ngForOf"],["class","not-found",4,"ngIf"],[1,"cursor-pointer",3,"click"],[1,"status-tag",3,"ngStyle"],["type","button",1,"redBtn",3,"disabled","click"],[1,"not-found"],[1,"col-md-6"],[1,"showing"],[3,"collectionSize","page","maxSize","pageSize","rotate","ellipses","pageChange"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ng-select",2),e.NdJ("ngModelChange",function(i){return n.branchId=i})("change",function(i){return n.handleBranchChange(i)})("clear",function(i){return n.clearBranch(i)}),e.YNc(3,qe,2,0,"ng-container",3),e.qZA()(),e.TgZ(4,"div",1)(5,"div",4)(6,"button",5),e._UZ(7,"i",6),e.qZA(),e.TgZ(8,"input",7),e.NdJ("ngModelChange",function(i){return n.searchOrderNo=i})("input",function(i){return n.handleSearchByOrderNo(i)}),e.qZA(),e.YNc(9,Ie,2,0,"button",8),e.qZA()(),e.TgZ(10,"div",1)(11,"div",4)(12,"button",5),e._UZ(13,"i",6),e.qZA(),e.TgZ(14,"input",9),e.NdJ("ngModelChange",function(i){return n.searchCustomerName=i})("input",function(i){return n.handleSearchByName(i)}),e.qZA(),e.YNc(15,Re,2,0,"button",8),e.qZA()(),e.TgZ(16,"div",1)(17,"ng-select",10),e.NdJ("ngModelChange",function(i){return n.userId=i})("change",function(i){return n.filterByUserId(i)})("clear",function(){return n.clearUser()}),e.qZA()(),e.TgZ(18,"div",11),e.YNc(19,Fe,1,0,"i",12),e.TgZ(20,"input",13),e.NdJ("ngModelChange",function(i){return n.dateFilter=i})("bsValueChange",function(i){return n.handleSearchByDate(i)}),e.qZA()()(),e.TgZ(21,"div",14),e.YNc(22,De,42,33,"div",15),e.YNc(23,Me,12,9,"ng-container",3),e.TgZ(24,"div",16),e.YNc(25,Je,2,0,"ng-template",null,17,e.W1O),e.qZA()()),2&t){const r=e.MAs(26);e.xp6(2),e.Q6J("items",n.branches)("ngModel",n.branchId),e.xp6(1),e.Q6J("ngIf",(null==n.registerDetails?null:n.registerDetails.branchId)==n.branchId),e.xp6(5),e.Q6J("ngModel",n.searchOrderNo),e.xp6(1),e.Q6J("ngIf",n.searchOrderNo),e.xp6(5),e.Q6J("ngModel",n.searchCustomerName),e.xp6(1),e.Q6J("ngIf",n.searchCustomerName),e.xp6(2),e.Q6J("items",n.users)("ngModel",n.userId),e.xp6(2),e.Q6J("ngIf",n.dateFilter),e.xp6(1),e.Q6J("ngModel",n.dateFilter)("bsConfig",e.DdM(15,Be)),e.xp6(2),e.Q6J("ngIf",n.returnOrdersList)("ngIfElse",r),e.xp6(1),e.Q6J("ngIf",n.totalRecords>6)}},dependencies:[s.sg,s.O5,s.PC,S.FR,S.TB,c.Fj,c.JJ,c.On,T.w9,T.mR,C.N9,I.N,R.w,s.JJ,s.uU],styles:[".redBtn[_ngcontent-%COMP%]{min-width:100px}"]}),a})();var Le=u(78372),je=u(71884),Ye=u(49973),Ee=u(85746);function Ve(a,o){1&a&&e._uU(0),2&a&&e.hij(" ","Own Branch - "+o.item.branchName," ")}function ze(a,o){1&a&&(e.ynx(0),e.YNc(1,Ve,1,1,"ng-template",20),e.BQk())}function Ke(a,o){1&a&&(e.TgZ(0,"span",21),e._uU(1,"Branch is required"),e.qZA())}function He(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.f.get("orderNo").setValue(""))}),e._UZ(1,"i",23),e.qZA()}}function Ge(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.f.get("customer").setValue(""))}),e._UZ(1,"i",23),e.qZA()}}function $e(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"i",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.f.get("date").setValue(""))}),e.qZA()}}function We(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){const i=e.CHM(t).row,d=e.oxw();return e.KtG(d.returnAction(i))}),e._uU(1),e.qZA()}if(2&a){const t=o.row;e.xp6(1),e.hij(" ",null==t||null==t.actionObj[0]?null:t.actionObj[0].lookupName," ")}}const Xe=function(){return{containerClass:"theme-red",isAnimated:!0,showClearButton:!0}};let et=(()=>{class a{constructor(t,n,r,i,d,N){this._collectService=t,this._commonService=n,this._sharedService=r,this.fb=i,this._datePipe=d,this._modalService=N,this.pageNo=1,this.total=0,this.limit=6,this.loading=!1,this.tableConfig={paging:!0,filter:{Sort:1,PageSize:this.limit}},this.tableColumns=[],this.returnStatus=f.Rr,this.returnType="",this.dateFilter=null,this.returnOrdersList=[],this.branches=[],this.users=[],this.orderStatus=null,this.statusList=[]}ngOnInit(){this.getRegisterDetails(),this.getUsers(),this.getStausList(),this.initFilterParams(),this.initTableColumns()}initFilterParams(){this.filterForm=this.fb.group({branchId:[null],customer:[""],created:[null],orderNo:[""],sentTo:["treasury"],date:[""],status:[null]});let t=JSON.parse(localStorage.getItem("returnParams"));if(t?.branchId){if(t?.date){let n=[new Date(t?.date[0]),new Date(t?.date[1])];t={...t,date:n}}this.filterForm.patchValue(t)}this.filterForm.valueChanges.pipe((0,Le.b)(500),(0,je.x)()).subscribe(n=>{this.pageNo=1;let i,r={returnDateFrom:"",returnDateTo:""};n.date&&(r.returnDateFrom=this._datePipe.transform(n.date[0],"yyyy-MM-dd"),r.returnDateTo=this._datePipe.transform(n.date[1],"yyyy-MM-dd")),i={...n,...r},delete i.date,null==i.branchId&&(i={...i,branchId:""}),null==i.status&&(i={...i,status:""}),null==i.created&&(i={...i,created:""}),this.filterParams="?"+new URLSearchParams(i).toString(),this.getDpReturnOrders()})}getRegisterDetails(){this._collectService.GetRegisterDetails(this._sharedService.getRegister.registerObj?.id).subscribe(t=>{this.registerDetails=t.data,this.registerDetails?.collectForOwnBranch&&this.f.get("branchId").disable(),this.getBranches(3001)})}get f(){return this.filterForm}getBranches(t){this.branches=this.registerDetails.registerBranches.map(r=>({...r,branchType:r?.branchTypes[0]?.branchTypeId})).filter(r=>r.branchType==t),this.isRegisterBranch=this.registerDetails.branchId,this.registerDetails?.collectForOwnBranch?this.branches.findIndex(i=>i.branchId==this.isRegisterBranch)>=0?this.filterForm.get("branchId").setValue(this.isRegisterBranch):this.filterForm.get("branchId").setValue(null):this.filterForm.get("branchId").setValue(this.branches[0].branchId);let n=JSON.parse(localStorage.getItem("returnParams"));n?.branchId&&(this.filterForm.patchValue({branchId:n.branchId,customer:n.customer,created:n.created}),localStorage.removeItem("returnParams"))}getDpReturnOrders(){let n,t=`pageSize=${this.tableConfig.filter.PageSize}&pageNo=${this.pageNo-1}&sort=${this.tableConfig.filter.Sort}`;n=this.filterParams?`${this.filterParams}&${t}`:`?${t}`,this._collectService.getDpReturnOrders(n).subscribe(r=>{this.returnOrdersList=r?.data,this.total=r?.totalRecordCount})}getStausList(){this._collectService.getLookupsById(10).subscribe(t=>{this.statusList=t.data.map(n=>({text:n?.name[0]?.lookupName,value:n?.id}))})}eventData(t){if(t.isTableRowClicked){if("orderAction"===t.eventData.target.id)return;{let r={...this.filterForm.value};localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),...r})),this._commonService.NavigateToRoute(`/return/dpayment-details/${t?.item?.directPaymentSalesOrderOpportunityNo}`)}}}downloadInvoices(t){this._commonService.downloadInvoices({invoices:t})}getUsers(){return this._collectService.getUsers(3).subscribe(n=>{n&&(this.users=n.data)})}returnAction(t){let n=t?.actionObj[0]?.lookupName.toLowerCase();if("view"===n)this._modalService.open(q,{size:"xl"}).componentInstance.data={details:t,orderType:7002};else if("sign"===n){const r=this._modalService.open(p.X,{size:"lg"});r.componentInstance.data={details:t,orderType:7002},r.componentInstance.eventData.subscribe(i=>{i.isSuccess&&(r.dismiss(),this.getDpReturnOrders())})}else if("refund"===n){const r=this._modalService.open(A,{size:"xl"});r.componentInstance.data={details:t,orderType:7002},r.componentInstance.eventData.subscribe(i=>{i.isSuccess&&(r.dismiss(),this.getDpReturnOrders())})}}onSortChange(t){if(t?.direction&&t?.column)switch(t.column){case"directPaymentSalesOrderOpportunityNo":this.tableConfig.filter.Sort="desc"===t.direction?3:2;break;case"customer.customerName":this.tableConfig.filter.Sort="desc"===t.direction?5:4;break;case"returnedBy.fullName":this.tableConfig.filter.Sort="desc"===t.direction?7:6;break;case"returnAt":this.tableConfig.filter.Sort="desc"===t.direction?9:8;break;case"grandAmount":this.tableConfig.filter.Sort="desc"===t.direction?11:10;break;case"statusObj[0].lookupName":this.tableConfig.filter.Sort="desc"===t.direction?13:12}else this.tableConfig.filter.Sort=1;this.getDpReturnOrders()}onPageChange(t){this.pageNo=t,this.getDpReturnOrders()}initTableColumns(){this.tableColumns=[{key:"directPaymentSalesOrderOpportunityNo",label:"Order No",canSort:!0},{key:"customer.customerName",label:"Customer Details",canSort:!0},{key:"returnedBy.fullName",label:"Return By",canSort:!0},{key:"returnAt",label:"Return Date",canSort:!0,dateFormat:"mediumDate"},{key:"grandAmount",label:"Refund/Collect Amount",canSort:!0,currency:{decimalFormat:"2.3-3",appendText:" JOD"}},{key:"statusObj[0].lookupName",label:"Status",canSort:!0},{key:"action",label:"Action"}]}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(x.k),e.Y36(_.v),e.Y36(l.F),e.Y36(c.qu),e.Y36(s.uU),e.Y36(C.FF))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-direct-payment-treasury"]],inputs:{data:"data"},decls:27,vars:18,consts:[[3,"formGroup"],[1,"row"],[1,"col-sm-3"],["placeholder","Search by branch","bindLabel","branchName","bindValue","branchId","formControlName","branchId",3,"items"],[4,"ngIf"],["class","font-14 primary-clr mb-2 d-inline-block",4,"ngIf"],[1,"input-group","mb-3","search-box"],["type","button",1,"btn"],[1,"fa-solid","fa-search"],["type","text","placeholder","Order no...","formControlName","orderNo",1,"form-control"],["class","btn","type","button",3,"click",4,"ngIf"],["type","text","placeholder","Customer name...","formControlName","customer",1,"form-control"],["placeholder","Return by...","bindLabel","fullName","bindValue","userId","formControlName","created",3,"items"],[1,"col-sm-3","position-relative"],["class","fa-solid fa-times","style","position:absolute;top:15px;right:30px;cursor:pointer",3,"click",4,"ngIf"],["type","text","formControlName","date","placeholder","Select Date","bsDaterangepicker","","placement","right",1,"form-control",2,"height","46px",3,"bsConfig"],[1,"col-3","mb-3"],["placeholder","Status","bindLabel","text","bindValue","value","formControlName","status",3,"items"],[3,"config","columns","data","loading","page","total","limit","eventData","sortUpdated","pageUpdated"],["libTableAdvancedColumn","action"],["ng-label-tmp",""],[1,"font-14","primary-clr","mb-2","d-inline-block"],["type","button",1,"btn",3,"click"],[1,"fa-solid","fa-xmark"],[1,"fa-solid","fa-times",2,"position","absolute","top","15px","right","30px","cursor","pointer",3,"click"],["type","button","id","orderAction",1,"redBtn",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"ng-select",3),e.YNc(4,ze,2,0,"ng-container",4),e.qZA(),e.YNc(5,Ke,2,0,"span",5),e.qZA(),e.TgZ(6,"div",2)(7,"div",6)(8,"button",7),e._UZ(9,"i",8),e.qZA(),e._UZ(10,"input",9),e.YNc(11,He,2,0,"button",10),e.qZA()(),e.TgZ(12,"div",2)(13,"div",6)(14,"button",7),e._UZ(15,"i",8),e.qZA(),e._UZ(16,"input",11),e.YNc(17,Ge,2,0,"button",10),e.qZA()(),e.TgZ(18,"div",2),e._UZ(19,"ng-select",12),e.qZA(),e.TgZ(20,"div",13),e.YNc(21,$e,1,0,"i",14),e._UZ(22,"input",15),e.qZA(),e.TgZ(23,"div",16),e._UZ(24,"ng-select",17),e.qZA()()(),e.TgZ(25,"table-advanced",18),e.NdJ("eventData",function(i){return n.eventData(i)})("sortUpdated",function(i){return n.onSortChange(i)})("pageUpdated",function(i){return n.onPageChange(i)}),e.YNc(26,We,2,1,"ng-template",19),e.qZA()),2&t&&(e.Q6J("formGroup",n.filterForm),e.xp6(3),e.Q6J("items",n.branches),e.xp6(1),e.Q6J("ngIf",(null==n.registerDetails?null:n.registerDetails.branchId)==+n.f.get("branchId").value),e.xp6(1),e.Q6J("ngIf",+n.f.get("branchId").value<0),e.xp6(6),e.Q6J("ngIf",n.f.get("orderNo").value),e.xp6(6),e.Q6J("ngIf",n.f.get("customer").value),e.xp6(2),e.Q6J("items",n.users),e.xp6(2),e.Q6J("ngIf",n.f.get("date").value),e.xp6(1),e.Q6J("bsConfig",e.DdM(17,Xe)),e.xp6(2),e.Q6J("items",n.statusList),e.xp6(1),e.Q6J("config",n.tableConfig)("columns",n.tableColumns)("data",n.returnOrdersList)("loading",n.loading)("page",n.pageNo)("total",n.total)("limit",n.limit))},dependencies:[s.O5,S.FR,S.TB,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,T.w9,T.mR,Ye.V,Ee.y]}),a})();function tt(a,o){if(1&a&&e._UZ(0,"app-services-treasury",8),2&a){const t=e.oxw();e.Q6J("data",t.data)}}function nt(a,o){if(1&a&&e._UZ(0,"app-direct-payment-treasury",8),2&a){const t=e.oxw();e.Q6J("data",t.data)}}function rt(a,o){if(1&a&&e._UZ(0,"app-spare-parts-treasury",8),2&a){const t=e.oxw();e.Q6J("data",t.data)}}const at=[{path:"",component:(()=>{class a{constructor(t,n){this._sharedService=t,this.router=n}ngOnInit(){let t=JSON.parse(localStorage.getItem("returnParams"))?.tab;t>=0&&(this.tabSet.tabs[t].active=!0,localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),tab:t}))),this.getPermissions()}getPermissions(){this.canManageAndView=this._sharedService.getPermissions.find(t=>29==t.permissionCatId).permissionSubCategories.find(t=>74==t.permissionSubCatId).permissionItems.find(t=>169==t.permissionItemId).selected,this.data={branchTypeId:3002,canManageAndView:this.canManageAndView}}handleTabSelection(t,n,r){localStorage.removeItem("returnParams"),this.data={branchTypeId:n,canManageAndView:this.canManageAndView},localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),tab:r}))}ngOnDestroy(){let t=this.router.url;!t.includes("/return/details")&&!t.includes("/return/services-details")&&!t.includes("/return/dpayment-details")&&localStorage.removeItem("returnParams")}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(l.F),e.Y36(g.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-return-treasury-fund"]],viewQuery:function(t,n){if(1&t&&e.Gf(h.AH,7),2&t){let r;e.iGM(r=e.CRH())&&(n.tabSet=r.first)}},decls:10,vars:3,consts:[["type","pills"],["heading","Treasury Services Return Orders",3,"selectTab"],["tabA","tab"],[3,"data",4,"ngIf"],["heading","Treasury Direct Payment Return Orders",3,"selectTab"],["tabC","tab"],["heading","Treasury Spare Parts Return Orders",3,"selectTab"],["tabB","tab"],[3,"data"]],template:function(t,n){if(1&t&&(e.TgZ(0,"tabset",0)(1,"tab",1,2),e.NdJ("selectTab",function(i){return n.handleTabSelection(i,3001,0)}),e.YNc(3,tt,1,1,"app-services-treasury",3),e.qZA(),e.TgZ(4,"tab",4,5),e.NdJ("selectTab",function(i){return n.handleTabSelection(i,3002,1)}),e.YNc(6,nt,1,1,"app-direct-payment-treasury",3),e.qZA(),e.TgZ(7,"tab",6,7),e.NdJ("selectTab",function(i){return n.handleTabSelection(i,3003,2)}),e.YNc(9,rt,1,1,"app-spare-parts-treasury",3),e.qZA()()),2&t){const r=e.MAs(2),i=e.MAs(5),d=e.MAs(8);e.xp6(3),e.Q6J("ngIf",r.active),e.xp6(3),e.Q6J("ngIf",i.active),e.xp6(3),e.Q6J("ngIf",d.active)}},dependencies:[s.O5,h.wW,h.AH,ke,Qe,et],styles:["[_nghost-%COMP%]     .nav-pills{margin-bottom:30px}[_nghost-%COMP%]     .nav-pills .nav-link{font-size:16px;font-weight:700;color:#1b212d;border-radius:0}[_nghost-%COMP%]     .nav-pills .nav-link.active{background:none;color:#1b212d;border-bottom:2px solid var(--primary)}"]}),a})()}];let it=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.Bz.forChild(at),g.Bz]}),a})();var st=u(21515);let ot=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[s.ez,it,st.m]}),a})()},28424:(O,y,u)=>{u.d(y,{N:()=>g});var s=u(94650);let g=(()=>{class h{}return h.\u0275fac=function(l){return new(l||h)},h.\u0275cmp=s.Xpm({type:h,selectors:[["app-loading"]],decls:2,vars:0,consts:[[1,"loading"],[1,"fa-solid","fa-circle-notch","fa-spin"]],template:function(l,f){1&l&&(s.TgZ(0,"div",0),s._UZ(1,"i",1),s.qZA())},styles:[".loading[_ngcontent-%COMP%]{text-align:center;padding:30px}.loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:46px;color:#dc3545}.loading[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:250px}"]}),h})()},59442:(O,y,u)=>{u.d(y,{w:()=>g});var s=u(94650);let g=(()=>{class h{}return h.\u0275fac=function(l){return new(l||h)},h.\u0275cmp=s.Xpm({type:h,selectors:[["app-not-found"]],decls:3,vars:0,consts:[[1,"not-found"]],template:function(l,f){1&l&&(s.TgZ(0,"div",0)(1,"p"),s._uU(2," No data to display "),s.qZA()())},styles:[".not-found[_ngcontent-%COMP%]{text-align:center;padding:10%}.not-found[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#c9c9d1;font-size:16px;font-weight:600}"]}),h})()},67761:(O,y,u)=>{u.d(y,{g:()=>e});var s=u(71891),g=u(94650),h=u(42953);let e=(()=>{class l{constructor(p){this._modalService=p}ngOnInit(){}fileAction(p){"view"==p&&this.openFileModal()}openFileModal(){this._modalService.open(s.W).componentInstance.file=this.file}getFileType(p){return p?.split("/").pop()}}return l.\u0275fac=function(p){return new(p||l)(g.Y36(h.FF))},l.\u0275cmp=g.Xpm({type:l,selectors:[["view-file"]],inputs:{file:"file",data:"data"},decls:8,vars:1,consts:[[1,"file-item"],[1,"d-flex","gap-3","align-items-center","justify-content-between"],[1,"m-0","green-clr"],[1,"d-flex","gap-2","align-items-center"],[1,"fas","fa-eye","cursor-pointer","gray-500",3,"click"],["target","_blank",3,"href"],[1,"fas","fa-download","green-clr"]],template:function(p,c){1&p&&(g.TgZ(0,"div",0)(1,"div",1)(2,"label",2),g._uU(3,"Attachment"),g.qZA(),g.TgZ(4,"div",3)(5,"i",4),g.NdJ("click",function(){return c.fileAction("view")}),g.qZA(),g.TgZ(6,"a",5),g._UZ(7,"i",6),g.qZA()()()()),2&p&&(g.xp6(6),g.s9C("href",c.file,g.LSH))},styles:[".file-item[_ngcontent-%COMP%]{padding:10px;border-radius:5px;border:1px solid var(--green);background:white;max-width:100%}.file-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:1;color:green;font-weight:600}"]}),l})()},80145:(O,y,u)=>{u.d(y,{O:()=>h,Q:()=>g});var s=u(94650);let g=(()=>{class e{constructor(f){this.el=f}onKeyDown(f){[8,9,13,27,46].indexOf(f.keyCode)}onKeyup(f){this.validateFields(f)}blockPaste(f){this.validateFields(f)}validateFields(f){this.el.nativeElement.value=this.el.nativeElement.value.replace(/[^A-Za-z\u0621-\u064a ]/g,""),f.preventDefault()}}return e.\u0275fac=function(f){return new(f||e)(s.Y36(s.SBq))},e.\u0275dir=s.lG2({type:e,selectors:[["","OnlyCharacter",""]],hostBindings:function(f,p){1&f&&s.NdJ("keydown",function(v){return p.onKeyDown(v)})("keyup",function(v){return p.onKeyup(v)})("paste",function(v){return p.blockPaste(v)})},inputs:{validationFieldsType:"validationFieldsType"}}),e})();function h(e){return e.replace(/[^A-Za-z\u0621-\u064a ]/g,"")}},75706:(O,y,u)=>{u.d(y,{Rr:()=>h,XQ:()=>g,qb:()=>s});var s=(()=>{return(l=s||(s={}))[l.Opened=16001]="Opened",l[l.Unclosed=16002]="Unclosed",l[l.Waiting=16003]="Waiting",l[l.Closed=16004]="Closed",l[l.Partial=16005]="Partial",l[l.Settled=16006]="Settled",l[l.OnHold=16007]="OnHold",l[l.RegisterFullDeposit=16008]="RegisterFullDeposit",l[l.PartiallySettled=16009]="PartiallySettled",l[l.Active=2001]="Active",s;var l})(),g=(()=>{return(l=g||(g={}))[l.ServicesSalesOrders=7001]="ServicesSalesOrders",l[l.DirectPaymentSalesOrders=7002]="DirectPaymentSalesOrders",l[l.SparePartsSalesOrders=7003]="SparePartsSalesOrders",l[l.OtherRevenues=7004]="OtherRevenues",l[l.CustomerPayments=7005]="CustomerPayments",l[l.BankUndertakingSalesOrders=7006]="BankUndertakingSalesOrders",l[l.InHouseFinancingSalesOrders=7007]="InHouseFinancingSalesOrders",l[l.PromissoryNotes=7008]="PromissoryNotes",g;var l})(),h=(()=>{return(l=h||(h={}))[l.Refunded=33004]="Refunded",h;var l})()}}]);