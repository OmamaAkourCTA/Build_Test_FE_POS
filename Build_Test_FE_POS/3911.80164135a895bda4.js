"use strict";(self.webpackChunkmarkaizaAdmin=self.webpackChunkmarkaizaAdmin||[]).push([[3911],{38936:(C,h,r)=>{r.d(h,{X:()=>b});var e=r(94650),p=r(86260),u=r(32298),m=r(42953),g=r(43346),l=r(75304),c=r(36895),d=r(24006),n=r(96603);const s=["fileInput"];function a(f,T){if(1&f){const i=e.EpF();e.ynx(0),e.TgZ(1,"div",29)(2,"label",30),e._uU(3),e.qZA(),e.TgZ(4,"div",31)(5,"img",32),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.fileAction("view"))}),e.qZA(),e.TgZ(6,"img",33),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.fileAction("delete"))}),e.qZA()()(),e.BQk()}if(2&f){const i=e.oxw();e.xp6(3),e.Oqu(i.fileName)}}function D(f,T){1&f&&(e.TgZ(0,"small",34),e._uU(1,"Attachment is required"),e.qZA())}function I(f,T){if(1&f&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&f){const i=e.oxw();e.xp6(1),e.Oqu(i.invalidFileType)}}let b=(()=>{class f{constructor(i,t,o,_){this._activeModal=i,this._modalService=t,this._collectService=o,this._commonService=_,this.fileName="",this.note="",this.invalidFileType="",this.eventData=new e.vpe}ngOnInit(){console.log(this.data.details),console.log(this.data?.details?.servicesSalesOrderNo)}handleConfirm(){if(this.isSubmitted=!0,!this.fileName)return;let i=new FormData;i.append("SignNote",this.note),i.append("Attachment",this.uploadedFile?.file),7001==this.data?.orderType?(i.append("OrderId",this.data?.details?.servicesSalesOrderNo),this.serviceSignInvoice(i)):7002==this.data?.orderType?(i.append("OrderId",this.data?.details?.directPaymentSalesOrderOpportunityNo||this.data?.order?.directPaymentSalesOrderOpportunityNo),this.dpSignInvoice(i)):(i.append("OrderId",this.data?.details?.sparePartsSalesOrderOpportunityNo),this.sparePartSignInvoice(i))}serviceSignInvoice(i){this._collectService.serviceSignRefundInvoice(i).subscribe(t=>{if(t.isSuccess){this.eventData.emit({isSuccess:!0});const o=this._modalService.open(p.i);o.componentInstance.type="success",o.componentInstance.message="Signed successfully!"}},t=>{const o=this._modalService.open(p.i);o.componentInstance.type="error",o.componentInstance.messageError=t?.error?.errors})}dpSignInvoice(i){this._collectService.dpSignInvoice(i).subscribe(t=>{if(t.isSuccess){this.eventData.emit({isSuccess:!0});const o=this._modalService.open(p.i);o.componentInstance.type="success",o.componentInstance.message="Signed successfully!"}},t=>{const o=this._modalService.open(p.i);o.componentInstance.type="error",o.componentInstance.messageError=t?.error?.errors})}sparePartSignInvoice(i){this._collectService.signRefundInvoice(i).subscribe(t=>{if(t.isSuccess){this.eventData.emit({isSuccess:!0});const o=this._modalService.open(p.i);o.componentInstance.type="success",o.componentInstance.message="Signed successfully!"}},t=>{const o=this._modalService.open(p.i);o.componentInstance.type="error",o.componentInstance.messageError=t?.error?.errors})}fileAction(i){"view"==i?this._modalService.open(u.g,{size:"md"}).componentInstance.imageUploadedView=this.uploadedFile:(this.inputFile.nativeElement.value=null,this.fileName="",this.uploadedFile={})}filesDropped(i){this.enter=!1;let t=this._commonService.checkInvalidImageFormat(i,!0).invalidExtentions;if(this.invalidFileType=this._commonService.checkInvalidImageFormat(i,!0).invalidError,t)return void(this.inputFile.nativeElement.value=null);let o=i.map(_=>_.file);t||o.forEach(_=>{this.fileName=_.name,this._commonService.fileToBase64(_).then(v=>{this.uploadedFile=v})})}onSelectFile(i){let t=[...i.target.files],o=this._commonService.checkInvalidImageFormat(t,!0).invalidExtentions;this.invalidFileType=this._commonService.checkInvalidImageFormat(t,!0).invalidError,o?this.inputFile.nativeElement.value=null:t.length>0&&(o||t.forEach(_=>{this.fileName=_.name,this._commonService.fileToBase64(_).then(v=>{this.uploadedFile=v})}))}removeFile(i){this.inputFile.nativeElement.value=null,this.fileName="",this.uploadedFile=null}}return f.\u0275fac=function(i){return new(i||f)(e.Y36(m.Kz),e.Y36(m.FF),e.Y36(g.k),e.Y36(l.v))},f.\u0275cmp=e.Xpm({type:f,selectors:[["app-sign"]],viewQuery:function(i,t){if(1&i&&e.Gf(s,5),2&i){let o;e.iGM(o=e.CRH())&&(t.inputFile=o.first)}},inputs:{data:"data"},outputs:{eventData:"eventData"},decls:43,vars:5,consts:[[1,"fc-modal","p-4","custom-form-input"],[1,"modal-header","p-0","flex-column","align-items-start"],["ngbAutofocus","",1,"modal-title","fw-bolder","pb-1"],[1,"modal-body","p-0"],[1,"row","mt-3"],[1,"col-sm-6"],[1,"fw-500"],[1,"disabled-box"],[1,"fw-500","light-gray"],[1,"col-12"],[1,"signed-attachment"],[1,"m-0"],[1,"col-sm-6","mt-3"],[1,"form-group","mb-3"],["appImageDrag","","accept",".png,.jpg,.jpeg,.pdf",1,"card-upload",3,"files","enter","leave","click"],[1,"my-3"],["src","assets/images/upload.png","alt",""],["type","file","accept",".png,.jpg,.jpeg,.pdf","hidden","",1,"form-control",3,"change"],["fileInput",""],[4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"col-sm-12","mt-3"],[1,"fw-500","d-inline-block","mb-2"],[1,""],["rows","3",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer","p-4","border-0"],[1,"btns-group"],["type","button",1,"btn","btn-cancel",3,"click"],["type","button",1,"btn","btn-save",3,"click"],[1,"d-flex","gap-3","file-item","align-items-center","justify-content-between"],[1,"p-0"],[1,"d-flex","gap-2"],["height","20","src","assets/images/eye.png",1,"cursor-pointer",3,"click"],["height","20","src","assets/images/trash.png",1,"cursor-pointer",3,"click"],[1,"text-danger"]],template:function(i,t){if(1&i){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"h4",2),e._uU(3,"Receipt Sign"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"label",6),e._uU(8,"Customer Name"),e.qZA(),e.TgZ(9,"div",7)(10,"p",8),e._uU(11),e.qZA()()(),e.TgZ(12,"div",9)(13,"div",10)(14,"h6",11),e._uU(15,"Upload signed attachment and mark the order as signed "),e.qZA()()(),e.TgZ(16,"div",12)(17,"label",6),e._uU(18,"Attachment*"),e.qZA(),e.TgZ(19,"div",13)(20,"div",14),e.NdJ("files",function(v){return t.filesDropped(v)})("enter",function(){return t.enter=!t.enter})("leave",function(){return t.enter=!t.enter})("click",function(){e.CHM(o);const v=e.MAs(28);return e.KtG(v.click())}),e.TgZ(21,"div",15),e._UZ(22,"img",16),e.TgZ(23,"h5"),e._uU(24,"Select OR Drag & drop files"),e.qZA(),e.TgZ(25,"p"),e._uU(26,"Supported formates: JPEG, PNG, PDF"),e.qZA()()(),e.TgZ(27,"input",17,18),e.NdJ("change",function(v){return t.onSelectFile(v)}),e.qZA()(),e.YNc(29,a,7,1,"ng-container",19),e.YNc(30,D,2,0,"small",20),e.YNc(31,I,2,1,"small",20),e.qZA(),e.TgZ(32,"div",21)(33,"label",22),e._uU(34,"Note"),e.qZA(),e.TgZ(35,"div",23)(36,"textarea",24),e.NdJ("ngModelChange",function(v){return t.note=v}),e.qZA()()()()()(),e.TgZ(37,"div",25)(38,"div",26)(39,"button",27),e.NdJ("click",function(){return t._activeModal.close("Save click")}),e._uU(40,"Cancel"),e.qZA(),e.TgZ(41,"button",28),e.NdJ("click",function(){return t.handleConfirm()}),e._uU(42,"Add"),e.qZA()()()}2&i&&(e.xp6(11),e.Oqu(null==t.data||null==t.data.details||null==t.data.details.customer?null:t.data.details.customer.customerName),e.xp6(18),e.Q6J("ngIf",t.fileName),e.xp6(1),e.Q6J("ngIf",!t.fileName&&t.isSubmitted),e.xp6(1),e.Q6J("ngIf",t.invalidFileType),e.xp6(5),e.Q6J("ngModel",t.note))},dependencies:[c.O5,d.Fj,d.JJ,d.On,n.z],styles:[".signed-attachment[_ngcontent-%COMP%]{height:108px;border-radius:5px;background:#F9F9F9;display:flex;align-items:center;justify-content:center}.signed-attachment[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:20px;font-weight:600;text-align:center;color:#929eae}.card-upload[_ngcontent-%COMP%]{border:1px dashed #939aa8;text-align:center;padding:10px;border-radius:10px;margin:10px 0;cursor:pointer}.card-upload[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;margin-bottom:15px}.card-upload[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-weight:600;font-size:18px;color:#0f0f0f}.card-upload[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;font-size:14px;line-height:18px;color:#676767}.file-item[_ngcontent-%COMP%]{padding:10px;border-radius:5px;border:1px solid #dadada;background:white}.file-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:1;color:green;font-weight:600}"]}),f})()},71891:(C,h,r)=>{r.d(h,{W:()=>d});var e=r(94650),p=r(42953),u=r(36895);function m(n,s){if(1&n&&(e.ynx(0),e._UZ(1,"img",7),e.BQk()),2&n){const a=e.oxw(2);e.xp6(1),e.Q6J("src",a.file,e.LSH)}}function g(n,s){if(1&n&&(e.TgZ(0,"div",8),e._UZ(1,"img",9)(2,"br"),e.TgZ(3,"a",10),e._uU(4,"click to open pdf "),e.qZA()()),2&n){const a=e.oxw(2);e.xp6(3),e.s9C("href",a.file,e.LSH)}}function l(n,s){if(1&n&&(e.ynx(0),e.YNc(1,m,2,1,"ng-container",1),e.YNc(2,g,5,1,"ng-template",null,6,e.W1O),e.BQk()),2&n){const a=e.MAs(3),D=e.oxw();e.xp6(1),e.Q6J("ngIf","png"==D.fileType||"jpeg"==D.fileType||"jpg"==D.fileType)("ngIfElse",a)}}function c(n,s){1&n&&(e.TgZ(0,"p",11),e._uU(1,"No attachemnt..."),e.qZA())}let d=(()=>{class n{constructor(a){this._activeModal=a,this.fileType=""}ngOnInit(){this.getFileType(this.file)}getFileType(a){this.fileType=a?.split(".").pop()}}return n.\u0275fac=function(a){return new(a||n)(e.Y36(p.Kz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-view-uploaded-file"]],inputs:{file:"file"},decls:8,vars:2,consts:[[1,"modal-body","p-2"],[4,"ngIf","ngIfElse"],["noFile",""],[1,"flex-end"],[1,"btns-group","my-2","mx-0"],["type","button",1,"btn","btn-save",3,"click"],["pdf",""],[1,"w-100",3,"src"],[1,"d-flex","justify-content-center","flex-column","align-items-center"],["height","80","width","80","src","assets/images/pdf.png","alt",""],["target","_blank",1,"text-decoration-none","text-capitalize",3,"href"],[1,"primary-clr","mx-0","my-3"]],template:function(a,D){if(1&a&&(e.TgZ(0,"div",0),e.YNc(1,l,4,2,"ng-container",1),e.YNc(2,c,2,0,"ng-template",null,2,e.W1O),e.TgZ(4,"div",3)(5,"div",4)(6,"button",5),e.NdJ("click",function(){return D._activeModal.close("Close click")}),e._uU(7," Close "),e.qZA()()()()),2&a){const I=e.MAs(3);e.xp6(1),e.Q6J("ngIf",D.file)("ngIfElse",I)}},dependencies:[u.O5]}),n})()},41746:(C,h,r)=>{r.d(h,{v:()=>l});var e=r(94650),p=r(42953),u=r(75304),m=r(36895);function g(c,d){if(1&c&&(e.ynx(0),e._UZ(1,"i",6),e.TgZ(2,"h6",7),e._uU(3),e.qZA(),e.BQk()),2&c){const n=e.oxw();e.xp6(3),e.hij(" ",null==n.data?null:n.data.message," ")}}let l=(()=>{class c{constructor(n,s,a){this._activeModal=n,this._modalService=s,this._commonService=a}ngOnChanges(){console.log()}ngOnInit(){}redirectTo(){this.data.redirectUrl&&this._commonService.NavigateToRoute(this.data?.redirectUrl)}downloadInvoices(){Array.isArray(this.data.invoices)?this.data.invoices.forEach(s=>{this.iterateData(s)}):this.iterateData(this.data.invoices),setTimeout(()=>{this._modalService.dismissAll()},3e3)}iterateData(n){for(let s in n){let a=n[s];a&&setTimeout(()=>{this.downloadURI(a)},500)}}downloadURI(n){n.split("/").pop();var a=document.createElement("a");a.setAttribute("target","_blank"),a.href=n,document.body.appendChild(a),a.click(),a.remove()}}return c.\u0275fac=function(n){return new(n||c)(e.Y36(p.Kz),e.Y36(p.FF),e.Y36(u.v))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-download-invoices"]],inputs:{data:"data"},features:[e.TTD],decls:8,vars:2,consts:[[1,"modal-body"],[1,"d-flex","flex-column","align-items-center","gap-2","text-center","p-3"],[4,"ngIf"],[1,"btns-group","m-0","gap-2"],[1,"btn","btn-save",3,"click"],[1,"btn","btn","btn-cancel",3,"click"],[1,"green-clr","fa-regular","fa-circle-check","fa-2x"],[1,"m-0","mb-2"]],template:function(n,s){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,g,4,1,"ng-container",2),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){return s.downloadInvoices()}),e._uU(5),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return s._activeModal.close("yes"),s.redirectTo()}),e._uU(7,"Close"),e.qZA()()()()),2&n&&(e.xp6(2),e.Q6J("ngIf",null==s.data?null:s.data.message),e.xp6(3),e.hij(" ",(null==s.data?null:s.data.buttonName)&&(null==s.data?null:s.data.buttonName)||"View Invoice",""))},dependencies:[m.O5]}),c})()},96603:(C,h,r)=>{r.d(h,{z:()=>u});var e=r(94650),p=r(11481);let u=(()=>{class m{constructor(l){this.sanitizer=l,this.files=new e.vpe,this.enter=new e.vpe,this.leave=new e.vpe,this.background="",this.border=""}onDragEnter(l){l.preventDefault(),l.stopPropagation(),this.enter.emit()}onDragOver(l){l.preventDefault(),l.stopPropagation(),this.background="#d9e4f0",this.border="2px dashed #226BC0"}onDragLeave(l){l.preventDefault(),l.stopPropagation(),this.leave.emit(),this.background="",this.border=""}onDrop(l){l.preventDefault(),l.stopPropagation(),this.background="",this.border="";let c=[];for(let d=0;d<l.dataTransfer.files.length;d++){const n=l.dataTransfer.files[d],s=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(n));c.push({file:n,url:s})}c.length>0&&this.files.emit(c)}}return m.\u0275fac=function(l){return new(l||m)(e.Y36(p.H7))},m.\u0275dir=e.lG2({type:m,selectors:[["","appImageDrag",""]],hostVars:4,hostBindings:function(l,c){1&l&&e.NdJ("dragenter",function(n){return c.onDragEnter(n)})("dragover",function(n){return c.onDragOver(n)})("dragleave",function(n){return c.onDragLeave(n)})("drop",function(n){return c.onDrop(n)}),2&l&&e.Udp("background",c.background)("border",c.border)},outputs:{files:"files",enter:"enter",leave:"leave"}}),m})()},82757:(C,h,r)=>{r.d(h,{N:()=>p});var e=r(94650);let p=(()=>{class u{onInputChange(g){return!!new RegExp("[0-9]").test(g.key)||(g.preventDefault(),!1)}}return u.\u0275fac=function(g){return new(g||u)},u.\u0275dir=e.lG2({type:u,selectors:[["input","numbersOnly",""]],hostBindings:function(g,l){1&g&&e.NdJ("keypress",function(d){return l.onInputChange(d)})}}),u})()}}]);