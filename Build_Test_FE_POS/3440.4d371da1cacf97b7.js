"use strict";(self.webpackChunkmarkaizaAdmin=self.webpackChunkmarkaizaAdmin||[]).push([[3440],{73440:(Ot,I,c)=>{c.r(I),c.d(I,{ReturnModule:()=>St});var l=c(36895),g=c(39485),x=c(59241),e=c(94650),y=c(75706),h=c(3898),O=c(41746),_=c(86260),u=c(24006),d=c(42953),m=c(43346);const U=["invoicesModal"];function q(i,a){if(1&i&&(e.TgZ(0,"div",21)(1,"div",22)(2,"p"),e._uU(3),e.qZA()()()),2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.message)}}function k(i,a){if(1&i&&(e.TgZ(0,"div",23)(1,"div",24)(2,"div",25),e._UZ(3,"input",26),e.TgZ(4,"label",27),e._uU(5,"Return By Credit Card"),e.qZA()(),e.TgZ(6,"div",28),e._UZ(7,"input",29),e.TgZ(8,"label",30),e._uU(9,"Return By Cash"),e.qZA()()()()),2&i){const t=e.oxw();e.xp6(2),e.ekj("disable-elm",!(null!=t.data&&null!=t.data.details&&t.data.details.returnPaymentMethodByCard)||"partial return"==t.returnOrderType),e.xp6(1),e.Q6J("value",!0)("formControl",t.isCreditCard),e.xp6(4),e.Q6J("value",!1)("formControl",t.isCreditCard)}}function P(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",31)(1,"div",32),e._UZ(2,"i",33),e.TgZ(3,"h5"),e._uU(4,"Confirmation!"),e.qZA(),e.TgZ(5,"h6",34),e._uU(6),e.qZA(),e.TgZ(7,"div",35)(8,"button",19),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.KtG(s.close("yes"))}),e._uU(9,"Yes"),e.qZA(),e.TgZ(10,"button",19),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.KtG(s.dismiss("dismiss"))}),e._uU(11,"No"),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.hij("Are you sure you want to ",238==t.statusCode||239==t.statusCode?"transfer this order to treasury?":"refund this order?","")}}let f=(()=>{class i{constructor(t,n,r){this._activeModal=t,this._modalService=n,this._collectService=r,this.statusCode=0,this.returnOrderType="",this.eventData=new e.vpe,this.isCreditCard=new u.NI(!1)}ngOnInit(){console.log(this.data),this.returnOrderType=this.data?.details?.returnOrderType.toLowerCase(),this.isCreditCard.setValue("partial return"!=this.returnOrderType&&this.data?.details?.returnPaymentMethodByCard)}handleConfirm(t){this._modalService.open(t,{size:"md"}).result.then(n=>{"yes"==n&&(7001==this.data?.orderType?this.cashierRefundServiceOrder():7002==this.data?.orderType?this.dPCashierFullRefundOrder():this.cashierFullRefundSparePartsOrder())},n=>{})}cashierRefundServiceOrder(){const t=new FormData;t.append("OrderId",this.data?.details?.servicesSalesOrderNo),238==this.statusCode||239==this.statusCode?this._collectService.sendServiceReturnOrderToTreasury(t).subscribe(n=>{n.isSuccess&&(this.eventData.emit({isSuccess:!0}),this.openTreasurySuccessModal())},n=>{const r=this._modalService.open(_.i);r.componentInstance.type="error",r.componentInstance.messageError=n?.error?.errors}):(t.append("ReturnPaymentMethodByCard",this.isCreditCard.value),t.append("RefundAmount",this.data?.details?.grandAmount),this._collectService.cashierRefundServiceOrder(t).subscribe(n=>{if(n.isSuccess){this.eventData.emit({isSuccess:!0});let r={message:"Your refund successfully completed!",invoices:n?.data};this._modalService.open(O.v).componentInstance.data=r}},n=>{this.statusCode=n?.error?.errors[0]?.StatusCode,this.message=n?.error?.errors[0]?.ErrorMessageEn}))}cashierFullRefundSparePartsOrder(){const t=new FormData;t.append("OrderId",this.data?.details?.sparePartsSalesOrderOpportunityNo),238==this.statusCode||239==this.statusCode?this._collectService.sendSparePartsReturnOrderToTreasury(t).subscribe(n=>{n.isSuccess&&(this.eventData.emit({isSuccess:!0}),this.openTreasurySuccessModal())},n=>{const r=this._modalService.open(_.i);r.componentInstance.type="error",r.componentInstance.messageError=n?.error?.errors}):(t.append("ReturnPaymentMethodByCard",this.isCreditCard.value),t.append("RefundAmount",this.data?.details?.grandAmount),this._collectService.cashierFullRefundSparePartsOrder(t).subscribe(n=>{if(n.isSuccess){this.eventData.emit({isSuccess:!0});let r={message:"Your refund successfully completed!",invoices:n?.data};this._modalService.open(O.v).componentInstance.data=r}},n=>{this.statusCode=n?.error?.errors[0]?.StatusCode,this.message=n?.error?.errors[0]?.ErrorMessageEn}))}dPCashierFullRefundOrder(){const t=new FormData;t.append("OrderId",this.data?.details?.directPaymentSalesOrderOpportunityNo),238==this.statusCode||239==this.statusCode?this._collectService.sendReturnDpOrderToTreasury(t).subscribe(n=>{n.isSuccess&&(this.eventData.emit({isSuccess:!0}),this.openTreasurySuccessModal())},n=>{const r=this._modalService.open(_.i);r.componentInstance.type="error",r.componentInstance.messageError=n?.error?.errors}):(t.append("ReturnPaymentMethodByCard",this.isCreditCard.value),t.append("RefundAmount",this.data?.details?.grandAmount),this._collectService.dPCashierFullRefundOrder(t).subscribe(n=>{if(n.isSuccess){this.eventData.emit({isSuccess:!0});let r={message:"Your refund successfully completed!",invoices:n?.data,buttonName:"View Receipt"};this._modalService.open(O.v).componentInstance.data=r}},n=>{this.statusCode=n?.error?.errors[0]?.StatusCode,this.message=n?.error?.errors[0]?.ErrorMessageEn}))}openTreasurySuccessModal(){const t=this._modalService.open(_.i);t.componentInstance.type="success",t.componentInstance.message="Your return order successfully sent to Treasury!"}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.Kz),e.Y36(d.FF),e.Y36(m.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-modal-popup"]],viewQuery:function(t,n){if(1&t&&e.Gf(U,5),2&t){let r;e.iGM(r=e.CRH())&&(n.invoicesModal=r.first)}},inputs:{data:"data"},outputs:{eventData:"eventData"},decls:48,vars:13,consts:[[1,"fc-modal","p-4","custom-form-input"],[1,"modal-header","p-0","flex-column","align-items-start"],["ngbAutofocus","",1,"modal-title","fw-bolder","pb-1"],[1,"modal-body","p-0"],[1,"row","mt-3"],[1,"col-sm-6"],[1,"fw-500"],[1,"disabled-box"],[1,"fw-500","light-gray"],[1,"row"],[1,"fw-500","light-gray","text-capitalize"],["class","col-12",4,"ngIf"],[1,"col-sm-12"],[1,"fw-500","mb-2"],["rows","4",1,"form-control"],["class","col-12 mt-3",4,"ngIf"],[1,"modal-footer","p-4","border-0"],[1,"btns-group"],["type","button",1,"btn","btn-cancel",3,"click"],["type","button",1,"btn","btn-save",3,"click"],["confirmModal",""],[1,"col-12"],[1,"error-message","my-3"],[1,"col-12","mt-3"],[1,"d-flex","gap-3","align-items-center"],[1,"form-check","d-flex","align-items-center","pe-2","gap-2"],["id","card","type","radio",1,"form-check-input",3,"value","formControl"],["for","card"],[1,"form-check","d-flex","align-items-center","ps-2","gap-2"],["id","cash","type","radio",1,"form-check-input",3,"value","formControl"],["for","cash"],[1,"modal-body"],[1,"d-flex","flex-column","align-items-center","gap-2","text-center","p-3"],[1,"green-clr","fa-regular","fa-circle-check","fa-2x"],[1,"m-0","mb-2"],[1,"btns-group","m-0","gap-2"]],template:function(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"h4",2),e._uU(3,"Refund"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"label",6),e._uU(8,"Customer Name"),e.qZA(),e.TgZ(9,"div",7)(10,"p",8),e._uU(11),e.qZA()()()(),e.TgZ(12,"div",9)(13,"div",5)(14,"label",6),e._uU(15,"Return Type"),e.qZA(),e.TgZ(16,"div",7)(17,"p",10),e._uU(18),e.qZA()()(),e.TgZ(19,"div",5)(20,"label",6),e._uU(21,"Register Refund Threshold"),e.qZA(),e.TgZ(22,"div",7)(23,"p",8),e._uU(24),e.ALo(25,"number"),e.qZA()()()(),e.TgZ(26,"div",9)(27,"div",5)(28,"label",6),e._uU(29,"Refund amount"),e.qZA(),e.TgZ(30,"div",7)(31,"p",8),e._uU(32),e.ALo(33,"number"),e.qZA()()(),e.YNc(34,q,4,1,"div",11),e.TgZ(35,"div",12)(36,"label",13),e._uU(37,"Notes"),e.qZA(),e._UZ(38,"textarea",14),e.qZA(),e.YNc(39,k,10,6,"div",15),e.qZA()()(),e.TgZ(40,"div",16)(41,"div",17)(42,"button",18),e.NdJ("click",function(){return n._activeModal.close("Save click")}),e._uU(43,"Close"),e.qZA(),e.TgZ(44,"button",19),e.NdJ("click",function(){e.CHM(r);const o=e.MAs(47);return e.KtG(n.handleConfirm(o))}),e._uU(45),e.qZA()()(),e.YNc(46,P,12,1,"ng-template",null,20,e.W1O)}2&t&&(e.xp6(11),e.Oqu(null==n.data||null==n.data.details||null==n.data.details.customer?null:n.data.details.customer.customerName),e.xp6(7),e.Oqu(null==n.data||null==n.data.details?null:n.data.details.returnOrderType),e.xp6(6),e.hij("",e.xi3(25,7,null==n.data||null==n.data.details?null:n.data.details.registerThreshold,"2.3-3")," JOD"),e.xp6(8),e.hij("",e.xi3(33,10,null==n.data||null==n.data.details?null:n.data.details.grandAmount,"2.3-3")," JOD"),e.xp6(2),e.Q6J("ngIf",n.message),e.xp6(5),e.Q6J("ngIf","cash"==(null==n.data||null==n.data.details?null:n.data.details.invoiceType.toLowerCase())),e.xp6(6),e.Oqu(0==n.statusCode?"Confirm":"Transfer to Treasury"))},dependencies:[l.O5,u.Fj,u._,u.JJ,u.oH,l.JJ],styles:[".error-message[_ngcontent-%COMP%]{min-height:80px;border-radius:5px;border:1px solid #F70B0B;background:#F9F9F9;display:flex;align-items:center;justify-content:center;padding:15px 10px}.error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;font-size:16px;font-weight:600;margin:0;color:#f70b0b}"]}),i})();var b=c(87364),v=c(38936),Z=c(75304),R=c(69082),T=c(72402),C=c(94349),S=c(28424),D=c(59442);function w(i,a){1&i&&e._uU(0),2&i&&e.hij(" ","Own Branch - "+a.item.branchName," ")}function J(i,a){1&i&&(e.ynx(0),e.YNc(1,w,1,1,"ng-template",22),e.BQk())}function M(i,a){1&i&&(e.TgZ(0,"span",23),e._uU(1,"Branch is required"),e.qZA())}function j(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByOrderNo())}),e._UZ(1,"i",25),e.qZA()}}function F(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByCashCard())}),e._UZ(1,"i",25),e.qZA()}}function B(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByName())}),e._UZ(1,"i",25),e.qZA()}}function L(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"i",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByDate())}),e.qZA()}}function Q(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1,"---"),e.qZA())}function Y(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2).$implicit,s=e.oxw(2);return e.KtG(s.returnAction(null==r?null:r.returnOrderType,r))}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw(2).$implicit;e.Q6J("disabled","Treasury"==(null==t?null:t.sentTo)),e.xp6(1),e.hij(" ",null==t||null==t.actionObj[0]?null:t.actionObj[0].lookupName," ")}}function E(i,a){if(1&i&&(e.TgZ(0,"td"),e.ynx(1,41),e.YNc(2,Q,2,0,"span",42),e.YNc(3,Y,2,2,"button",43),e.BQk(),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngSwitch",null==t?null:t.status),e.xp6(1),e.Q6J("ngSwitchCase",10010)}}function G(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"button",45),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.returnAction("view",r))}),e._uU(2,"View"),e.qZA()()}}const z=function(i,a){return{"background-color":i,color:a}};function H(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr",37),e.NdJ("click",function(r){const o=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.viewDetails(r,null==o?null:o.servicesSalesOrderNo,o))}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"td")(14,"div",38),e._uU(15),e.qZA()(),e.YNc(16,E,4,2,"td",39),e.YNc(17,G,3,0,"ng-template",null,40,e.W1O),e.qZA()}if(2&i){const t=a.$implicit,n=e.MAs(18);e.xp6(2),e.Oqu(null==t?null:t.servicesSalesOrderNo),e.xp6(2),e.Oqu(null==t||null==t.customer?null:t.customer.customerName),e.xp6(2),e.Oqu(null==t||null==t.returnedBy?null:t.returnedBy.fullName),e.xp6(2),e.Oqu(e.xi3(9,9,null==t?null:t.returnAt,"mediumDate")),e.xp6(3),e.hij("",e.xi3(12,12,null==t?null:t.grandAmount,"2.3-3")," JOD"),e.xp6(3),e.Q6J("ngStyle",e.WLB(15,z,null==t||null==t.statusObj?null:t.statusObj.lookupBGColor,null==t||null==t.statusObj?null:t.statusObj.lookupTextColor)),e.xp6(1),e.hij(" ",null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName," "),e.xp6(1),e.Q6J("ngIf","refunded"!==(null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName.toLowerCase())&&"collected"!==(null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName.toLowerCase()))("ngIfElse",n)}}function $(i,a){1&i&&(e.TgZ(0,"div",46),e._UZ(1,"app-not-found"),e.qZA())}function K(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",27)(2,"div",28)(3,"table",29)(4,"thead")(5,"tr")(6,"th",30)(7,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByOrderNo())}),e._uU(8," Order No. "),e._UZ(9,"i",32)(10,"i",33),e.qZA()(),e.TgZ(11,"th",30)(12,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByCustomerDetails())}),e._uU(13," Customer Details "),e._UZ(14,"i",32)(15,"i",33),e.qZA()(),e.TgZ(16,"th",30)(17,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByReturn())}),e._uU(18," Return By "),e._UZ(19,"i",32)(20,"i",33),e.qZA()(),e.TgZ(21,"th",30)(22,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByReturnDate())}),e._uU(23," Return Date "),e._UZ(24,"i",32)(25,"i",33),e.qZA()(),e.TgZ(26,"th",30)(27,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByRefund())}),e._uU(28," Refund/Collect Amount "),e._UZ(29,"i",32)(30,"i",33),e.qZA()(),e.TgZ(31,"th",30)(32,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByStatus())}),e._uU(33," Status "),e._UZ(34,"i",32)(35,"i",33),e.qZA()(),e.TgZ(36,"th",30)(37,"button",34),e._uU(38," Action "),e.qZA()()()(),e.TgZ(39,"tbody"),e.YNc(40,H,19,18,"tr",35),e.qZA()()(),e.YNc(41,$,2,0,"div",36),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",2==t.sort),e.xp6(1),e.ekj("active",3==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",4==t.sort),e.xp6(1),e.ekj("active",5==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",6==t.sort),e.xp6(1),e.ekj("active",7==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",8==t.sort),e.xp6(1),e.ekj("active",9==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",10==t.sort),e.xp6(1),e.ekj("active",11==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",12==t.sort),e.xp6(1),e.ekj("active",13==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(3),e.Q6J("ngForOf",t.returnOrdersList),e.xp6(1),e.Q6J("ngIf",0==(null==t.returnOrdersList?null:t.returnOrdersList.length))}}function V(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",47)(2,"h6",48),e._uU(3," Showing "),e.TgZ(4,"span"),e._uU(5),e.qZA(),e._uU(6," from "),e.TgZ(7,"span"),e._uU(8),e.qZA(),e._uU(9," data "),e.qZA()(),e.TgZ(10,"div",47)(11,"ngb-pagination",49),e.NdJ("pageChange",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.pageNo=r)})("pageChange",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.pageChange(r))}),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(5),e.AsE("",6*t.pageNo-5," - ",6==(null==t.returnOrdersList?null:t.returnOrdersList.length)?6*t.pageNo:t.totalRecords,""),e.xp6(3),e.hij(" ",t.totalRecords," "),e.xp6(3),e.Q6J("collectionSize",t.totalRecords)("page",t.pageNo)("maxSize",3)("pageSize",6)("rotate",!0)("ellipses",!1)}}function X(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"app-loading"),e.qZA())}const W=function(){return{containerClass:"theme-red",isAnimated:!0,showClearButton:!0}};let ee=(()=>{class i{constructor(t,n,r,s,o){this._collectService=t,this._commonService=n,this._sharedService=r,this._datePipe=s,this._modalService=o,this.returnStatus=y.Rr,this.searchOrderNo="",this.searchCustomerName="",this.serachCashCard="",this.returnType="",this.dateObj={fromDate:"",toDate:""},this.dateFilter=null,this.returnOrdersList=[],this.branches=[],this.users=[],this.branchId=null,this.userId=null,this.sort=1,this.pageNo=1,this.totalRecords=0,this.orderStatus=null,this.statusList=[]}ngOnInit(){this.getRegisterDetails(),this.getUsers(),this.getStausList()}filterByOrderStatus(t){t?(this.orderStatus=t?.value,this.pageNo=1,this.getServicesReturnOrders()):(this.pageNo=1,this.orderStatus=null,this.getServicesReturnOrders())}getStausList(){this._collectService.getLookupsById(10).subscribe(t=>{this.statusList=t.data.map(n=>({text:n?.name[0]?.lookupName,value:n?.id}))})}viewDetails(t,n,r){if("button"!=t.target.tagName.toLowerCase()&&"elipse"!=t.target.id){let p={branchId:this.branchId,searchCustomerName:this.searchCustomerName,searchOrderNo:this.searchOrderNo,serachCashCard:this.serachCashCard,userId:this.userId,orderStatus:this.orderStatus,dateFilter:this.dateFilter};localStorage.setItem("returnOrder",JSON.stringify(r)),localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),...p})),this._commonService.NavigateToRoute(`/return/services-details/${n}`)}}downloadInvoices(t){this._commonService.downloadInvoices({invoices:t})}getRegisterDetails(){this._collectService.GetRegisterDetails(this._sharedService.getRegister.registerObj?.id).subscribe(t=>{this.registerDetails=t.data,this.getBranches(3002)})}getBranches(t){this.branches=this.registerDetails.registerBranches.map(r=>({...r,branchType:r?.branchTypes[0]?.branchTypeId})).filter(r=>r?.branchType==t),this.isRegisterBranch=this.registerDetails.branchId,this.branchId=this.registerDetails?.collectForOwnBranch?this.branches.findIndex(s=>s.branchId==this.isRegisterBranch)>=0?this.isRegisterBranch:null:this.branches[0].branchId;let n=JSON.parse(localStorage.getItem("returnParams"));n?.branchId&&(this.branchId=n.branchId,this.searchCustomerName=n.searchCustomerName,this.searchOrderNo=n.searchOrderNo,this.userId=n.userId,this.serachCashCard=n.serachCashCard,this.orderStatus=n.orderStatus,n?.dateFilter&&(this.dateFilter=[new Date(n?.dateFilter[0]),new Date(n?.dateFilter[1])]),localStorage.removeItem("returnParams")),null!==this.branchId&&this.getServicesReturnOrders()}getUsers(){return this._collectService.getUsers(32).subscribe(n=>{n&&(this.users=n.data)})}handleBranchChange(t){let n=t?.branchId;(null!==n||void 0!==n)&&(this.branchId=t?.branchId,this.pageNo=1,this.getServicesReturnOrders())}clearBranch(t){this.branchId=t?.branchId,this.returnOrdersList=[],this.totalRecords=0}filterByUserId(t){this.pageNo=1,this.userId=t?.userId,this.getServicesReturnOrders()}clearUser(){this.pageNo=1,this.getServicesReturnOrders()}handleSearchByOrderNo(t){this.pageNo=1,this.searchOrderNo=t?.target.value,this.getServicesReturnOrders()}clearSearchByOrderNo(){this.pageNo=1,this.searchOrderNo="",this.getServicesReturnOrders()}handleSearchByName(t){this.pageNo=1,this.searchCustomerName=t?.target.value,this.getServicesReturnOrders()}clearSearchByName(){this.pageNo=1,this.searchCustomerName="",this.getServicesReturnOrders()}handleSearchByCashCard(t){this.pageNo=1,this.serachCashCard=t?.target.value,this.getServicesReturnOrders()}clearSearchByCashCard(){this.pageNo=1,this.serachCashCard="",this.getServicesReturnOrders()}handleSearchByDate(t){t&&(this.dateObj.fromDate=this._datePipe.transform(t[0],"yyyy-MM-dd"),this.dateObj.toDate=this._datePipe.transform(t[1],"yyyy-MM-dd")),this.pageNo=1,this.getServicesReturnOrders()}clearSearchByDate(){this.pageNo=1,this.dateObj={fromDate:"",toDate:""},this.dateFilter=null,this.getServicesReturnOrders()}getServicesReturnOrders(){let t=`status=${this.orderStatus||""}&customer=${this.searchCustomerName}&ReturnDateFrom=${this.dateObj?.fromDate}&ReturnDateTo=${this.dateObj?.toDate}&cashCard=${this.serachCashCard||""}&sort=${this.sort}&orderNo=${this.searchOrderNo}&pageNo=${this.pageNo-1}&sort=${this.sort}&pageSize=6`;this.userId&&(t+=`&created=${this.userId}`),(+(0==this.branchId)||+this.branchId>0)&&(t+=`&branchId=${this.branchId}`),this._collectService.getServicesReturnOrders(t).subscribe(n=>{this.returnOrdersList=n?.data,this.totalRecords=n?.totalRecordCount})}returnAction(t,n){this.returnType=t.toLowerCase();let r=n?.actionObj[0]?.lookupName.toLowerCase();if("view"===r)this._modalService.open(b.z,{size:"lg"}).componentInstance.data={details:n,orderType:7001};else if("collect"===r){const s=this._modalService.open(h.k,{modalDialogClass:"payment-modal-size"});s.componentInstance.detailsItem={...n,isFromReturn:!0},s.componentInstance.collectionType=7001,s.componentInstance.sendtoLoadData.subscribe(o=>{s.dismiss(),this.getServicesReturnOrders()})}else if("sign"===r){const s=this._modalService.open(v.X,{size:"lg"});s.componentInstance.data={details:n,orderType:7001},s.componentInstance.eventData.subscribe(o=>{o?.isSuccess&&(s.dismiss(),this.getServicesReturnOrders())})}else if("refund"===r){const s=this._modalService.open(f,{size:"lg"});s.componentInstance.data={returnType:this.returnType,details:n,orderType:7001},s.componentInstance.eventData.subscribe(o=>{o?.isSuccess&&(s.dismiss(),this.getServicesReturnOrders())})}}pageChange(t){this.pageNo=t,this.getServicesReturnOrders()}sortByOrderNo(){this.sort=3==this.sort?1:2==this.sort?3:2,this.getServicesReturnOrders()}sortByCustomerDetails(){this.sort=5==this.sort?1:4==this.sort?5:4,this.getServicesReturnOrders()}sortByReturn(){this.sort=7==this.sort?1:6==this.sort?7:6,this.getServicesReturnOrders()}sortByReturnDate(){this.sort=9==this.sort?1:8==this.sort?9:8,this.getServicesReturnOrders()}sortByRefund(){this.sort=11==this.sort?1:10==this.sort?11:10,this.getServicesReturnOrders()}sortByStatus(){this.sort=13==this.sort?1:12==this.sort?13:12,this.getServicesReturnOrders()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.k),e.Y36(Z.v),e.Y36(R.F),e.Y36(l.uU),e.Y36(d.FF))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-return-services"]],inputs:{data:"data"},decls:36,vars:22,consts:[[1,"row"],[1,"col-sm-3"],["placeholder","Search by branch","bindLabel","branchName","bindValue","branchId",3,"disabled","items","ngModel","ngModelChange","change","clear"],[4,"ngIf"],["class","font-14 primary-clr mb-2 d-inline-block",4,"ngIf"],[1,"input-group","mb-3","search-box"],["type","button",1,"btn"],[1,"fa-solid","fa-search"],["type","text","placeholder","Order no...",1,"form-control",3,"ngModel","ngModelChange","input"],["class","btn","type","button","id","button-addon4",3,"click",4,"ngIf"],["type","text","placeholder","Cash card...",1,"form-control",3,"ngModel","ngModelChange","input"],["type","text","placeholder","Customer name...",1,"form-control",3,"ngModel","ngModelChange","input"],["placeholder","Returned by...","bindLabel","fullName","bindValue","userId",3,"items","ngModel","ngModelChange","change","clear"],[1,"col-sm-3","position-relative"],["class","fa-solid fa-times","style","position:absolute;top:15px;right:30px;cursor:pointer",3,"click",4,"ngIf"],["type","text","placeholder","Select Date","bsDaterangepicker","","placement","right",1,"form-control",2,"height","46px",3,"ngModel","bsConfig","ngModelChange","bsValueChange"],[1,"col-3","mb-3"],["placeholder","Status","bindLabel","text","bindValue","value",3,"items","ngModel","ngModelChange","change"],[1,"row","mt-3"],["class","col-md-12",4,"ngIf","ngIfElse"],[1,"col-md-12"],["loading",""],["ng-label-tmp",""],[1,"font-14","primary-clr","mb-2","d-inline-block"],["type","button","id","button-addon4",1,"btn",3,"click"],[1,"fa-solid","fa-xmark"],[1,"fa-solid","fa-times",2,"position","absolute","top","15px","right","30px","cursor","pointer",3,"click"],[1,"card-table","mt-2","register-sessions-table"],[1,"table-responsive"],[1,"table"],["scope","col"],[1,"btn",3,"disabled","click"],[1,"fa-solid","fa-arrow-up-long"],[1,"fa-solid","fa-arrow-down-long"],[1,"btn",3,"disabled"],["class","cursor-pointer",3,"click",4,"ngFor","ngForOf"],["class","not-found",4,"ngIf"],[1,"cursor-pointer",3,"click"],[1,"status-tag","d-block",3,"ngStyle"],[4,"ngIf","ngIfElse"],["showElipse",""],[3,"ngSwitch"],[4,"ngSwitchCase"],["type","button","class","redBtn",3,"disabled","click",4,"ngSwitchDefault"],["type","button",1,"redBtn",3,"disabled","click"],["type","button",1,"redBtn",3,"click"],[1,"not-found"],[1,"col-md-6"],[1,"showing"],[3,"collectionSize","page","maxSize","pageSize","rotate","ellipses","pageChange"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ng-select",2),e.NdJ("ngModelChange",function(s){return n.branchId=s})("change",function(s){return n.handleBranchChange(s)})("clear",function(s){return n.clearBranch(s)}),e.YNc(3,J,2,0,"ng-container",3),e.qZA(),e.YNc(4,M,2,0,"span",4),e.qZA(),e.TgZ(5,"div",1)(6,"div",5)(7,"button",6),e._UZ(8,"i",7),e.qZA(),e.TgZ(9,"input",8),e.NdJ("ngModelChange",function(s){return n.searchOrderNo=s})("input",function(s){return n.handleSearchByOrderNo(s)}),e.qZA(),e.YNc(10,j,2,0,"button",9),e.qZA()(),e.TgZ(11,"div",1)(12,"div",5)(13,"button",6),e._UZ(14,"i",7),e.qZA(),e.TgZ(15,"input",10),e.NdJ("ngModelChange",function(s){return n.serachCashCard=s})("input",function(s){return n.handleSearchByCashCard(s)}),e.qZA(),e.YNc(16,F,2,0,"button",9),e.qZA()(),e.TgZ(17,"div",1)(18,"div",5)(19,"button",6),e._UZ(20,"i",7),e.qZA(),e.TgZ(21,"input",11),e.NdJ("ngModelChange",function(s){return n.searchCustomerName=s})("input",function(s){return n.handleSearchByName(s)}),e.qZA(),e.YNc(22,B,2,0,"button",9),e.qZA()(),e.TgZ(23,"div",1)(24,"ng-select",12),e.NdJ("ngModelChange",function(s){return n.userId=s})("change",function(s){return n.filterByUserId(s)})("clear",function(){return n.clearUser()}),e.qZA()(),e.TgZ(25,"div",13),e.YNc(26,L,1,0,"i",14),e.TgZ(27,"input",15),e.NdJ("ngModelChange",function(s){return n.dateFilter=s})("bsValueChange",function(s){return n.handleSearchByDate(s)}),e.qZA()(),e.TgZ(28,"div",16)(29,"ng-select",17),e.NdJ("ngModelChange",function(s){return n.orderStatus=s})("change",function(s){return n.filterByOrderStatus(s)}),e.qZA()()(),e.TgZ(30,"div",18),e.YNc(31,K,42,33,"div",19),e.YNc(32,V,12,9,"ng-container",3),e.TgZ(33,"div",20),e.YNc(34,X,2,0,"ng-template",null,21,e.W1O),e.qZA()()),2&t){const r=e.MAs(35);e.xp6(2),e.Q6J("disabled",null==n.registerDetails?null:n.registerDetails.collectForOwnBranch)("items",n.branches)("ngModel",n.branchId),e.xp6(1),e.Q6J("ngIf",(null==n.registerDetails?null:n.registerDetails.branchId)==n.branchId),e.xp6(1),e.Q6J("ngIf",n.branchId<0),e.xp6(5),e.Q6J("ngModel",n.searchOrderNo),e.xp6(1),e.Q6J("ngIf",n.searchOrderNo),e.xp6(5),e.Q6J("ngModel",n.serachCashCard),e.xp6(1),e.Q6J("ngIf",n.serachCashCard),e.xp6(5),e.Q6J("ngModel",n.searchCustomerName),e.xp6(1),e.Q6J("ngIf",n.searchCustomerName),e.xp6(2),e.Q6J("items",n.users)("ngModel",n.userId),e.xp6(2),e.Q6J("ngIf",n.dateFilter),e.xp6(1),e.Q6J("ngModel",n.dateFilter)("bsConfig",e.DdM(21,W)),e.xp6(2),e.Q6J("items",n.statusList)("ngModel",n.orderStatus),e.xp6(2),e.Q6J("ngIf",n.returnOrdersList)("ngIfElse",r),e.xp6(1),e.Q6J("ngIf",n.totalRecords>6)}},dependencies:[l.sg,l.O5,l.PC,l.RF,l.n9,l.ED,T.FR,T.TB,u.Fj,u.JJ,u.On,C.w9,C.mR,d.N9,S.N,D.w,l.JJ,l.uU],styles:[".redBtn[_ngcontent-%COMP%]{min-width:100px}"]}),i})();function te(i,a){if(1&i&&(e.TgZ(0,"p",18),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}let A=(()=>{class i{constructor(t,n,r){this._activeModal=t,this._modalService=n,this._collectService=r,this.eventData=new e.vpe,this.message=""}ngOnInit(){console.log(this.data)}handleConfirm(){const t=new FormData;t.append("OrderId",this.data?.details?.sparePartsSalesOrderOpportunityNo),this._collectService.collectZeroReturnOrder(t).subscribe(n=>{console.log(n),n.isSuccess&&(this.eventData.emit({isSuccess:n.isSuccess}),this._modalService.open(O.v).componentInstance.data={message:"Successfully done!",invoices:n.data})},n=>{this.message=n?.error?.errors[0]?.ErrorMessageEn,setTimeout(()=>this.message="",3e3)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.Kz),e.Y36(d.FF),e.Y36(m.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-collect"]],inputs:{data:"data"},outputs:{eventData:"eventData"},decls:43,vars:5,consts:[[1,"fc-modal","p-4","custom-form-input"],[1,"modal-header","p-0","flex-column","align-items-start"],["ngbAutofocus","",1,"modal-title","fw-bolder","pb-1"],[1,"modal-body","p-0"],[1,"row","mt-3"],[1,"col-sm-6"],[1,"fw-500"],[1,"disabled-box"],[1,"fw-500","light-gray"],[1,"row"],[1,"col-12","mt-3"],[1,"signed-attachment"],[1,"m-0"],["class","mt-2 alert alert-danger",4,"ngIf"],[1,"modal-footer","p-4","border-0"],[1,"btns-group"],["type","button",1,"btn","btn-cancel",3,"click"],["type","button",1,"btn","btn-save",3,"click"],[1,"mt-2","alert","alert-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4",2),e._uU(3,"Collect"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"label",6),e._uU(8,"Customer Name"),e.qZA(),e.TgZ(9,"div",7)(10,"p",8),e._uU(11),e.qZA()()()(),e.TgZ(12,"div",9)(13,"div",5)(14,"label",6),e._uU(15,"Return Type"),e.qZA(),e.TgZ(16,"div",7)(17,"p",8),e._uU(18),e.qZA()()(),e.TgZ(19,"div",5)(20,"label",6),e._uU(21,"Register Refund Threshold"),e.qZA(),e.TgZ(22,"div",7)(23,"p",8),e._uU(24),e.qZA()()()(),e.TgZ(25,"div",9)(26,"div",5)(27,"label",6),e._uU(28,"Refund amount"),e.qZA(),e.TgZ(29,"div",7)(30,"p",8),e._uU(31),e.qZA()()(),e.TgZ(32,"div",10)(33,"div",11)(34,"h6",12),e._uU(35,"Here we need to print the invoices and sign them only, please click confirm to continue."),e.qZA()(),e.YNc(36,te,2,1,"p",13),e.qZA()()()(),e.TgZ(37,"div",14)(38,"div",15)(39,"button",16),e.NdJ("click",function(){return n._activeModal.close("Save click")}),e._uU(40,"Cancel"),e.qZA(),e.TgZ(41,"button",17),e.NdJ("click",function(){return n.handleConfirm()}),e._uU(42,"Confirm"),e.qZA()()()),2&t&&(e.xp6(11),e.Oqu(null==n.data||null==n.data.details||null==n.data.details.customer?null:n.data.details.customer.customerName),e.xp6(7),e.Oqu(null==n.data||null==n.data.details?null:n.data.details.returnOrderType),e.xp6(6),e.Oqu(null==n.data||null==n.data.details?null:n.data.details.registerThreshold),e.xp6(7),e.Oqu(null==n.data||null==n.data.details?null:n.data.details.grandAmount),e.xp6(5),e.Q6J("ngIf",n.message))},dependencies:[l.O5],styles:[".signed-attachment[_ngcontent-%COMP%]{height:108px;border-radius:5px;background:#F9F9F9;display:flex;align-items:center;justify-content:center}.signed-attachment[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:20px;font-weight:600;text-align:center;color:#929eae}"]}),i})();function ne(i,a){1&i&&e._uU(0),2&i&&e.hij(" ","Own Branch - "+a.item.branchName," ")}function re(i,a){1&i&&(e.ynx(0),e.YNc(1,ne,1,1,"ng-template",21),e.BQk())}function ie(i,a){1&i&&(e.TgZ(0,"span",22),e._uU(1,"Branch is required"),e.qZA())}function se(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByOrderNo())}),e._UZ(1,"i",24),e.qZA()}}function ae(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByName())}),e._UZ(1,"i",24),e.qZA()}}function oe(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"i",25),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.clearSearchByDate())}),e.qZA()}}function le(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"i",46),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(18);return e.KtG(r.click())}),e.qZA()}}function ce(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1,"---"),e.qZA())}function ue(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",50),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2).$implicit,s=e.oxw(2);return e.KtG(s.returnAction(null==r?null:r.returnOrderType,r))}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw(2).$implicit;e.Q6J("disabled","Treasury"==(null==t?null:t.sentTo)),e.xp6(1),e.hij(" ",null==t||null==t.actionObj[0]?null:t.actionObj[0].lookupName," ")}}function de(i,a){if(1&i&&(e.TgZ(0,"td"),e.ynx(1,47),e.YNc(2,ce,2,0,"span",48),e.YNc(3,ue,2,2,"button",49),e.BQk(),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngSwitch",null==t?null:t.status),e.xp6(1),e.Q6J("ngSwitchCase",10010)}}function pe(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"button",51),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.returnAction("view",r))}),e._uU(2,"View"),e.qZA()()}}const me=function(i,a){return{"background-color":i,color:a}};function _e(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"tr",36),e.NdJ("click",function(r){const o=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.viewDetails(r,null==o?null:o.sparePartsSalesOrderOpportunityNo))}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"td")(14,"div",37),e._uU(15),e.qZA()(),e.TgZ(16,"td")(17,"input",38,39),e.NdJ("change",function(r){const o=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.onSelectFile(r,o))}),e.qZA(),e.TgZ(19,"div",40),e.YNc(20,le,1,0,"i",41),e.TgZ(21,"a",42)(22,"button",43),e._uU(23,"View Return Approval"),e.qZA()()()(),e.YNc(24,de,4,2,"td",44),e.YNc(25,pe,3,0,"ng-template",null,45,e.W1O),e.qZA()}if(2&i){const t=a.$implicit,n=e.MAs(26);e.xp6(2),e.Oqu(null==t?null:t.sparePartsSalesOrderOpportunityNo),e.xp6(2),e.Oqu(null==t||null==t.customer?null:t.customer.customerName),e.xp6(2),e.Oqu(null==t?null:t.returnedBy.fullName),e.xp6(2),e.Oqu(e.xi3(9,12,null==t?null:t.returnAt,"mediumDate")),e.xp6(3),e.hij("",e.xi3(12,15,null==t?null:t.grandAmount,"2.3-3")," JOD"),e.xp6(3),e.Q6J("ngStyle",e.WLB(18,me,null==t||null==t.statusObj?null:t.statusObj.lookupBGColor,null==t||null==t.statusObj?null:t.statusObj.lookupTextColor)),e.xp6(1),e.hij(" ",null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName," "),e.xp6(5),e.Q6J("ngIf",(null==t?null:t.returnPaymentMethodByCard)&&34004==(null==t?null:t.actionId)&&"Refunded"==(null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName)),e.xp6(1),e.s9C("href",null==t?null:t.approvalAttachment,e.LSH),e.xp6(1),e.Q6J("disabled",!(null!=t&&t.approvalAttachment)),e.xp6(2),e.Q6J("ngIf","refunded"!==(null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName.toLowerCase())&&"collected"!==(null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName.toLowerCase()))("ngIfElse",n)}}function ge(i,a){1&i&&(e.TgZ(0,"div",52),e._UZ(1,"app-not-found"),e.qZA())}function he(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"div",26)(2,"div",27)(3,"table",28)(4,"thead")(5,"tr")(6,"th",29)(7,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByOrderNo())}),e._uU(8," Order No. "),e._UZ(9,"i",31)(10,"i",32),e.qZA()(),e.TgZ(11,"th",29)(12,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByCustomerDetails())}),e._uU(13," Customer Details "),e._UZ(14,"i",31)(15,"i",32),e.qZA()(),e.TgZ(16,"th",29)(17,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByReturn())}),e._uU(18," Return By "),e._UZ(19,"i",31)(20,"i",32),e.qZA()(),e.TgZ(21,"th",29)(22,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByReturnDate())}),e._uU(23," Return Date "),e._UZ(24,"i",31)(25,"i",32),e.qZA()(),e.TgZ(26,"th",29)(27,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByRefund())}),e._uU(28," Refund/Collect Amount "),e._UZ(29,"i",31)(30,"i",32),e.qZA()(),e.TgZ(31,"th",29)(32,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.sortByStatus())}),e._uU(33," Status "),e._UZ(34,"i",31)(35,"i",32),e.qZA()(),e.TgZ(36,"th",29)(37,"button",33),e._uU(38," Approval "),e.qZA()(),e.TgZ(39,"th",29)(40,"button",33),e._uU(41," Action "),e.qZA()()()(),e.TgZ(42,"tbody"),e.YNc(43,_e,27,21,"tr",34),e.qZA()()(),e.YNc(44,ge,2,0,"div",35),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",2==t.sort),e.xp6(1),e.ekj("active",3==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",4==t.sort),e.xp6(1),e.ekj("active",5==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",6==t.sort),e.xp6(1),e.ekj("active",7==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",8==t.sort),e.xp6(1),e.ekj("active",9==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",10==t.sort),e.xp6(1),e.ekj("active",11==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(2),e.ekj("active",12==t.sort),e.xp6(1),e.ekj("active",13==t.sort),e.xp6(2),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(3),e.Q6J("disabled",0==(null==t.returnOrdersList?null:t.returnOrdersList.length)),e.xp6(3),e.Q6J("ngForOf",t.returnOrdersList),e.xp6(1),e.Q6J("ngIf",0==(null==t.returnOrdersList?null:t.returnOrdersList.length))}}function fe(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",53)(2,"h6",54),e._uU(3," Showing "),e.TgZ(4,"span"),e._uU(5),e.qZA(),e._uU(6," from "),e.TgZ(7,"span"),e._uU(8),e.qZA(),e._uU(9," data "),e.qZA()(),e.TgZ(10,"div",53)(11,"ngb-pagination",55),e.NdJ("pageChange",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.pageNo=r)})("pageChange",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.pageChange(r))}),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(5),e.AsE("",6*t.pageNo-5," - ",6==(null==t.returnOrdersList?null:t.returnOrdersList.length)?6*t.pageNo:t.totalRecords,""),e.xp6(3),e.hij(" ",t.totalRecords," "),e.xp6(3),e.Q6J("collectionSize",t.totalRecords)("page",t.pageNo)("maxSize",3)("pageSize",6)("rotate",!0)("ellipses",!1)}}function be(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"app-loading"),e.qZA())}const ve=function(){return{containerClass:"theme-red",isAnimated:!0,showClearButton:!0}};let Ze=(()=>{class i{constructor(t,n,r,s,o){this._collectService=t,this._commonService=n,this._datePipe=r,this._sharedService=s,this._modalService=o,this.returnStatus=y.Rr,this.searchOrderNo="",this.searchCustomerName="",this.dateObj={fromDate:"",toDate:""},this.dateFilter=null,this.returnType="",this.returnOrdersList=[],this.branches=[],this.users=[],this.branchId=null,this.userId=null,this.sort=1,this.pageNo=1,this.totalRecords=0,this.orderStatus=null,this.statusList=[]}ngOnInit(){this.getRegisterDetails(),this.getUsers(),this.getStausList()}onSelectFile(t,n){t.target.files&&t.target.files[0]&&this._commonService.fileToBase64(t.target.files[0]).then(r=>{const s=new FormData;s.append("ReturnOrderId",n?.sparePartsSalesOrderOpportunityNo),s.append("file",r.file||""),this._collectService.uploadCreditRefund(s).subscribe(o=>{o.isSuccess&&(this.successModal("success","Return receipt uploaded successfully!"),this.getSparePartsReturnOrders())},o=>{this.successModal("error",o.error.errors)})})}successModal(t,n){const r=this._modalService.open(_.i,{size:"md"});r.componentInstance.type=t,"success"==t?r.componentInstance.message=n:"error"==t&&(r.componentInstance.messageError=n)}filterByOrderStatus(t){t?(this.orderStatus=t?.value,this.pageNo=1,this.getSparePartsReturnOrders()):(this.pageNo=1,this.orderStatus=null,this.getSparePartsReturnOrders())}getStausList(){this._collectService.getLookupsById(10).subscribe(t=>{this.statusList=t.data.map(n=>({text:n?.name[0]?.lookupName,value:n?.id}))})}viewDetails(t,n){let r=t.target.tagName.toLowerCase(),o=t.target.id;if("button"!=r&&"elipse"!=t.target.id&&"uploadFile"!=o&&"returnReceipt"!=o){let p={branchId:this.branchId,searchCustomerName:this.searchCustomerName,searchOrderNo:this.searchOrderNo,userId:this.userId,orderStatus:this.orderStatus,dateFilter:this.dateFilter};localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),...p})),this._commonService.NavigateToRouteWithQueryString("/return/details",{queryParams:{id:n}})}}downloadInvoices(t){this._commonService.downloadInvoices({invoices:t})}getRegisterDetails(){this._collectService.GetRegisterDetails(this._sharedService.getRegister.registerObj?.id).subscribe(t=>{this.registerDetails=t.data,this.getBranches(3003)})}getBranches(t){this.branches=this.registerDetails.registerBranches.map(r=>({...r,branchType:r?.branchTypes[0]?.branchTypeId})).filter(r=>r.branchType==t),this.isRegisterBranch=this.registerDetails.branchId,this.branchId=this.registerDetails?.collectForOwnBranch?this.branches.findIndex(s=>s.branchId==this.isRegisterBranch)>=0?this.isRegisterBranch:null:this.branches[0].branchId;let n=JSON.parse(localStorage.getItem("returnParams"));n?.branchId&&(this.branchId=n.branchId,this.searchCustomerName=n.searchCustomerName,this.searchOrderNo=n.searchOrderNo,this.userId=n.userId,this.orderStatus=n.orderStatus,n?.dateFilter&&(this.dateFilter=[new Date(n?.dateFilter[0]),new Date(n?.dateFilter[1])])),null!==this.branchId&&this.getSparePartsReturnOrders()}getUsers(){let t;return 3003==this.data.branchTypeId?t=33:3002==this.data.branchTypeId&&(t=32),this._collectService.getUsers(t).subscribe(n=>{n&&(this.users=n.data)})}handleBranchChange(t){let n=t?.branchId;(null!==n||void 0!==n)&&(this.branchId=t?.branchId,this.pageNo=1,this.getSparePartsReturnOrders())}clearBranch(t){this.branchId=t?.branchId,this.returnOrdersList=[],this.totalRecords=0}filterByUserId(t){this.pageNo=1,this.userId=t?.userId,this.getSparePartsReturnOrders()}clearUser(){this.pageNo=1,this.getSparePartsReturnOrders()}handleSearchByOrderNo(t){this.pageNo=1,this.searchOrderNo=t?.target.value,this.getSparePartsReturnOrders()}clearSearchByOrderNo(){this.pageNo=1,this.searchOrderNo="",this.getSparePartsReturnOrders()}handleSearchByName(t){this.pageNo=1,this.searchCustomerName=t?.target.value,this.getSparePartsReturnOrders()}clearSearchByName(){this.pageNo=1,this.searchCustomerName="",this.getSparePartsReturnOrders()}handleSearchByDate(t){t&&(this.dateObj.fromDate=this._datePipe.transform(t[0],"yyyy-MM-dd"),this.dateObj.toDate=this._datePipe.transform(t[1],"yyyy-MM-dd")),this.pageNo=1,this.getSparePartsReturnOrders()}clearSearchByDate(){this.pageNo=1,this.dateObj={fromDate:"",toDate:""},this.dateFilter=null,this.getSparePartsReturnOrders()}getSparePartsReturnOrders(){let t=`status=${this.orderStatus||""}&customer=${this.searchCustomerName}&ReturnDateFrom=${this.dateObj?.fromDate}&ReturnDateTo=${this.dateObj?.toDate}&sort=${this.sort}&orderNo=${this.searchOrderNo}\n    &pageNo=${this.pageNo-1}&sort=${this.sort}&pageSize=6`;this.userId&&(t+=`&created=${this.userId}`),(+(0==this.branchId)||+this.branchId>0)&&(t+=`&branchId=${this.branchId}`),this._collectService.getSparePartsReturnOrders(t).subscribe(n=>{this.returnOrdersList=n?.data,this.totalRecords=n?.totalRecordCount})}returnAction(t,n){this.returnType=t.toLowerCase();let r=n?.actionObj[0]?.lookupName.toLowerCase();if("view"===r)this._modalService.open(b.z,{size:"lg"}).componentInstance.data={details:n,orderType:7003};else if("collect"===r)if(n?.grandAmount>0){const s=this._modalService.open(h.k,{modalDialogClass:"payment-modal-size"});s.componentInstance.detailsItem={...n,isFromReturn:!0},s.componentInstance.collectionType=7003,s.componentInstance.sendtoLoadData.subscribe(o=>{s.dismiss(),this.getSparePartsReturnOrders()})}else{const s=this._modalService.open(A,{size:"lg"});s.componentInstance.data={details:n},s.componentInstance.eventData.subscribe(o=>{o?.isSuccess&&(s.dismiss(),this.getSparePartsReturnOrders())})}else if("sign"===r){const s=this._modalService.open(v.X,{size:"lg"});s.componentInstance.data={details:n},s.componentInstance.eventData.subscribe(o=>{o?.isSuccess&&(s.dismiss(),this.getSparePartsReturnOrders())})}else if("refund"===r){const s=this._modalService.open(f,{size:"lg"});s.componentInstance.data={returnType:this.returnType,details:n,orderType:7003},s.componentInstance.eventData.subscribe(o=>{o?.isSuccess&&(s.dismiss(),this.getSparePartsReturnOrders())})}}pageChange(t){this.pageNo=t,this.getSparePartsReturnOrders()}sortByOrderNo(){this.sort=3==this.sort?1:2==this.sort?3:2,this.getSparePartsReturnOrders()}sortByCustomerDetails(){this.sort=5==this.sort?1:4==this.sort?5:4,this.getSparePartsReturnOrders()}sortByReturn(){this.sort=7==this.sort?1:6==this.sort?7:6,this.getSparePartsReturnOrders()}sortByReturnDate(){this.sort=9==this.sort?1:8==this.sort?9:8,this.getSparePartsReturnOrders()}sortByRefund(){this.sort=11==this.sort?1:10==this.sort?11:10,this.getSparePartsReturnOrders()}sortByStatus(){this.sort=13==this.sort?1:12==this.sort?13:12,this.getSparePartsReturnOrders()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.k),e.Y36(Z.v),e.Y36(l.uU),e.Y36(R.F),e.Y36(d.FF))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-spare-part-return"]],inputs:{data:"data"},decls:30,vars:20,consts:[[1,"row"],[1,"col-sm-3"],["placeholder","Search by branch","bindLabel","branchName","bindValue","branchId",3,"disabled","items","ngModel","ngModelChange","change","clear"],[4,"ngIf"],["class","font-14 primary-clr mb-2 d-inline-block",4,"ngIf"],[1,"input-group","mb-3","search-box"],["type","button",1,"btn"],[1,"fa-solid","fa-search"],["type","text","placeholder","Order no...",1,"form-control",3,"ngModel","ngModelChange","input"],["class","btn","type","button","id","button-addon4",3,"click",4,"ngIf"],["type","text","placeholder","Customer name...",1,"form-control",3,"ngModel","ngModelChange","input"],["placeholder","Returned by...","bindLabel","fullName","bindValue","userId",3,"items","ngModel","ngModelChange","change","clear"],[1,"col-sm-3","position-relative"],["class","fa-solid fa-times","style","position:absolute;top:15px;right:30px;cursor:pointer",3,"click",4,"ngIf"],["type","text","placeholder","Select Date","bsDaterangepicker","","placement","right",1,"form-control",2,"height","46px",3,"ngModel","bsConfig","ngModelChange","bsValueChange"],[1,"col-3","mb-3"],["placeholder","Status","bindLabel","text","bindValue","value",3,"items","ngModel","ngModelChange","change"],[1,"row","mt-3"],["class","col-md-12",4,"ngIf","ngIfElse"],[1,"col-md-12"],["loading",""],["ng-label-tmp",""],[1,"font-14","primary-clr","mb-2","d-inline-block"],["type","button","id","button-addon4",1,"btn",3,"click"],[1,"fa-solid","fa-xmark"],[1,"fa-solid","fa-times",2,"position","absolute","top","15px","right","30px","cursor","pointer",3,"click"],[1,"card-table","mt-2","register-sessions-table"],[1,"table-responsive"],[1,"table"],["scope","col"],[1,"btn",3,"disabled","click"],[1,"fa-solid","fa-arrow-up-long"],[1,"fa-solid","fa-arrow-down-long"],[1,"btn",3,"disabled"],["class","cursor-pointer",3,"click",4,"ngFor","ngForOf"],["class","not-found",4,"ngIf"],[1,"cursor-pointer",3,"click"],[1,"status-tag","d-block",3,"ngStyle"],["type","file","accept",".png,.jpg,.jpeg,.pdf","id","uploadFile","hidden","",1,"form-control",3,"change"],["fileUpload",""],[1,"d-flex","gap-2"],["placement","bottom","ngbTooltip","Upload Return Receipt","id","returnReceipt","class","fas fa-upload cursor-pointer primary-clr fa-2x",3,"click",4,"ngIf"],["target","_blank",3,"href"],["type","button",1,"redBtn",3,"disabled"],[4,"ngIf","ngIfElse"],["showElipse",""],["placement","bottom","ngbTooltip","Upload Return Receipt","id","returnReceipt",1,"fas","fa-upload","cursor-pointer","primary-clr","fa-2x",3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],["type","button","class","redBtn",3,"disabled","click",4,"ngSwitchDefault"],["type","button",1,"redBtn",3,"disabled","click"],["type","button",1,"redBtn",3,"click"],[1,"not-found"],[1,"col-md-6"],[1,"showing"],[3,"collectionSize","page","maxSize","pageSize","rotate","ellipses","pageChange"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ng-select",2),e.NdJ("ngModelChange",function(s){return n.branchId=s})("change",function(s){return n.handleBranchChange(s)})("clear",function(s){return n.clearBranch(s)}),e.YNc(3,re,2,0,"ng-container",3),e.qZA(),e.YNc(4,ie,2,0,"span",4),e.qZA(),e.TgZ(5,"div",1)(6,"div",5)(7,"button",6),e._UZ(8,"i",7),e.qZA(),e.TgZ(9,"input",8),e.NdJ("ngModelChange",function(s){return n.searchOrderNo=s})("input",function(s){return n.handleSearchByOrderNo(s)}),e.qZA(),e.YNc(10,se,2,0,"button",9),e.qZA()(),e.TgZ(11,"div",1)(12,"div",5)(13,"button",6),e._UZ(14,"i",7),e.qZA(),e.TgZ(15,"input",10),e.NdJ("ngModelChange",function(s){return n.searchCustomerName=s})("input",function(s){return n.handleSearchByName(s)}),e.qZA(),e.YNc(16,ae,2,0,"button",9),e.qZA()(),e.TgZ(17,"div",1)(18,"ng-select",11),e.NdJ("ngModelChange",function(s){return n.userId=s})("change",function(s){return n.filterByUserId(s)})("clear",function(){return n.clearUser()}),e.qZA()(),e.TgZ(19,"div",12),e.YNc(20,oe,1,0,"i",13),e.TgZ(21,"input",14),e.NdJ("ngModelChange",function(s){return n.dateFilter=s})("bsValueChange",function(s){return n.handleSearchByDate(s)}),e.qZA()(),e.TgZ(22,"div",15)(23,"ng-select",16),e.NdJ("ngModelChange",function(s){return n.orderStatus=s})("change",function(s){return n.filterByOrderStatus(s)}),e.qZA()()(),e.TgZ(24,"div",17),e.YNc(25,he,45,34,"div",18),e.YNc(26,fe,12,9,"ng-container",3),e.TgZ(27,"div",19),e.YNc(28,be,2,0,"ng-template",null,20,e.W1O),e.qZA()()),2&t){const r=e.MAs(29);e.xp6(2),e.Q6J("disabled",null==n.registerDetails?null:n.registerDetails.collectForOwnBranch)("items",n.branches)("ngModel",n.branchId),e.xp6(1),e.Q6J("ngIf",(null==n.registerDetails?null:n.registerDetails.branchId)==n.branchId),e.xp6(1),e.Q6J("ngIf",n.branchId<0),e.xp6(5),e.Q6J("ngModel",n.searchOrderNo),e.xp6(1),e.Q6J("ngIf",n.searchOrderNo),e.xp6(5),e.Q6J("ngModel",n.searchCustomerName),e.xp6(1),e.Q6J("ngIf",n.searchCustomerName),e.xp6(2),e.Q6J("items",n.users)("ngModel",n.userId),e.xp6(2),e.Q6J("ngIf",n.dateFilter),e.xp6(1),e.Q6J("ngModel",n.dateFilter)("bsConfig",e.DdM(19,ve)),e.xp6(2),e.Q6J("items",n.statusList)("ngModel",n.orderStatus),e.xp6(2),e.Q6J("ngIf",n.returnOrdersList)("ngIfElse",r),e.xp6(1),e.Q6J("ngIf",n.totalRecords>6)}},dependencies:[l.sg,l.O5,l.PC,l.RF,l.n9,l.ED,T.FR,T.TB,u.Fj,u.JJ,u.On,C.w9,C.mR,d.N9,d._L,S.N,D.w,l.JJ,l.uU],styles:[".redBtn[_ngcontent-%COMP%]{min-width:100px}.form-check-input[_ngcontent-%COMP%]{width:20px!important;height:20px;margin:0;padding:0}.form-check-input[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{line-height:1;font-weight:500;padding:0;margin:0 0 0 5px}"]}),i})();var Te=c(78372),Ce=c(71884),Se=c(49973),Oe=c(85746);function Re(i,a){1&i&&e._uU(0),2&i&&e.hij(" ","Own Branch - "+a.item.branchName," ")}function xe(i,a){1&i&&(e.ynx(0),e.YNc(1,Re,1,1,"ng-template",20),e.BQk())}function ye(i,a){1&i&&(e.TgZ(0,"span",21),e._uU(1,"Branch is required"),e.qZA())}function Ae(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.f.get("orderNo").setValue(""))}),e._UZ(1,"i",23),e.qZA()}}function Ne(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.f.get("customer").setValue(""))}),e._UZ(1,"i",23),e.qZA()}}function Ie(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"i",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.f.get("date").setValue(""))}),e.qZA()}}function De(i,a){1&i&&(e.TgZ(0,"span"),e._uU(1,"---"),e.qZA())}function Ue(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2).row,s=e.oxw();return e.KtG(s.returnAction(null==r?null:r.returnOrderType,r))}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw(2).row;e.Q6J("disabled","Treasury"==(null==t?null:t.sentTo)),e.xp6(1),e.hij(" ",null==t||null==t.actionObj[0]?null:t.actionObj[0].lookupName," ")}}function qe(i,a){if(1&i&&(e.ynx(0)(1,27),e.YNc(2,De,2,0,"span",28),e.YNc(3,Ue,2,2,"button",29),e.BQk()()),2&i){const t=e.oxw().row;e.xp6(1),e.Q6J("ngSwitch",null==t?null:t.status),e.xp6(1),e.Q6J("ngSwitchCase",10010)}}function ke(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().row,s=e.oxw();return e.KtG(s.returnAction("view",r))}),e._uU(1,"View"),e.qZA()}}function Pe(i,a){if(1&i&&(e.YNc(0,qe,4,2,"ng-container",25),e.YNc(1,ke,2,0,"ng-template",null,26,e.W1O)),2&i){const t=a.row,n=e.MAs(2);e.Q6J("ngIf","refunded"!==(null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName.toLowerCase())&&"collected"!==(null==t||null==t.statusObj[0]?null:t.statusObj[0].lookupName.toLowerCase()))("ngIfElse",n)}}const we=function(){return{containerClass:"theme-red",isAnimated:!0,showClearButton:!0}};let Je=(()=>{class i{constructor(t,n,r,s,o,p){this._collectService=t,this._commonService=n,this._sharedService=r,this.fb=s,this._datePipe=o,this._modalService=p,this.pageNo=1,this.total=0,this.limit=6,this.loading=!1,this.tableConfig={paging:!0,filter:{Sort:1,PageSize:this.limit}},this.tableColumns=[],this.returnStatus=y.Rr,this.returnType="",this.dateFilter=null,this.returnOrdersList=[],this.branches=[],this.users=[],this.orderStatus=null,this.statusList=[]}ngOnInit(){this.getRegisterDetails(),this.getUsers(),this.getStausList(),this.initFilterParams(),this.initTableColumns()}initFilterParams(){this.filterForm=this.fb.group({branchId:[null],customer:[""],created:[null],orderNo:[""],sentTo:[""],date:[""],status:[null]});let t=JSON.parse(localStorage.getItem("returnParams"));if(t?.branchId){if(t?.date){let n=[new Date(t?.date[0]),new Date(t?.date[1])];t={...t,date:n}}this.filterForm.patchValue(t)}this.filterForm.valueChanges.pipe((0,Te.b)(500),(0,Ce.x)()).subscribe(n=>{this.pageNo=1;let s,r={returnDateFrom:"",returnDateTo:""};n.date&&(r.returnDateFrom=this._datePipe.transform(n.date[0],"yyyy-MM-dd"),r.returnDateTo=this._datePipe.transform(n.date[1],"yyyy-MM-dd")),s={...n,...r},delete s.date,null==s.branchId&&(s={...s,branchId:""}),null==s.status&&(s={...s,status:""}),null==s.created&&(s={...s,created:""}),this.filterParams="?"+new URLSearchParams(s).toString(),this.getDpReturnOrders()})}getDpReturnOrders(){let n,t=`pageSize=${this.tableConfig.filter.PageSize}&pageNo=${this.pageNo-1}&sort=${this.tableConfig.filter.Sort}`;n=this.filterParams?`${this.filterParams}&${t}`:`?${t}`,this._collectService.getDpReturnOrders(n).subscribe(r=>{this.returnOrdersList=r?.data,this.total=r?.totalRecordCount})}getStausList(){this._collectService.getLookupsById(10).subscribe(t=>{this.statusList=t.data.map(n=>({text:n?.name[0]?.lookupName,value:n?.id}))})}eventData(t){if(t.isTableRowClicked){if("orderAction"===t.eventData.target.id)return;{let r={...this.filterForm.value};localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),...r})),this._commonService.NavigateToRoute(`/return/dpayment-details/${t?.item?.directPaymentSalesOrderOpportunityNo}`)}}}downloadInvoices(t){this._commonService.downloadInvoices({invoices:t})}getRegisterDetails(){this._collectService.GetRegisterDetails(this._sharedService.getRegister.registerObj?.id).subscribe(t=>{this.registerDetails=t.data,this.registerDetails?.collectForOwnBranch&&this.f.get("branchId").disable(),this.getBranches(3001)})}get f(){return this.filterForm}getBranches(t){this.branches=this.registerDetails.registerBranches.map(n=>({...n,branchType:n?.branchTypes[0]?.branchTypeId})).filter(n=>n.branchType==t),this.isRegisterBranch=this.registerDetails.branchId,this.registerDetails?.collectForOwnBranch?this.branches.findIndex(r=>r.branchId==this.isRegisterBranch)>=0?this.filterForm.get("branchId").setValue(this.isRegisterBranch):this.filterForm.get("branchId").setValue(null):this.filterForm.get("branchId").setValue(this.branches[0].branchId)}getUsers(){return this._collectService.getUsers(3).subscribe(n=>{n&&(this.users=n.data)})}returnAction(t,n){let r=n?.actionObj[0]?.lookupName.toLowerCase();if("view"===r)this._modalService.open(b.z,{size:"lg"}).componentInstance.data={details:n,orderType:7002};else if("collect"===r){const s=this._modalService.open(h.k,{modalDialogClass:"payment-modal-size"});s.componentInstance.detailsItem={...n,isFromReturn:!0},s.componentInstance.collectionType=7002,s.componentInstance.sendtoLoadData.subscribe(o=>{s.dismiss(),this.getDpReturnOrders()})}else if("sign"===r){const s=this._modalService.open(v.X,{size:"lg"});s.componentInstance.data={details:n,orderType:7002},s.componentInstance.eventData.subscribe(o=>{o?.isSuccess&&(s.dismiss(),this.getDpReturnOrders())})}else if("refund"===r){const s=this._modalService.open(f,{size:"lg"});s.componentInstance.data={returnType:this.returnType,details:n,orderType:7002},s.componentInstance.eventData.subscribe(o=>{o?.isSuccess&&(s.dismiss(),this.getDpReturnOrders())})}}onSortChange(t){if(t?.direction&&t?.column)switch(t.column){case"directPaymentSalesOrderOpportunityNo":this.tableConfig.filter.Sort="desc"===t.direction?3:2;break;case"customer.customerName":this.tableConfig.filter.Sort="desc"===t.direction?5:4;break;case"returnedBy.fullName":this.tableConfig.filter.Sort="desc"===t.direction?7:6;break;case"returnAt":this.tableConfig.filter.Sort="desc"===t.direction?9:8;break;case"grandAmount":this.tableConfig.filter.Sort="desc"===t.direction?11:10;break;case"statusObj[0].lookupName":this.tableConfig.filter.Sort="desc"===t.direction?13:12}else this.tableConfig.filter.Sort=1;this.getDpReturnOrders()}onPageChange(t){this.pageNo=t,this.getDpReturnOrders()}initTableColumns(){this.tableColumns=[{key:"directPaymentSalesOrderOpportunityNo",label:"Order No",canSort:!0},{key:"customer.customerName",label:"Customer Details",canSort:!0},{key:"returnedBy.fullName",label:"Return By",canSort:!0},{key:"returnAt",label:"Return Date",canSort:!0,dateFormat:"mediumDate"},{key:"grandAmount",label:"Refund/Collect Amount",canSort:!0,currency:{decimalFormat:"2.3-3",appendText:" JOD"}},{key:"statusObj[0].lookupName",label:"Status",canSort:!0},{key:"action",label:"Action"}]}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.k),e.Y36(Z.v),e.Y36(R.F),e.Y36(u.qu),e.Y36(l.uU),e.Y36(d.FF))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-direct-payment-return"]],inputs:{data:"data"},decls:27,vars:18,consts:[[3,"formGroup"],[1,"row"],[1,"col-sm-3"],["placeholder","Search by branch","bindLabel","branchName","bindValue","branchId","formControlName","branchId",3,"items"],[4,"ngIf"],["class","font-14 primary-clr mb-2 d-inline-block",4,"ngIf"],[1,"input-group","mb-3","search-box"],["type","button",1,"btn"],[1,"fa-solid","fa-search"],["type","text","placeholder","Order no...","formControlName","orderNo",1,"form-control"],["class","btn","type","button",3,"click",4,"ngIf"],["type","text","placeholder","Customer name...","formControlName","customer",1,"form-control"],["placeholder","Return by...","bindLabel","fullName","bindValue","userId","formControlName","created",3,"items"],[1,"col-sm-3","position-relative"],["class","fa-solid fa-times","style","position:absolute;top:15px;right:30px;cursor:pointer",3,"click",4,"ngIf"],["type","text","formControlName","date","placeholder","Select Date","bsDaterangepicker","","placement","right",1,"form-control",2,"height","46px",3,"bsConfig"],[1,"col-3","mb-3"],["placeholder","Status","bindLabel","text","bindValue","value","formControlName","status",3,"items"],[3,"config","columns","data","loading","page","total","limit","eventData","sortUpdated","pageUpdated"],["libTableAdvancedColumn","action"],["ng-label-tmp",""],[1,"font-14","primary-clr","mb-2","d-inline-block"],["type","button",1,"btn",3,"click"],[1,"fa-solid","fa-xmark"],[1,"fa-solid","fa-times",2,"position","absolute","top","15px","right","30px","cursor","pointer",3,"click"],[4,"ngIf","ngIfElse"],["showElipse",""],[3,"ngSwitch"],[4,"ngSwitchCase"],["type","button","class","redBtn",3,"disabled","click",4,"ngSwitchDefault"],["type","button",1,"redBtn",3,"disabled","click"],["type","button","id","orderAction",1,"redBtn",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"ng-select",3),e.YNc(4,xe,2,0,"ng-container",4),e.qZA(),e.YNc(5,ye,2,0,"span",5),e.qZA(),e.TgZ(6,"div",2)(7,"div",6)(8,"button",7),e._UZ(9,"i",8),e.qZA(),e._UZ(10,"input",9),e.YNc(11,Ae,2,0,"button",10),e.qZA()(),e.TgZ(12,"div",2)(13,"div",6)(14,"button",7),e._UZ(15,"i",8),e.qZA(),e._UZ(16,"input",11),e.YNc(17,Ne,2,0,"button",10),e.qZA()(),e.TgZ(18,"div",2),e._UZ(19,"ng-select",12),e.qZA(),e.TgZ(20,"div",13),e.YNc(21,Ie,1,0,"i",14),e._UZ(22,"input",15),e.qZA(),e.TgZ(23,"div",16),e._UZ(24,"ng-select",17),e.qZA()()(),e.TgZ(25,"table-advanced",18),e.NdJ("eventData",function(s){return n.eventData(s)})("sortUpdated",function(s){return n.onSortChange(s)})("pageUpdated",function(s){return n.onPageChange(s)}),e.YNc(26,Pe,3,2,"ng-template",19),e.qZA()),2&t&&(e.Q6J("formGroup",n.filterForm),e.xp6(3),e.Q6J("items",n.branches),e.xp6(1),e.Q6J("ngIf",(null==n.registerDetails?null:n.registerDetails.branchId)==+n.f.get("branchId").value),e.xp6(1),e.Q6J("ngIf",+n.f.get("branchId").value<0),e.xp6(6),e.Q6J("ngIf",n.f.get("orderNo").value),e.xp6(6),e.Q6J("ngIf",n.f.get("customer").value),e.xp6(2),e.Q6J("items",n.users),e.xp6(2),e.Q6J("ngIf",n.f.get("date").value),e.xp6(1),e.Q6J("bsConfig",e.DdM(17,we)),e.xp6(2),e.Q6J("items",n.statusList),e.xp6(1),e.Q6J("config",n.tableConfig)("columns",n.tableColumns)("data",n.returnOrdersList)("loading",n.loading)("page",n.pageNo)("total",n.total)("limit",n.limit))},dependencies:[l.O5,l.RF,l.n9,l.ED,T.FR,T.TB,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,C.w9,C.mR,Se.V,Oe.y]}),i})();function Me(i,a){if(1&i&&e._UZ(0,"app-return-services",8),2&i){const t=e.oxw();e.Q6J("data",t.data)}}function je(i,a){if(1&i&&e._UZ(0,"app-direct-payment-return",8),2&i){const t=e.oxw();e.Q6J("data",t.data)}}function Fe(i,a){if(1&i&&e._UZ(0,"app-spare-part-return",8),2&i){const t=e.oxw();e.Q6J("data",t.data)}}let Be=(()=>{class i{constructor(t){this.router=t}ngOnInit(){this.data={branchTypeId:3002};let t=JSON.parse(localStorage.getItem("returnParams"))?.tab;t>=0&&(this.tabSet.tabs[t].active=!0,localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),tab:t})))}handleTabSelection(t,n,r){localStorage.removeItem("returnParams"),this.data={branchTypeId:n},localStorage.setItem("returnParams",JSON.stringify({...JSON.parse(localStorage.getItem("returnParams")),tab:r}))}ngOnDestroy(){let t=this.router.url;!t.includes("/return/details")&&!t.includes("/return/services-details")&&!t.includes("/return/dpayment-details")&&localStorage.removeItem("returnParams")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-return"]],viewQuery:function(t,n){if(1&t&&e.Gf(x.AH,7),2&t){let r;e.iGM(r=e.CRH())&&(n.tabSet=r.first)}},decls:10,vars:3,consts:[["type","pills"],["heading","Services Return Orders",3,"selectTab"],["tabA","tab"],[3,"data",4,"ngIf"],["heading","Direct Payment Return Orders",3,"selectTab"],["tabC","tab"],["heading","Spare Parts Return Orders",3,"selectTab"],["tabB","tab"],[3,"data"]],template:function(t,n){if(1&t&&(e.TgZ(0,"tabset",0)(1,"tab",1,2),e.NdJ("selectTab",function(s){return n.handleTabSelection(s,3001,0)}),e.YNc(3,Me,1,1,"app-return-services",3),e.qZA(),e.TgZ(4,"tab",4,5),e.NdJ("selectTab",function(s){return n.handleTabSelection(s,3002,1)}),e.YNc(6,je,1,1,"app-direct-payment-return",3),e.qZA(),e.TgZ(7,"tab",6,7),e.NdJ("selectTab",function(s){return n.handleTabSelection(s,3003,2)}),e.YNc(9,Fe,1,1,"app-spare-part-return",3),e.qZA()()),2&t){const r=e.MAs(2),s=e.MAs(5),o=e.MAs(8);e.xp6(3),e.Q6J("ngIf",r.active),e.xp6(3),e.Q6J("ngIf",s.active),e.xp6(3),e.Q6J("ngIf",o.active)}},dependencies:[l.O5,x.wW,x.AH,ee,Ze,Je],styles:["[_nghost-%COMP%]     .nav-pills{margin-bottom:30px}[_nghost-%COMP%]     .nav-pills .nav-link{font-size:16px;font-weight:700;color:#1b212d;border-radius:0}[_nghost-%COMP%]     .nav-pills .nav-link.active{background:none;color:#1b212d;border-bottom:2px solid var(--primary)}"]}),i})();function Le(i,a){1&i&&(e.TgZ(0,"span",13),e._uU(1,"Input is required"),e.qZA())}function Qe(i,a){if(1&i&&(e.ynx(0),e.YNc(1,Le,2,0,"span",12),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.reasonDetails||null==t.reasonDetails.errors?null:t.reasonDetails.errors.required)}}function Ye(i,a){if(1&i&&(e.ynx(0),e.YNc(1,Qe,2,1,"ng-container",7),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==t.reasonDetails?null:t.reasonDetails.invalid)&&(null==t.reasonDetails?null:t.reasonDetails.touched)||(null==t.reasonDetails?null:t.reasonDetails.dirty))}}let N=(()=>{class i{constructor(t,n,r){this._activeModal=t,this._modalService=n,this._collectService=r,this.eventData=new e.vpe,this.reasonDetails=new u.NI("",[u.kI.required])}ngOnInit(){console.log(this.data)}save(){if(this.reasonDetails.invalid)return void this.reasonDetails.markAsTouched();const t=new FormData;let n;t.append("Reason",this.reasonDetails.value),7003==this.data.collectionType?(t.append("OrderId",this.data.sparePartsSalesOrderOpportunityNo),n=this._collectService.rejectSparePartsReturnOrder(t)):7002==this.data.collectionType?(t.append("OrderId",this.data?.order?.directPaymentSalesOrderOpportunityNo),n=this._collectService.rejectDpReturnOrder(t)):(t.append("OrderId",this.data?.order?.servicesSalesOrderNo),n=this._collectService.rejectServicesReturnOrder(t)),n.subscribe({next:r=>{r.isSuccess&&(this.responseModal("success","Action done successfully!"),this.eventData.emit(!0))},error:r=>{this.responseModal("error",r?.error.errors||r?.error.Errors)}})}responseModal(t,n){const r=this._modalService.open(_.i);"success"==t&&(r.componentInstance.message=n),r.componentInstance.messageError=n,r.componentInstance.type=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.Kz),e.Y36(d.FF),e.Y36(m.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-reject-refund"]],inputs:{data:"data"},outputs:{eventData:"eventData"},decls:16,vars:2,consts:[[1,"modal-header"],[1,"modal-title","fw-600"],[1,"modal-body"],[1,"row"],[1,"col-12"],[1,"input-label","font-13"],["rows","2",1,"form-control","h-100",3,"formControl"],[4,"ngIf"],[1,"modal-footer","border-0","mt-3"],[1,"btns-group","px-0","mx-0"],["type","button",1,"btn","btn-save",3,"click"],["type","button",1,"btn","btn-cancel",3,"click"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2,"Reject Refund"),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"label",5),e._uU(7,"Reason Details"),e.qZA(),e._UZ(8,"textarea",6),e.YNc(9,Ye,2,1,"ng-container",7),e.qZA()()(),e.TgZ(10,"div",8)(11,"div",9)(12,"button",10),e.NdJ("click",function(){return n.save()}),e._uU(13,"Reject Refund"),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){return n._activeModal.close()}),e._uU(15,"Cancel"),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("formControl",n.reasonDetails),e.xp6(1),e.Q6J("ngIf",null==n.reasonDetails?null:n.reasonDetails.errors))},dependencies:[l.O5,u.Fj,u.JJ,u.oH]}),i})();var Ee=c(98988),Ge=c(68866),ze=c(33980);function He(i,a){if(1&i&&(e.TgZ(0,"p",33),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t," ")}}function $e(i,a){if(1&i&&(e.ynx(0),e.YNc(1,He,2,1,"p",32),e.ALo(2,"slice"),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,1,t.details.order.workingCards,0,1))}}function Ke(i,a){if(1&i&&(e.TgZ(0,"div",34)(1,"label"),e._uU(2," Reject Refund Reason "),e.qZA(),e.TgZ(3,"textarea",35),e._uU(4),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(4),e.Oqu(null==t.details?null:t.details.rejectReturnReason)}}function Ve(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.rejectRefund())}),e._uU(1,"Reject Refund"),e.qZA()}}function Xe(i,a){1&i&&e.GkF(0)}function We(i,a){1&i&&e.GkF(0)}function et(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",38),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.returnAction(r.details))}),e._uU(2),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("disabled","Treasury"==(null==t.returnedOrder?null:t.returnedOrder.sentTo)),e.xp6(1),e.hij(" ",(null==t.details?null:t.details.actionObj)&&(null==t.details||null==t.details.actionObj[0]?null:t.details.actionObj[0].lookupName)," ")}}function tt(i,a){if(1&i&&(e.ynx(0),e.YNc(1,et,3,2,"ng-container",37),e.BQk()),2&i){e.oxw();const t=e.MAs(116),n=e.oxw();e.xp6(1),e.Q6J("ngIf","refunded"!==n.orderStatus&&"collected"!==n.orderStatus)("ngIfElse",t)}}function nt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getInvoice())}),e._uU(1,"View Invoice"),e.qZA()}}function rt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"div",5)(3,"p"),e._uU(4," Date "),e.TgZ(5,"span"),e._uU(6),e.ALo(7,"date"),e.qZA(),e._uU(8," \xa0 Time "),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"date"),e.qZA()(),e.TgZ(12,"div",6)(13,"p"),e._uU(14,"Status : "),e.TgZ(15,"span"),e._uU(16),e.qZA()(),e.TgZ(17,"p"),e._uU(18,"Invoice No : "),e.TgZ(19,"span"),e._uU(20),e.qZA()()()()(),e.TgZ(21,"div",7)(22,"div",8)(23,"h3"),e._uU(24," Customer Details "),e.qZA(),e.TgZ(25,"div",9)(26,"div",10),e._uU(27),e.qZA(),e.TgZ(28,"div")(29,"div",11)(30,"h4",12),e._uU(31,"ID: "),e.TgZ(32,"p",13),e._uU(33),e.qZA()()(),e.TgZ(34,"div",11)(35,"h4"),e._uU(36,"Customer Name"),e.qZA(),e.TgZ(37,"p"),e._uU(38),e.qZA()(),e.TgZ(39,"div",11)(40,"h4"),e._uU(41,"Mobile"),e.qZA(),e.TgZ(42,"p"),e._uU(43),e.qZA()()()()()(),e.TgZ(44,"div",14)(45,"div",15)(46,"h3",16),e._uU(47," Vehicle Details "),e.qZA(),e.TgZ(48,"div",2)(49,"div",17)(50,"div",2)(51,"div",18)(52,"div",11)(53,"h4"),e._uU(54," Brand "),e.qZA(),e.TgZ(55,"p"),e._uU(56),e.qZA()()(),e.TgZ(57,"div",18)(58,"div",11)(59,"h4"),e._uU(60," Vehicle Model"),e.qZA(),e.TgZ(61,"p"),e._uU(62),e.qZA()()(),e.TgZ(63,"div",18)(64,"div",11)(65,"h4"),e._uU(66," Card No "),e.qZA(),e.YNc(67,$e,3,5,"ng-container",19),e.qZA()()(),e._UZ(68,"hr",20),e.TgZ(69,"div",2)(70,"div",18)(71,"div",11)(72,"h4"),e._uU(73,"Vin No"),e.qZA(),e.TgZ(74,"p"),e._uU(75),e.qZA()()(),e.TgZ(76,"div",18)(77,"div",11)(78,"h4"),e._uU(79,"Plate No. "),e.qZA(),e.TgZ(80,"p"),e._uU(81),e.qZA()()()()(),e.TgZ(82,"div",21)(83,"div",11)(84,"h4"),e._uU(85," Service Advisor"),e.qZA(),e.TgZ(86,"p"),e._uU(87),e.qZA()(),e.TgZ(88,"div",11)(89,"h4"),e._uU(90," Sales order No "),e.qZA(),e.TgZ(91,"p"),e._uU(92),e.qZA()()()()()(),e.TgZ(93,"div",3),e._UZ(94,"app-spare"),e.qZA(),e.TgZ(95,"div",3),e._UZ(96,"app-labor"),e.qZA(),e.TgZ(97,"div",3),e._UZ(98,"app-sublet"),e.qZA(),e.TgZ(99,"div",3)(100,"div",15)(101,"div",2)(102,"div",7)(103,"div",22)(104,"label"),e._uU(105," Sales note "),e.qZA(),e._UZ(106,"textarea",23),e.qZA(),e.YNc(107,Ke,5,1,"div",24),e.qZA()()()(),e.TgZ(108,"div",3)(109,"div",25),e.YNc(110,Ve,2,0,"button",26),e.ynx(111,27),e.YNc(112,Xe,1,0,"ng-container",28),e.YNc(113,We,1,0,"ng-container",28),e.YNc(114,tt,2,2,"ng-container",29),e.BQk(),e.YNc(115,nt,2,0,"ng-template",null,30,e.W1O),e.TgZ(117,"button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.goBack())}),e._uU(118,"Cancel"),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.hij(" ",e.xi3(7,21,null==t.details||null==t.details.order?null:t.details.order.orderDate," d MMM y ")," "),e.xp6(4),e.hij(" ",e.xi3(11,24,null==t.details||null==t.details.order?null:t.details.order.orderDate," h:mm a ")," "),e.xp6(6),e.hij("",null==t.details||null==t.details.order||null==t.details.order.status[0]?null:t.details.order.status[0].statusName," "),e.xp6(4),e.hij("",(null==t.details?null:t.details.invoicNo)||(null==t.details||null==t.details.order?null:t.details.order.invoiceNo)," "),e.xp6(7),e.hij(" ",t.customerName," "),e.xp6(6),e.hij(" ",null==t.details||null==t.details.customer?null:t.details.customer.customerId," "),e.xp6(5),e.hij(" ",null==t.details||null==t.details.customer?null:t.details.customer.customerName," "),e.xp6(5),e.hij(" ",null==t.details||null==t.details.customer?null:t.details.customer.mobile," "),e.xp6(13),e.hij(" ",null==t.details||null==t.details.vin?null:t.details.vin.brandName," "),e.xp6(6),e.Oqu(null==t.details||null==t.details.vin?null:t.details.vin.modelName),e.xp6(5),e.Q6J("ngIf",null==t.details.order.workingCards?null:t.details.order.workingCards.length),e.xp6(8),e.hij(" ",null==t.details||null==t.details.vin?null:t.details.vin.vinNo,""),e.xp6(6),e.hij(" ",null==t.details||null==t.details.vin?null:t.details.vin.plateNumber,""),e.xp6(6),e.hij(" ",null==t.details||null==t.details.serviceAdvisor?null:t.details.serviceAdvisor.serviceAdvisorName,""),e.xp6(5),e.hij(" ",null==t.details||null==t.details.order?null:t.details.order.servicesSalesOrderNo,""),e.xp6(14),e.Q6J("value",t.details.order.salesNote),e.xp6(1),e.Q6J("ngIf","Rejected Return"==t.orderStatus),e.xp6(3),e.Q6J("ngIf","refunding"==t.orderStatus),e.xp6(1),e.Q6J("ngSwitch",null==t.details||null==t.details.statusObj[0]?null:t.details.statusObj[0].statusId),e.xp6(1),e.Q6J("ngSwitchCase",10006),e.xp6(1),e.Q6J("ngSwitchCase",10010)}}function it(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"app-loading"),e.qZA())}let st=(()=>{class i{constructor(t,n,r,s,o){this._collectService=t,this._commonService=n,this._activatedRoute=r,this._modalService=s,this._location=o,this.customerName="",this.orderStatus=""}ngOnInit(){this.returnedOrder=JSON.parse(localStorage.getItem("returnOrder")),this._activatedRoute.params.subscribe(t=>{this.orderId=t.id,this.getServicesSalesOrderDetails(this.orderId)})}ngOnDestroy(){localStorage.removeItem("returnOrder")}goBack(){this._location.back()}getServicesSalesOrderDetails(t){this._collectService.GetServicesSalesOrderDetails(t).subscribe(n=>{if(n){this.details=n.data,console.log(this.details),this.orderStatus=this.details?.statusObj&&(this.details?.statusObj[0]?.statusName||this.details?.statusObj[0]?.lookupName).trim().toLowerCase();const r=this.details.customer.customerName.split(" ");let o=r[1];this.customerName=`${r[0]?.charAt(0)} ${o?o?.charAt(0):""}`}})}rejectRefund(){const t=this._modalService.open(N,{size:"md"});t.componentInstance.data={...this.details,collectionType:7001},t.componentInstance.eventData.subscribe(n=>{n&&this.getServicesSalesOrderDetails(this.orderId)})}getInvoice(){const t=new FormData;t.append("returnOrderNo",this.orderId),this._collectService.viewServiceLayerReturnOrderOrigionalInvoice(t).subscribe({next:n=>{n.isSuccess&&this._commonService.downloadURI(n.data)},error:n=>{this.responseModal("error",n?.error.errors||n?.error.Errors)}})}responseModal(t,n){const r=this._modalService.open(_.i);"success"==t&&(r.componentInstance.message=n),r.componentInstance.messageError=n,r.componentInstance.type=t}returnAction(t){let n=(t={...t,grandAmount:t?.order?.grandAmount,servicesSalesOrderNo:t?.order?.servicesSalesOrderNo})?.actionObj[0]?.lookupName.toLowerCase();if("view"===n)this._modalService.open(b.z,{size:"lg"}).componentInstance.data={details:t,orderType:7001};else if("collect"===n)if(t?.grandAmount>0){const r=this._modalService.open(h.k,{modalDialogClass:"payment-modal-size"});r.componentInstance.detailsItem={...t,isFromReturn:!0},r.componentInstance.collectionType=7003,r.componentInstance.sendtoLoadData.subscribe(s=>{r.dismiss(),this.getServicesSalesOrderDetails(this.orderId)})}else{const r=this._modalService.open(A,{size:"lg"});r.componentInstance.data={details:t},r.componentInstance.eventData.subscribe(s=>{s?.isSuccess&&(r.dismiss(),this.getServicesSalesOrderDetails(this.orderId))})}else if("sign"===n){const r=this._modalService.open(v.X,{size:"lg"});r.componentInstance.data={details:t,orderType:7001},r.componentInstance.eventData.subscribe(s=>{s?.isSuccess&&(r.dismiss(),this.getServicesSalesOrderDetails(this.orderId))})}else if("refund"===n){const r=this._modalService.open(f,{size:"lg"});r.componentInstance.data={details:t,orderType:7001},r.componentInstance.eventData.subscribe(s=>{s?.isSuccess&&(r.dismiss(),this.getServicesSalesOrderDetails(this.orderId))})}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.k),e.Y36(Z.v),e.Y36(g.gz),e.Y36(d.FF),e.Y36(l.Ye))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-services-details"]],decls:7,vars:2,consts:[[1,"card-page"],["class","row",4,"ngIf","ngIfElse"],[1,"row"],[1,"col-md-12"],["loading",""],[1,"top-details"],[1,"d-flex","gap-2"],[1,"col-md-4"],[1,"card-collect","customerDetail"],[1,"collect-details"],[1,"char"],[1,"card-sm"],[1,"d-flex","align-items-center"],[1,"m-0"],[1,"col-md-8"],[1,"card-collect"],[2,"margin-bottom","20px"],[1,"col-md-9"],[1,"col-sm-4"],[4,"ngIf"],[1,"v-line"],[1,"col-sm-3","l-line"],[1,"form-group"],["rows","3","disabled","",1,"form-control",3,"value"],["class","form-group mt-3",4,"ngIf"],[1,"btns-group","px-0","mx-0"],["type","button","class","btn btn-save",3,"click",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["otherActions",""],["type","button",1,"btn","btn-cancel",3,"click"],["class","mb-1",4,"ngFor","ngForOf"],[1,"mb-1"],[1,"form-group","mt-3"],["rows","3","disabled","",1,"form-control"],["type","button",1,"btn","btn-save",3,"click"],[4,"ngIf","ngIfElse"],["type","button",1,"btn","btn-save",3,"disabled","click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,rt,119,27,"div",1),e.TgZ(2,"div",2)(3,"div",3)(4,"div"),e.YNc(5,it,2,0,"ng-template",null,4,e.W1O),e.qZA()()()()),2&t){const r=e.MAs(6);e.xp6(1),e.Q6J("ngIf",n.details)("ngIfElse",r)}},dependencies:[l.sg,l.O5,l.RF,l.n9,l.ED,S.N,Ee.A,Ge._,ze.r,l.OU,l.uU]}),i})();function at(i,a){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"number"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"number"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.ALo(19,"number"),e.qZA(),e.TgZ(20,"td"),e._uU(21),e.ALo(22,"number"),e.qZA(),e.TgZ(23,"td"),e._uU(24),e.ALo(25,"number"),e.qZA(),e.TgZ(26,"td"),e._uU(27),e.qZA(),e.TgZ(28,"td"),e._uU(29),e.ALo(30,"number"),e.qZA(),e.TgZ(31,"td"),e._uU(32),e.ALo(33,"number"),e.qZA()()),2&i){const t=a.$implicit;e.xp6(2),e.hij(" ",null!=t&&t.partNo?t.partNo:"No data"," "),e.xp6(2),e.hij(" ",null!=t&&t.description?t.description:"No data"," "),e.xp6(2),e.hij(" ",null!=t&&t.qty?t.qty:"No data",""),e.xp6(2),e.hij(" ",null==t||null==t.unitOfMeasure[0]?null:t.unitOfMeasure[0].lookupName,""),e.xp6(2),e.hij(" ",e.xi3(11,13,null==t?null:t.unitPrice,"2.3-3")," JOD "),e.xp6(3),e.hij(" ",e.xi3(14,16,null==t?null:t.totalPrice,"2.3-3")," JOD "),e.xp6(3),e.hij(" ",null==t?null:t.lineDiscountPercentage," % "),e.xp6(2),e.hij(" ",e.xi3(19,19,null==t?null:t.lineDiscountAmount,"2.3-3")," JOD "),e.xp6(3),e.hij(" ",e.xi3(22,22,null==t?null:t.invoiceDiscountAmount,"2.3-3")," JOD "),e.xp6(3),e.hij(" ",e.xi3(25,25,null==t?null:t.netAmount,"2.3-3")," JOD"),e.xp6(3),e.hij(" ",null==t?null:t.taxPercentage," %"),e.xp6(2),e.hij(" ",e.xi3(30,28,null==t?null:t.taxAmount,"2.3-3")," JOD "),e.xp6(3),e.hij(" ",e.xi3(33,31,null==t?null:t.totalLine,"2.3-3")," JOD ")}}function ot(i,a){if(1&i&&(e.TgZ(0,"div",40)(1,"label"),e._uU(2," Reject Refund Reason "),e.qZA(),e.TgZ(3,"textarea",23),e._uU(4),e.qZA()()),2&i){const t=e.oxw();e.xp6(4),e.Oqu(null==t.details?null:t.details.rejectReturnReason)}}function lt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.rejectRefund())}),e._uU(1,"Reject Refund"),e.qZA()}}function ct(i,a){1&i&&e.GkF(0)}function ut(i,a){1&i&&e.GkF(0)}function dt(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",43),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.returnAction(r.details))}),e._uU(2),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled","Treasury"==(null==t.details?null:t.details.sentTo)),e.xp6(1),e.hij(" ",null==t.details||null==t.details.actionObj[0]?null:t.details.actionObj[0].lookupName," ")}}function pt(i,a){if(1&i&&(e.ynx(0),e.YNc(1,dt,3,2,"ng-container",42),e.BQk()),2&i){const t=e.oxw(),n=e.MAs(203);e.xp6(1),e.Q6J("ngIf","refunded"!==(null==t.details||null==t.details.statusObj[0]?null:t.details.statusObj[0].lookupName.toLowerCase())&&"collected"!==(null==t.details||null==t.details.statusObj[0]?null:t.details.statusObj[0].lookupName.toLowerCase()))("ngIfElse",n)}}function mt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.getInvoice())}),e._uU(1,"View Invoice"),e.qZA()}}function _t(i,a){1&i&&(e.TgZ(0,"div"),e._UZ(1,"app-loading"),e.qZA())}function ht(i,a){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.hij(" ",t," ")}}function ft(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.rejectRefund())}),e._uU(1,"Reject Refund"),e.qZA()}}function bt(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"p"),e._uU(4," Date "),e.TgZ(5,"span"),e._uU(6),e.ALo(7,"date"),e.qZA(),e._uU(8," \xa0 Time "),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"date"),e.qZA()(),e.TgZ(12,"div",6)(13,"p"),e._uU(14,"Status : "),e.TgZ(15,"span"),e._uU(16),e.qZA()(),e.TgZ(17,"p"),e._uU(18,"Invoice Type : "),e.TgZ(19,"span",7),e._uU(20),e.qZA()(),e.TgZ(21,"p"),e._uU(22,"Invoice No : "),e.TgZ(23,"span"),e._uU(24),e.qZA()(),e.TgZ(25,"p"),e._uU(26,"Receipt No : "),e.TgZ(27,"span"),e._uU(28),e.qZA()()()()(),e.TgZ(29,"div",8)(30,"div",9)(31,"h3"),e._uU(32," Customer Details "),e.qZA(),e.TgZ(33,"div",10)(34,"div",11),e._uU(35),e.qZA(),e.TgZ(36,"div")(37,"div",12)(38,"h4",13),e._uU(39,"ID: "),e.TgZ(40,"p",14),e._uU(41),e.qZA()()(),e.TgZ(42,"div",12)(43,"h4"),e._uU(44,"Customer Name"),e.qZA(),e.TgZ(45,"p"),e._uU(46),e.qZA()(),e.TgZ(47,"div",12)(48,"h4"),e._uU(49,"Mobile"),e.qZA(),e.TgZ(50,"p"),e._uU(51),e.qZA()()()()()(),e.TgZ(52,"div",15)(53,"div",16)(54,"h3",17),e._uU(55," Vehicle Details "),e.qZA(),e.TgZ(56,"div",3)(57,"div",18)(58,"div",3)(59,"div",19)(60,"div",12)(61,"h4"),e._uU(62," Brand "),e.qZA(),e.TgZ(63,"p"),e._uU(64),e.qZA()()(),e.TgZ(65,"div",19)(66,"div",12)(67,"h4"),e._uU(68," Cash Card No"),e.qZA(),e.TgZ(69,"p",20),e.YNc(70,ht,2,1,"span",21),e.qZA()()(),e.TgZ(71,"div",19)(72,"div",12)(73,"h4"),e._uU(74," Opportunity No"),e.qZA(),e.TgZ(75,"p"),e._uU(76),e.qZA()()()(),e._UZ(77,"hr",22),e.TgZ(78,"div",3)(79,"div",19)(80,"div",12)(81,"h4"),e._uU(82,"Model"),e.qZA(),e.TgZ(83,"p"),e._uU(84),e.qZA()()()()(),e.TgZ(85,"div",23)(86,"div",12)(87,"h4"),e._uU(88," Sales Consultant"),e.qZA(),e.TgZ(89,"p"),e._uU(90),e.qZA()()()()()(),e.TgZ(91,"div",4)(92,"div",16)(93,"div",3)(94,"div",8)(95,"div",24)(96,"label"),e._uU(97," Remaining Amount to pay"),e.qZA(),e.TgZ(98,"div",25)(99,"p"),e._uU(100),e.ALo(101,"number"),e.qZA()(),e.TgZ(102,"span",26),e._uU(103),e.ALo(104,"number"),e.qZA(),e._UZ(105,"br"),e.qZA(),e.TgZ(106,"div",27)(107,"label"),e._uU(108," Sales note "),e.qZA(),e._UZ(109,"textarea",28),e.qZA(),e.TgZ(110,"div",29)(111,"label"),e._uU(112," Cashier notes "),e.qZA(),e._UZ(113,"textarea",28),e.qZA()(),e.TgZ(114,"div",4)(115,"div",30)(116,"p"),e._uU(117," Grand Amount "),e.qZA(),e.TgZ(118,"div",31),e._uU(119),e.ALo(120,"number"),e.qZA()()()()()(),e.TgZ(121,"div",4)(122,"div",32),e.YNc(123,ft,2,0,"button",33),e.TgZ(124,"button",34),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.goBack())}),e._uU(125,"Cancel"),e.qZA()()()()}if(2&i){const t=a.$implicit,n=e.oxw();e.xp6(6),e.hij(" ",e.xi3(7,21,null==t||null==t.order?null:t.order.orderDate," d MMM y ")," "),e.xp6(4),e.hij(" ",e.xi3(11,24,null==t||null==t.order?null:t.order.orderDate," h:mm a ")," "),e.xp6(6),e.hij("",null==t||null==t.order||null==t.order.status[0]?null:t.order.status[0].statusName," "),e.xp6(4),e.hij("",null==t?null:t.invoiceType," "),e.xp6(4),e.hij("",null==t||null==t.order?null:t.order.invoiceNo," "),e.xp6(4),e.hij("",null==t||null==t.order?null:t.order.collectionId," "),e.xp6(7),e.hij(" ",n.custmerName," "),e.xp6(6),e.hij(" ",null==t||null==t.customer?null:t.customer.customerId," "),e.xp6(5),e.hij(" ",null==t||null==t.customer?null:t.customer.customerName," "),e.xp6(5),e.hij(" ",null==t||null==t.customer?null:t.customer.mobile," "),e.xp6(13),e.Oqu(null!=t.vin&&null!=t.vin.brand&&t.vin.brand.brand?null==t.vin||null==t.vin.brand?null:t.vin.brand.brand:"No data"),e.xp6(6),e.Q6J("ngForOf",t.order.directPaymentCards),e.xp6(6),e.Oqu(null==t||null==t.order?null:t.order.directPaymentSalesOrderOpportunityNo),e.xp6(8),e.hij(" ",(null==t||null==t.vin||null==t.vin.brand?null:t.vin.brand.modelName)||"-",""),e.xp6(6),e.hij(" ",null==t||null==t.salesConsultant?null:t.salesConsultant.salesConsultantName,""),e.xp6(10),e.hij("",e.xi3(101,27,t.order.remainingAmount,"2.3-3")," JOD "),e.xp6(3),e.hij("Minimum Payment: ",e.xi3(104,30,t.order.minAmount,"2.3-3")," JOD"),e.xp6(6),e.Q6J("value",t.order.salesNote),e.xp6(4),e.Q6J("value",t.cashierNotes),e.xp6(6),e.hij(" ",e.xi3(120,33,t.order.grandAmount,"2.3-3")," JOD"),e.xp6(4),e.Q6J("ngIf","Refunding"==n.orderStatus)}}function vt(i,a){1&i&&(e.TgZ(0,"div",4)(1,"div"),e._UZ(2,"app-loading"),e.qZA()())}const Zt=[{path:"",component:Be},{path:"details",component:(()=>{class i{constructor(t,n,r,s,o){this._collectService=t,this._commonService=n,this._activatedRoute=r,this._location=s,this._modalService=o,this.spareParts=[],this.totalRecordCount=0}ngOnInit(){this._activatedRoute.queryParams.subscribe(t=>{this.orderId=t.id,this.getReturnOrderRefundDetails(this.orderId)})}goBack(){this._location.back()}getReturnOrderRefundDetails(t){this._collectService.getSparePartsReturnOrdersPrtsV2(t).subscribe(n=>{this.spareParts=n.data,this.getSparePartsReturnOrders(t)})}getSparePartsReturnOrders(t){this._collectService.getSparePartsReturnOrders(`orderNo=${t}`).subscribe(r=>{this.details=r?.data[0],this.orderStatus=this.details?.statusObj[0]?.lookupName.trim()})}downloadInvoices(){}getInvoice(){const t=new FormData;t.append("returnOrderNo",this.orderId),this._collectService.viewReturnOrderOrigionalInvoice(t).subscribe({next:n=>{n.isSuccess&&this._commonService.downloadURI(n.data)},error:n=>{this.responseModal("error",n?.error.errors||n?.error.Errors)}})}responseModal(t,n){const r=this._modalService.open(_.i);"success"==t&&(r.componentInstance.message=n),r.componentInstance.messageError=n,r.componentInstance.type=t}rejectRefund(){const t=this._modalService.open(N,{size:"md"});t.componentInstance.data={...this.details,collectionType:7003},t.componentInstance.eventData.subscribe(n=>{n&&this.getReturnOrderRefundDetails(this.orderId)})}returnAction(t){let n=t?.actionObj[0]?.lookupName.toLowerCase();if("view"===n)this._modalService.open(b.z,{size:"lg"}).componentInstance.data={details:t};else if("collect"===n)if(t?.grandAmount>0){const r=this._modalService.open(h.k,{modalDialogClass:"payment-modal-size"});r.componentInstance.detailsItem={...t,isFromReturn:!0},r.componentInstance.collectionType=7003,r.componentInstance.sendtoLoadData.subscribe(s=>{r.dismiss(),this.getReturnOrderRefundDetails(this.orderId)})}else{const r=this._modalService.open(A,{size:"lg"});r.componentInstance.data={details:t},r.componentInstance.eventData.subscribe(s=>{s?.isSuccess&&(r.dismiss(),this.getReturnOrderRefundDetails(this.orderId))})}else if("sign"===n){const r=this._modalService.open(v.X,{size:"lg"});r.componentInstance.data={details:t},r.componentInstance.eventData.subscribe(s=>{s?.isSuccess&&(r.dismiss(),this.getReturnOrderRefundDetails(this.orderId))})}else if("refund"===n){const r=this._modalService.open(f,{size:"lg"});r.componentInstance.data={details:t},r.componentInstance.eventData.subscribe(s=>{s?.isSuccess&&(r.dismiss(),this.getReturnOrderRefundDetails(this.orderId))})}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.k),e.Y36(Z.v),e.Y36(g.gz),e.Y36(l.Ye),e.Y36(d.FF))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-spart-part-details"]],decls:211,vars:59,consts:[[1,"card-page"],[1,"row"],[1,"col-md-12"],[1,"top-details"],[1,"d-flex","gap-2"],[1,"col-md-4"],[1,"card-collect","customerDetail"],[1,"collect-details"],[1,"char"],[1,"card-sm"],[1,"d-flex","align-items-center"],[1,"m-0"],[1,"col-md-8"],[1,"card-collect"],[1,"col-sm-12"],[1,"d-flex","gap-5"],[1,"card-sm","mb-0"],[1,"table-responsive"],[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],[1,"col-md-6"],[1,"form-group"],["rows","3","disabled","",1,"form-control"],["class","form-group mt-3",4,"ngIf"],[1,"offset-md-2","col-md-4"],[1,"row","align-items-center"],[1,"col-6"],[1,"fw-500"],[1,"fw-500","light-gray"],[1,"total-card","justify-content-end","pt-75"],[1,"total"],[1,"btns-group","px-0","mx-0"],["type","button","class","btn btn-save",3,"click",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["otherActions",""],["type","button",1,"btn","btn-cancel",3,"click"],["loading",""],[1,"form-group","mt-3"],["type","button",1,"btn","btn-save",3,"click"],[4,"ngIf","ngIfElse"],["type","button",1,"btn","btn-save",3,"disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p"),e._uU(5," Date "),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"date"),e.qZA(),e._uU(9," \xa0 Time "),e.TgZ(10,"span"),e._uU(11),e.ALo(12,"date"),e.qZA()(),e.TgZ(13,"div",4)(14,"p"),e._uU(15,"Status : "),e.TgZ(16,"span"),e._uU(17),e.qZA()(),e.TgZ(18,"p"),e._uU(19,"Invoice No : "),e.TgZ(20,"span"),e._uU(21),e.qZA()()()()(),e.TgZ(22,"div",5)(23,"div",6)(24,"h3"),e._uU(25," Customer Details "),e.qZA(),e.TgZ(26,"div",7)(27,"div",8),e._uU(28),e.qZA(),e.TgZ(29,"div")(30,"div",9)(31,"h4",10),e._uU(32,"ID: "),e.TgZ(33,"p",11),e._uU(34),e.qZA()()(),e.TgZ(35,"div",9)(36,"h4"),e._uU(37,"Customer Name"),e.qZA(),e.TgZ(38,"p"),e._uU(39),e.qZA()(),e.TgZ(40,"div",9)(41,"h4"),e._uU(42,"Mobile"),e.qZA(),e.TgZ(43,"p"),e._uU(44),e.qZA()()()()()(),e.TgZ(45,"div",12)(46,"div",13)(47,"div",1)(48,"div",2)(49,"div",1)(50,"div",14)(51,"div",15)(52,"div",16)(53,"h4"),e._uU(54,"Sales Channel"),e.qZA(),e.TgZ(55,"p"),e._uU(56),e.qZA()(),e.TgZ(57,"div",16)(58,"h4"),e._uU(59,"Invoice Type"),e.qZA(),e.TgZ(60,"p"),e._uU(61),e.qZA()(),e.TgZ(62,"div",16)(63,"h4"),e._uU(64," Sales Order No"),e.qZA(),e.TgZ(65,"p"),e._uU(66),e.qZA()(),e.TgZ(67,"div",16)(68,"h4"),e._uU(69,"Special Order"),e.qZA(),e.TgZ(70,"p"),e._uU(71),e.qZA()(),e.TgZ(72,"div",16)(73,"h4"),e._uU(74," Sales Consultant"),e.qZA(),e.TgZ(75,"p"),e._uU(76),e.qZA()(),e.TgZ(77,"div",16)(78,"h4"),e._uU(79,"Date"),e.qZA(),e.TgZ(80,"p"),e._uU(81),e.ALo(82,"date"),e.qZA()()()()()()()()(),e.TgZ(83,"div",2)(84,"div",13)(85,"div",3)(86,"h3"),e._uU(87," Spare Parts "),e.qZA()(),e.TgZ(88,"div")(89,"div",17)(90,"table",18)(91,"thead")(92,"tr")(93,"th",19),e._uU(94," Part No "),e.qZA(),e.TgZ(95,"th",19),e._uU(96," Description "),e.qZA(),e.TgZ(97,"th",19),e._uU(98," Qty "),e.qZA(),e.TgZ(99,"th",19),e._uU(100," Unit of Measure "),e.qZA(),e.TgZ(101,"th",19),e._uU(102," Unit price "),e.qZA(),e.TgZ(103,"th",19),e._uU(104," Total "),e.qZA(),e.TgZ(105,"th",19),e._uU(106," Line Discount "),e.qZA(),e.TgZ(107,"th",19),e._uU(108," Line Discount Amount "),e.qZA(),e.TgZ(109,"th",19),e._uU(110," Invoice Discount Amount "),e.qZA(),e.TgZ(111,"th",19),e._uU(112," Net Amount "),e.qZA(),e.TgZ(113,"th",19),e._uU(114," Tax "),e.qZA(),e.TgZ(115,"th",19),e._uU(116," Tax Amount "),e.qZA(),e.TgZ(117,"th",19),e._uU(118," Grand Total"),e.qZA()()(),e.TgZ(119,"tbody"),e.YNc(120,at,34,34,"tr",20),e.qZA()()()()()()(),e.TgZ(121,"div",2)(122,"div",13)(123,"div",1)(124,"div",21)(125,"div",22)(126,"label"),e._uU(127," Sales note "),e.qZA(),e.TgZ(128,"textarea",23),e._uU(129),e.qZA()(),e.YNc(130,ot,5,1,"div",24),e.qZA(),e.TgZ(131,"div",25)(132,"div",26)(133,"div",27)(134,"p",28),e._uU(135,"Sub Total"),e.qZA()(),e.TgZ(136,"div",27)(137,"p",29),e._uU(138),e.ALo(139,"number"),e.qZA()()(),e.TgZ(140,"div",26)(141,"div",27)(142,"p",28),e._uU(143,"Total Line Discount"),e.qZA()(),e.TgZ(144,"div",27)(145,"p",29),e._uU(146),e.ALo(147,"number"),e.qZA()()(),e.TgZ(148,"div",26)(149,"div",27)(150,"p",28),e._uU(151,"Invoice Discount Percentage"),e.qZA()(),e.TgZ(152,"div",27)(153,"p",29),e._uU(154),e.qZA()()(),e.TgZ(155,"div",26)(156,"div",27)(157,"p",28),e._uU(158,"Invoice Discount Amount"),e.qZA()(),e.TgZ(159,"div",27)(160,"p",29),e._uU(161),e.ALo(162,"number"),e.qZA()()(),e.TgZ(163,"div",26)(164,"div",27)(165,"p",28),e._uU(166,"Net Total"),e.qZA()(),e.TgZ(167,"div",27)(168,"p",29),e._uU(169),e.ALo(170,"number"),e.qZA()()(),e.TgZ(171,"div",26)(172,"div",27)(173,"p",28),e._uU(174,"Total Tax Amount"),e.qZA()(),e.TgZ(175,"div",27)(176,"p",29),e._uU(177),e.ALo(178,"number"),e.qZA()()(),e.TgZ(179,"div",26)(180,"div",27)(181,"p",28),e._uU(182,"Grand Amount"),e.qZA()(),e.TgZ(183,"div",27)(184,"p",29),e._uU(185),e.ALo(186,"number"),e.qZA()()()(),e.TgZ(187,"div",2)(188,"div",30)(189,"p"),e._uU(190," Total Amount "),e.qZA(),e.TgZ(191,"div",31),e._uU(192),e.ALo(193,"number"),e.qZA()()(),e._UZ(194,"div",21),e.qZA()()(),e.TgZ(195,"div",2)(196,"div",32),e.YNc(197,lt,2,0,"button",33),e.ynx(198,34),e.YNc(199,ct,1,0,"ng-container",35),e.YNc(200,ut,1,0,"ng-container",35),e.YNc(201,pt,2,2,"ng-container",36),e.BQk(),e.YNc(202,mt,2,0,"ng-template",null,37,e.W1O),e.TgZ(204,"button",38),e.NdJ("click",function(){return n.goBack()}),e._uU(205,"Cancel"),e.qZA()()()(),e.TgZ(206,"div",1)(207,"div",2)(208,"div"),e.YNc(209,_t,2,0,"ng-template",null,39,e.W1O),e.qZA()()()),2&t&&(e.xp6(7),e.hij(" ",e.xi3(8,29,null==n.details?null:n.details.returnAt,"mediumDate")," "),e.xp6(4),e.hij(" ",e.xi3(12,32,null==n.details?null:n.details.returnAt,"h:mm a")," "),e.xp6(6),e.hij("",null==n.details||null==n.details.statusObj[0]?null:n.details.statusObj[0].lookupName," "),e.xp6(4),e.hij("",null==n.details?null:n.details.invoicNo," "),e.xp6(7),e.hij(" ",null==n.details?null:n.details.custmerName," "),e.xp6(6),e.hij(" ",null==n.details||null==n.details.customer?null:n.details.customer.customerId," "),e.xp6(5),e.hij(" ",null==n.details||null==n.details.customer?null:n.details.customer.customerName," "),e.xp6(5),e.hij(" ",null==n.details||null==n.details.customer?null:n.details.customer.mobile," "),e.xp6(12),e.hij(" ",null==n.details||null==n.details.salesChannel?null:n.details.salesChannel.channelName," "),e.xp6(5),e.hij(" ",null==n.details?null:n.details.invoiceType," "),e.xp6(5),e.hij(" ",null==n.details?null:n.details.sparePartsSalesOrderOpportunityNo," "),e.xp6(5),e.hij(" ",null!=n.details&&n.details.isSpecialOrder?"True":"False"," "),e.xp6(5),e.hij(" ",null==n.details?null:n.details.returnedBy.fullName,""),e.xp6(5),e.hij(" ",e.xi3(82,35,null==n.details?null:n.details.orderDate,"mediumDate")," "),e.xp6(39),e.Q6J("ngForOf",n.spareParts),e.xp6(9),e.Oqu(null==n.details?null:n.details.salesNote),e.xp6(1),e.Q6J("ngIf","Rejected Return"==n.orderStatus),e.xp6(8),e.hij("",e.xi3(139,38,null==n.details?null:n.details.subTotal,"2.3-3")," JOD"),e.xp6(8),e.hij("",e.xi3(147,41,null==n.details?null:n.details.totalLineDiscount,"2.3-3")," JOD"),e.xp6(8),e.hij("",null==n.details?null:n.details.invoiceDiscountPercentage,"%"),e.xp6(7),e.hij("",e.xi3(162,44,null==n.details?null:n.details.invoiceDiscountAmount,"2.3-3")," JOD"),e.xp6(8),e.hij("",e.xi3(170,47,null==n.details?null:n.details.netTotal,"2.3-3")," JOD"),e.xp6(8),e.hij("",e.xi3(178,50,null==n.details?null:n.details.totalTaxAmount,"2.3-3")," JOD"),e.xp6(8),e.hij("",e.xi3(186,53,null==n.details?null:n.details.grandAmount,"2.3-3")," JOD"),e.xp6(7),e.hij(" ",e.xi3(193,56,null==n.details?null:n.details.grandAmount,"2.3-3")," JOD"),e.xp6(5),e.Q6J("ngIf","Refunding"==n.orderStatus),e.xp6(1),e.Q6J("ngSwitch",null==n.details?null:n.details.status),e.xp6(1),e.Q6J("ngSwitchCase",10006),e.xp6(1),e.Q6J("ngSwitchCase",10010))},dependencies:[l.sg,l.O5,l.RF,l.n9,l.ED,S.N,l.JJ,l.uU],styles:[".card-page[_ngcontent-%COMP%]{padding:15px}.pt-75[_ngcontent-%COMP%]{padding-top:75px}.v-line[_ngcontent-%COMP%]{margin:0 0 10px;border-color:#777}.l-line[_ngcontent-%COMP%]{border-left:1px solid #ddd}.btn.disabled[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]:disabled{background:#f1f3f3!important;color:#9b9b9b!important;border:1px solid #f1f3f3;cursor:initial}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f8f8f9;border:0px;opacity:1;border:0p}"]}),i})()},{path:"services-details/:id",component:st},{path:"dpayment-details/:orderId",component:(()=>{class i{constructor(t,n,r,s,o,p){this.collectService=t,this.route=n,this.sharedService=r,this._modalService=s,this._commonService=o,this._location=p,this.orderStatus="",this.orderId=0}ngOnInit(){this.route.params.subscribe(t=>{this.orderId=t.orderId,this.GetDirectPaymentSalesOrdersDetails()})}goBack(){this._location.back()}rejectRefund(){const t=this._modalService.open(N,{size:"md"});t.componentInstance.data={...this.details,collectionType:7002},t.componentInstance.eventData.subscribe(n=>{n&&this.GetDirectPaymentSalesOrdersDetails()})}downloadInvoices(t){this._commonService.downloadInvoices({invoices:t})}returnAction(t){let n=t?.actionObj[0]?.lookupName.toLowerCase();if("view"===n)this._modalService.open(b.z,{size:"lg"}).componentInstance.data={details:t,orderType:7002};else if("collect"===n){const r=this._modalService.open(h.k,{modalDialogClass:"payment-modal-size"});r.componentInstance.detailsItem={...t,isFromReturn:!0},r.componentInstance.collectionType=7002,r.componentInstance.sendtoLoadData.subscribe(s=>{r.dismiss(),this.GetDirectPaymentSalesOrdersDetails()})}else if("sign"===n){const r=this._modalService.open(v.X,{size:"lg"});r.componentInstance.data={details:t,orderType:7002},r.componentInstance.eventData.subscribe(s=>{s?.isSuccess&&(r.dismiss(),this.GetDirectPaymentSalesOrdersDetails())})}else if("refund"===n){const r=this._modalService.open(f,{size:"lg"});r.componentInstance.data={returnType:"",details:t,orderType:7002},r.componentInstance.eventData.subscribe(s=>{s?.isSuccess&&(r.dismiss(),this.GetDirectPaymentSalesOrdersDetails())})}}GetDirectPaymentSalesOrdersDetails(){return this.collectService.GetDirectPaymentSalesOrdersDetails(this.orderId).subscribe(t=>{if(t){this.details=t.data,console.log(this.details),this.orderStatus=this.details?.order?.status[0]?.statusName.trim();const n=this.details?.customer.customerName.split(" ");let s=n[1];this.custmerName=`${n[0]?.charAt(0)} ${s?s?.charAt(0):""}`}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m.k),e.Y36(g.gz),e.Y36(R.F),e.Y36(d.FF),e.Y36(Z.v),e.Y36(l.Ye))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-direct-payment-details"]],decls:4,vars:2,consts:[[1,"card-page"],["class","row",4,"ngIf","ngIfElse"],["loading",""],[1,"row"],[1,"col-md-12"],[1,"top-details"],[1,"d-flex","gap-2"],[1,"text-capitalize"],[1,"col-md-4"],[1,"card-collect","customerDetail"],[1,"collect-details"],[1,"char"],[1,"card-sm"],[1,"d-flex","align-items-center"],[1,"m-0"],[1,"col-md-8"],[1,"card-collect"],[2,"margin-bottom","20px"],[1,"col-md-9"],[1,"col-sm-4"],[1,"mb-1"],[4,"ngFor","ngForOf"],[1,"v-line"],[1,"col-sm-3"],[1,"form-group","mb-2"],[1,"disabled-box","mb-2"],[1,"font-13"],[1,"form-group"],["rows","3","disabled","",1,"form-control",3,"value"],[1,"form-group","mt-3"],[1,"total-card","justify-content-end","pt-75"],[1,"total"],[1,"btns-group","px-0","mx-0"],["type","button","class","btn btn-save",3,"click",4,"ngIf"],["type","button",1,"btn","btn-cancel",3,"click"],["type","button",1,"btn","btn-save",3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,bt,126,36,"div",1),e.YNc(2,vt,3,0,"ng-template",null,2,e.W1O),e.qZA()),2&t){const r=e.MAs(3);e.xp6(1),e.Q6J("ngIf",n.details)("ngIfElse",r)}},dependencies:[l.sg,l.O5,S.N,l.JJ,l.uU],styles:[".card-page[_ngcontent-%COMP%]{padding:15px}.pt-75[_ngcontent-%COMP%]{padding-top:75px}.pagination[_ngcontent-%COMP%]{margin:5px 0}.v-line[_ngcontent-%COMP%]{margin:0 0 10px;border-color:#777}.l-line[_ngcontent-%COMP%]{border-left:1px solid #ddd}.btn.disabled[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]:disabled{background:#f1f3f3!important;color:#9b9b9b!important;border:1px solid #f1f3f3;cursor:initial}.form-control[_ngcontent-%COMP%]:disabled{background-color:#f8f8f9;border:0px;opacity:1;border:0p}"]}),i})()}];let Tt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.Bz.forChild(Zt),g.Bz]}),i})();var Ct=c(21515);let St=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[l.ez,Tt,Ct.m]}),i})()}}]);